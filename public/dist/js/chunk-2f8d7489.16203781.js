(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f8d7489"],{"0c0f":function(t,e,i){"use strict";i("1535")},1535:function(t,e,i){},"1c9c":function(t,e,i){"use strict";i.d(e,"s",(function(){return n})),i.d(e,"e",(function(){return o})),i.d(e,"t",(function(){return r})),i.d(e,"j",(function(){return f})),i.d(e,"n",(function(){return c})),i.d(e,"y",(function(){return u})),i.d(e,"w",(function(){return l})),i.d(e,"g",(function(){return d})),i.d(e,"B",(function(){return m})),i.d(e,"c",(function(){return h})),i.d(e,"h",(function(){return g})),i.d(e,"a",(function(){return p})),i.d(e,"q",(function(){return y})),i.d(e,"i",(function(){return v})),i.d(e,"v",(function(){return b})),i.d(e,"p",(function(){return S})),i.d(e,"b",(function(){return N})),i.d(e,"l",(function(){return w})),i.d(e,"m",(function(){return _})),i.d(e,"z",(function(){return C})),i.d(e,"C",(function(){return O})),i.d(e,"k",(function(){return L})),i.d(e,"A",(function(){return x})),i.d(e,"x",(function(){return k})),i.d(e,"r",(function(){return D})),i.d(e,"o",(function(){return T})),i.d(e,"d",(function(){return j})),i.d(e,"f",(function(){return I})),i.d(e,"u",(function(){return M}));var a=i("b775"),s={staff:"/enterprise/role/staff",roleList:"/enterprise/role",roleResource:"/enterprise/role/getRoleResource",syncAll:"/enterprise/staff/syncAll",getCustGrpList:"/client_group/customerGroup/getCustGrpList",changeRole:"/enterprise/role/change",departmentStaff:"/enterprise/department/staff",addStaffRole:"/enterprise/role/addStaffRole",getQuitStaff:"/client_manager/transfer/getQuitStaff",getStaff:"/enterprise/staff/get",department:"/enterprise/department",getDepartmentStaff:"/enterprise/department/getStaff",loginAdmin:"/enterprise/staff/loginAdmin",getRoleRes:"/enterprise/role/getRoleRes",changeRes:"/enterprise/role/change/res",getPermissionLog:"/enterprise/permissionLog/query",staffInfo:"/enterprise/staff/statistics/get/staffInfo",yesterdayData:"/enterprise/staff/statistics/get/yesterdayData",getDate:"/enterprise/staff/statistics/get/date",editDelConfig:"/client_manager/customerdelremind/editDelConfig",queryDelConfig:"/client_manager/customerdelremind/queryDelConfig",customStage:"/enterprise/staff/statistics/get/stage",idOrUserIdGet:"/enterprise/staff/idOrUserIdGet",staffOKR:"/enterprise/staffOKR/staffOKR",saveOKR:"/enterprise/staffOKR/save",getStaffOKRList:"/enterprise/staffOKR/getStaffOKRList",getRepeatList:"/enterprise/staffOKR/getRepeatList",checkTime:"enterprise/staffOKR/checkTime",delOkr:"/enterprise/staffOKR/del",modify:"/enterprise/staffOKR/modify"};function n(t){return Object(a["b"])({url:s.idOrUserIdGet,method:"get",params:t})}function o(t){return Object(a["b"])({url:s.customStage,method:"get",params:t})}function r(t){return Object(a["b"])({url:s.loginAdmin,method:"get",params:t})}function f(t){return Object(a["b"])({url:s.getCustGrpList,method:"post",data:t})}function c(t){return Object(a["b"])({url:s.getQuitStaff,method:"get",params:t})}function u(t){return Object(a["b"])({url:s.staff,method:"get",params:t})}function l(){return Object(a["b"])({url:s.roleList,method:"get"})}function d(){return Object(a["b"])({url:s.department,method:"get"})}function m(){return Object(a["b"])({url:s.syncAll,method:"get"})}function h(t){return Object(a["b"])({url:s.changeRole,method:"get",params:t})}function g(){return Object(a["b"])({url:s.departmentStaff,method:"get"})}function p(t){return Object(a["b"])({url:s.addStaffRole,method:"post",data:t})}function y(t){return Object(a["b"])({url:s.getStaff,method:"get",params:t})}function v(t){return Object(a["b"])({url:s.editDelConfig,method:"post",data:t})}function b(t){return Object(a["b"])({url:s.queryDelConfig,method:"post",data:t})}function S(t){return Object(a["b"])({url:s.getRoleRes,method:"get",params:t})}function N(t){return Object(a["b"])({url:s.changeRes,method:"post",data:t})}function w(t){return Object(a["b"])({url:s.getDepartmentStaff,method:"get",params:t})}function _(t){return Object(a["b"])({url:s.getPermissionLog,method:"post",data:t})}function C(t){return Object(a["b"])({url:s.staffInfo,method:"get",params:t})}function O(t){return Object(a["b"])({url:s.yesterdayData,method:"get",params:t})}function L(t){return Object(a["b"])({url:s.getDate,method:"get",params:t})}function x(t){return Object(a["b"])({url:s.staffOKR,method:"get",params:t})}function k(t){return Object(a["b"])({url:s.saveOKR,method:"post",data:t})}function D(t){return Object(a["b"])({url:s.getStaffOKRList,method:"get",params:t})}function T(t){return Object(a["b"])({url:s.getRepeatList,method:"get",params:t})}function j(t){return Object(a["b"])({url:s.checkTime,method:"get",params:t})}function I(t){return Object(a["b"])({url:s.delOkr,method:"post",data:t})}function M(t){return Object(a["b"])({url:s.modify,method:"post",data:t})}},2637:function(t,e,i){"use strict";i("b0c0"),i("498a"),i("caad"),i("2532");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-wrap"},[e("div",{staticClass:"button-name",on:{click:function(e){return e.stopPropagation(),t.selectFocusIsOpen.apply(null,arguments)},mouseenter:t.enter,mouseleave:t.leave}},[t.selectList.length<=0?e("span",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",color:"rgba(0, 0, 0, 0.25)"}},[t._v(" "+t._s(t.txt)+" ")]):t._l(t.selectList,(function(i,a){return e("span",{directives:[{name:"show",rawName:"v-show",value:a<2,expression:"index < 2"}],key:a},[e("a-avatar",{attrs:{size:28,shape:"square",src:i.thumbAvatar}}),t._v(" "+t._s(i.name)+" ")],1)})),e("span",{directives:[{name:"show",rawName:"v-show",value:t.selectList.length>2,expression:"selectList.length > 2"}]},[t._v("等"+t._s(t.selectList.length)+"个")]),e("span",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"}},[t.selectList.length<=0?e("a-icon",{attrs:{type:"down"}}):e("a-icon",{attrs:{type:"close-circle",theme:"filled"},on:{click:function(e){return e.stopPropagation(),t.iconClear.apply(null,arguments)}}})],1)],2),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"},{name:"clickoutside",rawName:"v-clickoutside",value:t.handleClose,expression:"handleClose"}],staticClass:"selectBox_list"},[e("div",{staticClass:"group-owner"},[e("header",{staticClass:"header"},[t._v("全部"+t._s(t.nameTxt)+" ("+t._s(t.total)+")")]),e("div",{staticClass:"search-name"},[e("a-input-search",{attrs:{placeholder:"请输入员工后回车"},on:{search:t.onSearchName},model:{value:t.searchName,callback:function(e){t.searchName="string"===typeof e?e.trim():e},expression:"searchName"}})],1),e("ul",{staticClass:"list-wrap"},[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.getDictionaryByCode,expression:"getDictionaryByCode"}],staticClass:"demo-infinite-container",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},t._l(t.groupOwners,(function(i){return e("li",{key:i.staffId,staticClass:"title-wrap",on:{click:function(e){return e.stopPropagation(),t.selectGroupOwner(i)}}},[e("a-space",{attrs:{size:12}},[e("a-avatar",{attrs:{size:30,src:i.thumbAvatar,shape:"square"}}),e("span",[t._v(t._s(i.name))])],1),e("div",[t.defalytStaffIndex.includes(i.userid)?e("a-icon",{staticClass:"check-circle",attrs:{type:"check-circle"}}):e("div",{staticClass:"circle"})],1)],1)})),0)])])])])},s=[],n=i("2909"),o=(i("a9e3"),i("d81d"),i("c740"),i("a434"),i("d3b7"),i("99af"),i("487a")),r=i.n(o),f=i("1c9c"),c=i("e88b"),u={bind:function(t,e){function i(i){if(t.contains(i.target))return!1;e.expression&&e.value(i)}t.__vueClickOutside__=i,document.addEventListener("click",i)},update:function(){},unbind:function(t){document.removeEventListener("click",t.__vueClickOutside__),delete t.__vueClickOutside__}},l={name:"SearchForm",directives:{clickoutside:u,infiniteScroll:r.a},props:{reactflag:{type:Number,default:0},type:{type:String,default:"getStaff"},defaultSelectList:{type:Array,default:function(){return[]}},isMultiple:{type:Boolean,default:!1}},data:function(){return{selectList:[],thumbAvatar:"",defalytStaffIndex:[],busy:!0,pagination:{current:1,pageSize:10,total:0},total:0,totalNum:0,selectRoleId:"3",employeeName:"",groupOwners:[],page:1,limit:10,value:[],searchName:"",styleButton:1,owners:[],isOpen:!1,loading:!1,buttonLoding:!1,ownersID:{data:[]}}},mounted:function(){this.selectList=JSON.parse(JSON.stringify(this.defaultSelectList)),this.selectList.length>0&&(this.defalytStaffIndex=this.selectList.map((function(t){return t.userid})))},computed:{txt:function(){var t;return"getStaff"==this.type?t="请选择员工":"getAdmins"==this.type&&(t="选择接收管理员"),t},nameTxt:function(){var t;return"getStaff"==this.type?t="员工":"getAdmins"==this.type&&(t="管理员"),t}},created:function(){},methods:{enter:function(){this.styleButton=2},leave:function(){this.styleButton=1},selectGroupOwner:function(t){if(this.isMultiple)this.selectList=[],this.defalytStaffIndex=[],this.selectList.push(t),this.defalytStaffIndex=[t.userid],this.isOpen=!1,this.$emit("selectCustom",this.selectList);else{var e=this.selectList.findIndex((function(e){if(e.userid===t.userid)return e}));e>=0?this.selectList.splice(e,1):this.selectList.push(t),this.defalytStaffIndex=this.selectList.map((function(t){return t.userid})),this.$emit("selectCustom",this.selectList)}},iconClear:function(){this.selectList=[],this.defalytStaffIndex=[],this.isOpen=!0,this.$emit("selectCustom",this.selectList)},handleClose:function(){this.isOpen=!1},selectFocusIsOpen:function(){this.isOpen=!this.isOpen},handleInfiniteOnLoad:function(){this.pagination.current++,this.loading&&this.getDictionaryByCode()},getDictionaryByCode:function(){var t={currentPage:this.page,pageSize:this.limit,name:this.searchName||""};this.buttonLoding||(this.buttonLoding=!0,this.loading=!0,"0"!=this.total&&this.groupOwners.length>=this.total?this.busy=!0:"getStaff"==this.type?this.getStaff(t):"getAdmins"==this.type&&this.getAdmins(t))},getStaff:function(t){var e=this;Object(f["q"])(t).then((function(t){var i=t.data.list;e.total=t.data.total,e.page>1?e.groupOwners=[].concat(Object(n["a"])(e.groupOwners),Object(n["a"])(i)):e.groupOwners=Object(n["a"])(i),e.groupOwners.length>=e.total?e.busy=!0:(e.page=e.page+1,e.loading=!1)})).catch((function(t){e.$message.error(t||t.message)})).finally((function(){e.buttonLoding=!1}))},getAdmins:function(t){var e=this;Object(c["a"])(t).then((function(t){var i=t.data.list;e.total=t.data.total,e.page>1?e.groupOwners=[].concat(Object(n["a"])(e.groupOwners),Object(n["a"])(i)):e.groupOwners=Object(n["a"])(i),e.groupOwners.length>=e.total?e.busy=!0:(e.page=e.page+1,e.loading=!1)})).catch((function(t){e.$message.error(t||t.message)})).finally((function(){e.buttonLoding=!1}))},onSearchName:function(){this.groupOwners=[],this.page=1,this.getDictionaryByCode()}},watch:{defaultSelectList:{handler:function(t,e){this.selectList=JSON.parse(JSON.stringify(this.defaultSelectList)),this.selectList.length>0?this.defalytStaffIndex=this.selectList.map((function(t){return t.userid})):this.defalytStaffIndex=[]}},reactflag:{handler:function(t,e){this.selectList=[],this.defalytStaffIndex=[],this.isOpen=!1,this.$emit("selectCustom",this.selectList)}}}},d=l,m=(i("48fc"),i("2877")),h=Object(m["a"])(d,a,s,!1,null,"158f2cd4",null);e["a"]=h.exports},2909:function(t,e,i){"use strict";i.d(e,"a",(function(){return f}));var a=i("6b75");function s(t){if(Array.isArray(t))return Object(a["a"])(t)}i("a4d3"),i("e01a"),i("d3b7"),i("d28b"),i("3ca3"),i("ddb0"),i("a630");function n(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var o=i("06c5");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function f(t){return s(t)||n(t)||Object(o["a"])(t)||r()}},"3a45":function(t,e,i){"use strict";i("a0d4")},"487a":function(t,e,i){(function(e,i){t.exports=i()})(0,(function(){"use strict";var t="@@InfiniteScroll",e=function(t,e){var i,a,s,n,o,r=function(){t.apply(n,o),a=i};return function(){if(n=this,o=arguments,i=Date.now(),s&&(clearTimeout(s),s=null),a){var t=e-(i-a);t<0?r():s=setTimeout((function(){r()}),t)}else r()}},i=function(t){return t===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):t.scrollTop},a=document.defaultView.getComputedStyle,s=function(t){var e=t;while(e&&"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType){var i=a(e).overflowY;if("scroll"===i||"auto"===i)return e;e=e.parentNode}return window},n=function(t){return t===window?document.documentElement.clientHeight:t.clientHeight},o=function(t){return t===window?i(window):t.getBoundingClientRect().top+i(window)},r=function(t){var e=t.parentNode;while(e){if("HTML"===e.tagName)return!0;if(11===e.nodeType)return!1;e=e.parentNode}return!1},f=function(){if(!this.binded){this.binded=!0;var t=this,i=t.el,a=i.getAttribute("infinite-scroll-throttle-delay"),n=200;a&&(n=Number(t.vm[a]||a),(isNaN(n)||n<0)&&(n=200)),t.throttleDelay=n,t.scrollEventTarget=s(i),t.scrollListener=e(c.bind(t),t.throttleDelay),t.scrollEventTarget.addEventListener("scroll",t.scrollListener),this.vm.$on("hook:beforeDestroy",(function(){t.scrollEventTarget.removeEventListener("scroll",t.scrollListener)}));var o=i.getAttribute("infinite-scroll-disabled"),r=!1;o&&(this.vm.$watch(o,(function(e){t.disabled=e,!e&&t.immediateCheck&&c.call(t)})),r=Boolean(t.vm[o])),t.disabled=r;var f=i.getAttribute("infinite-scroll-distance"),u=0;f&&(u=Number(t.vm[f]||f),isNaN(u)&&(u=0)),t.distance=u;var l=i.getAttribute("infinite-scroll-immediate-check"),d=!0;l&&(d=Boolean(t.vm[l])),t.immediateCheck=d,d&&c.call(t);var m=i.getAttribute("infinite-scroll-listen-for-event");m&&t.vm.$on(m,(function(){c.call(t)}))}},c=function(t){var e=this.scrollEventTarget,a=this.el,s=this.distance;if(!0===t||!this.disabled){var r=i(e),f=r+n(e),c=!1;if(e===a)c=e.scrollHeight-f<=s;else{var u=o(a)-o(e)+a.offsetHeight+r;c=f+s>=u}c&&this.expression&&this.expression()}},u={bind:function(e,i,a){e[t]={el:e,vm:a.context,expression:i.value};var s=arguments;e[t].vm.$on("hook:mounted",(function(){e[t].vm.$nextTick((function(){r(e)&&f.call(e[t],s),e[t].bindTryCount=0;var i=function i(){e[t].bindTryCount>10||(e[t].bindTryCount++,r(e)?f.call(e[t],s):setTimeout(i,50))};i()}))}))},unbind:function(e){e&&e[t]&&e[t].scrollEventTarget&&e[t].scrollEventTarget.removeEventListener("scroll",e[t].scrollListener)}},l=function(t){t.directive("InfiniteScroll",u)};return window.Vue&&(window.infiniteScroll=u,Vue.use(l)),u.install=l,u}))},"48fc":function(t,e,i){"use strict";i("9195")},9195:function(t,e,i){},a0d4:function(t,e,i){},cedb:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"management-setting"},[e("a-page-header",{staticClass:"page-header background-white",attrs:{title:"客户管理/设置"},on:{back:function(e){return t.$router.go(-1)}}}),e("div",{attrs:{id:"page-content"}},[e("div",{staticClass:"ant-card-bordered"},[e("div",{staticClass:"set-up"},[e("div",{staticClass:"stage-step"},[e("ul",{staticClass:"intention"},t._l(t.firstManageList,(function(i,a){return e("li",{key:a,staticClass:"item"},[e("i",{staticClass:"circle"}),e("div",{staticClass:"item-inner"},[t._v(t._s(i.stageName))]),e("div",{staticClass:"line"})])})),0),e("ul",{staticClass:"no-intention intention"},t._l(t.unManageList,(function(i,a){return e("li",{key:a,class:[{hideName:a!=t.unManageList.length-1},"item"]},[e("div",{class:[{hidden:a!=t.unManageList.length-1},"item-inner"]},[t._v(t._s(i.stageName))]),t._v(" "),e("div",{staticClass:"line"})])})),0)]),e("div",{staticClass:"table-wrap"},[e("div",{staticClass:"stage-table"},[e("div",{staticClass:"ant-table-content"},[e("table",[t._m(0),e("tbody",t._l(t.manageList,(function(i,a){return e("tr",{key:a},[e("td",[e("a-icon",{class:[{disabled:0==a},"icon"],attrs:{type:"arrow-up"},on:{click:function(e){return t.handleClickBySortUp(i,a)}}}),e("a-icon",{class:[{disabled:a==t.manageList.length-1},"icon"],attrs:{type:"arrow-down"},on:{click:function(e){return t.handleClickBySortDown(i,a)}}})],1),e("td",[t._v(t._s(i.stageName))]),e("td",[t._v(t._s(i.stageDescribe))]),e("td",["0"==i.isStaffNotify?e("p",[e("a-icon",{staticClass:"icon-wrap",attrs:{type:"check"}}),e("span",[t._v("员工提醒：超过"),e("strong",[t._v("【"+t._s(i.staffNotifyDays)+"天】")]),t._v(t._s("1"==i.staffNotifyStatus?"停留时间":"未联系")+"，次日"),e("strong",[t._v("【"+t._s(i.aTime)+"】")]),t._v("提醒")])],1):e("p",[e("a-icon",{attrs:{type:"check"}}),e("span",[t._v("员工提醒：-")])],1),"0"==i.isAdminNotify?e("p",[e("a-icon",{staticClass:"icon-wrap",attrs:{type:"check"}}),e("span",[t._v("管理员提醒：超过"),e("strong",[t._v("【"+t._s(i.adminNotifyDays)+"天】")]),t._v(t._s("1"==i.adminNotifyStatus?"停留时间":"未联系")+"，次日"),e("strong",[t._v("【"+t._s(i.sTime)+"】")]),t._v("提醒")])],1):e("p",[e("a-icon",{staticClass:"defalut-wrap",attrs:{type:"check"}}),e("span",[t._v("管理员提醒：-")])],1)]),e("td",[e("span",{on:{click:function(e){return t.deleteList(i.stageName,i.stageUserCount||0,i.stageId)}}},[t._v("删除")]),t._v(" "),e("i"),t._v(" "),e("span",{on:{click:function(e){return t.edit(i)}}},[t._v("编辑")])])])})),0)])]),t.manageList.length<=0?e("a-empty",{staticClass:"empty",attrs:{description:"暂无客户阶段"}}):t._e()],1),e("span",{staticClass:"add-btn",on:{click:t.add}},[e("a-icon",{staticClass:"icon",attrs:{type:"plus-circle"}}),t._v("添加")],1)])])]),e("a-modal",{attrs:{footer:null,width:"630px",centered:""},model:{value:t.visibleBox,callback:function(e){t.visibleBox=e},expression:"visibleBox"}},[e("AddEdit",{attrs:{choicetype:t.choicetype},on:{cancelBox:t.cancelBox,saveBox:t.saveBox}})],1)],1)],1)},s=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th"),t._v(" "),e("th",[t._v("客户阶段")]),e("th",[t._v("阶段描述")]),e("th",[t._v("跟进提醒")]),e("th",[t._v("操作")])])])}],n=(i("a434"),i("d81d"),i("d3b7"),i("c740"),i("99af"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"AddEdit"},[e("h2",{staticClass:"dialog-title"},[t._v(t._s(t.Copywriting))]),e("div",{staticClass:"confirm-body"},[e("div",{staticClass:"tips"},[e("a-icon",{staticClass:"bell",attrs:{type:"bell"}}),t._v("提示：【未联系提醒功能】需员工开通会话存档接口后才能生效 ")],1),e("div",{staticClass:"scroll-view"},[e("div",{staticClass:"row"},[e("label",[t._v("阶段名称：")]),e("a-input",{staticStyle:{width:"330px"},attrs:{placeholder:"请输入阶段名称"},model:{value:t.stageName,callback:function(e){t.stageName=e},expression:"stageName"}})],1),e("div",{staticClass:"row"},[e("label",[t._v("阶段描述：")]),e("div",{staticClass:"textarea"},[e("a-textarea",{attrs:{placeholder:"请输入内容",maxLength:100},model:{value:t.stageDescribe,callback:function(e){t.stageDescribe=e},expression:"stageDescribe"}}),e("p",[t._v("0/100")])],1)]),e("div",{staticClass:"row"},[e("label",{staticStyle:{"margin-top":"3px"}},[t._v("员工跟进提醒：")]),e("div",{staticClass:"content"},[e("div",{staticClass:"switch-box"},[e("a-switch",{staticClass:"swicth",on:{change:t.onFollowStaff},model:{value:t.followStaff,callback:function(e){t.followStaff=e},expression:"followStaff"}}),t._v(t._s(t.followStaffTxt)+" ")],1),e("div",{staticClass:"set-remind-box"},[e("span",{staticClass:"dropdown-wrap"},[e("span",{staticClass:"label-wrap"},[e("a-dropdown",{attrs:{trigger:["click"]}},[e("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[t._v(" "+t._s(t.followStateTxt)+" "),e("a-icon",{attrs:{type:"down"}})],1),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e("a-menu-item",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.checkfollow("0")}}},[t._v("停留时间")])]),e("a-menu-item",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.checkfollow("1")}}},[t._v("未联系")])])],1)],1)],1)]),e("span",[t._v("超过")]),e("div",{staticClass:"number-input"},[e("a-input-number",{staticClass:"followNumber",attrs:{precision:0,min:0,max:100},model:{value:t.staffNotifyDays,callback:function(e){t.staffNotifyDays=e},expression:"staffNotifyDays"}})],1),e("span",[t._v("天后，次日")]),e("span",{staticClass:"date-input"},[e("a-time-picker",{staticClass:"timer",attrs:{format:"HH:mm",placeholder:"请选择时间"},on:{change:t.changeStaffDate},model:{value:t.dateStaffTime,callback:function(e){t.dateStaffTime=e},expression:"dateStaffTime"}})],1),e("span",[t._v("提醒")])]),e("div",{staticClass:"remind-preview"},[t._v("客户【"+t._s(t.followStateTxt)+"】时间超过了【"+t._s(t.staffNotifyDays)+"天】后，次日【"+t._s(t.showStafftime)+"】提醒员工")])])]),e("div",{staticClass:"row"},[e("label",{staticStyle:{"margin-top":"3px"}},[t._v("管理员提醒：")]),e("div",{staticClass:"content"},[e("div",{staticClass:"switch-box"},[e("a-switch",{staticClass:"swicth",on:{change:t.onAdminStaff},model:{value:t.adminStaff,callback:function(e){t.adminStaff=e},expression:"adminStaff"}}),t._v(t._s(t.adminStaffTxt)+" ")],1),e("div",{staticClass:"received-user"},[e("span",[t._v("管理员提醒：")]),e("AllEmployees",{attrs:{type:"getAdmins",defaultSelectList:t.defaultSelectList},on:{selectCustom:t.selectCustom}})],1),e("div",{staticClass:"set-remind-box"},[e("span",{staticClass:"dropdown-wrap"},[e("span",{staticClass:"label-wrap"},[e("a-dropdown",{attrs:{trigger:["click"]}},[e("a",{staticClass:"ant-dropdown-link",on:{click:function(t){return t.preventDefault()}}},[t._v(" "+t._s(t.adminStateTxt)+" "),e("a-icon",{attrs:{type:"down"}})],1),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[e("a-menu-item",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.checkadmin("0")}}},[t._v("停留时间")])]),e("a-menu-item",[e("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.checkadmin("1")}}},[t._v("未联系")])])],1)],1)],1)]),e("span",[t._v("超过")]),e("div",{staticClass:"number-input"},[e("a-input-number",{staticClass:"followNumber",attrs:{min:0,max:100},model:{value:t.adminNotifyDays,callback:function(e){t.adminNotifyDays=e},expression:"adminNotifyDays"}})],1),e("span",[t._v("天后，次日")]),e("span",{staticClass:"date-input"},[e("a-time-picker",{staticClass:"timer",attrs:{format:"HH:mm",placeholder:"请选择时间"},on:{change:t.changeAdminDate},model:{value:t.dateAdminTime,callback:function(e){t.dateAdminTime=e},expression:"dateAdminTime"}})],1),e("span",[t._v("提醒")])]),e("div",{staticClass:"remind-preview"},[t._v("客户【"+t._s(t.adminStateTxt)+"】时间超过了【"+t._s(t.adminNotifyDays)+"天】后，次日【"+t._s(t.showadmintime)+"】提醒员工")])])])])]),e("div",{staticClass:"confirm-btns"},[e("a-button",{on:{click:t.cancel}},[t._v("取消")]),e("a-button",{attrs:{type:"primary"},on:{click:t.OkSave}},[t._v("保存")])],1)])}),o=[],r=(i("b0c0"),i("2637")),f=i("e88b"),c={props:{choicetype:{type:String,default:""}},data:function(){return{Copywriting:-1!=this.choicetype.indexOf("add")?"添加":"编辑",followStaff:!0,typeStatusData:-1!=this.choicetype.indexOf("add")?"add":"edit",followStaffTxt:"已关闭",followStateTxt:"停留时间",adminStaff:!1,adminStaffTxt:"已关闭",adminStateTxt:"停留时间",userIds:[],stageName:"",stageDescribe:"",staffNotifyStatus:1,staffNotifyDays:7,dateStaffTime:this.$moment("09:00","HH:mm"),staffNotifyHour:9,staffNotifyMinute:0,showStafftime:"09:00",isStaffNotify:0,adminNotifyStatus:1,isAdminNotify:1,adminNotifyDays:14,dateAdminTime:this.$moment("09:00","HH:mm"),adminNotifyHour:9,adminNotifyMinute:0,showadmintime:"09:00",defaultSelectList:[],stageId:void 0}},mounted:function(){var t=JSON.parse(sessionStorage.getItem("customerStageDetail"));t?this.getDetail(t):this.emptyDate()},computed:{},methods:{OkSave:function(){if(this.stageName)if(!this.followStaff||this.showStafftime)if(this.adminStaff&&(!this.showadmintime||this.defaultSelectList.length<=0))this.$message.warning("请完成管理员跟进提醒");else{var t=this.getParams();"add"==this.typeStatusData?this.addSave(t):this.updateSave(t)}else this.$message.warning("请完成员工跟进提醒");else this.$message.warning("请输入阶段名称")},addSave:function(t){var e=this;return Object(f["f"])(t).then((function(t){var i={flag:"1"};e.$message.success("添加成功"),e.$emit("saveBox",i)})).catch((function(t){e.$message.error(t)}))},updateSave:function(t){var e=this;return Object(f["g"])(t).then((function(t){var i={flag:"1"};e.$message.success("更新成功"),e.$emit("saveBox",i)})).catch((function(t){e.$message.error(t)}))},changeStaffDate:function(t,e){if(e[0]){this.dateStaffTime=t,this.staffNotifyHour=t.get("hours");var i=this.staffNotifyHour<10?"0"+this.staffNotifyHour:this.staffNotifyHour;this.staffNotifyMinute=t.get("minutes");var a=this.staffNotifyMinute<10?"0"+this.staffNotifyMinute:this.staffNotifyMinute;this.showStafftime=i+":"+a}else this.dateStaffTime=null,this.showStafftime=""},changeAdminDate:function(t,e){if(e[0]){this.dateAdminTime=t,this.adminNotifyHour=t.get("hours");var i=this.adminNotifyHour<10?"0"+this.adminNotifyHour:this.adminNotifyHour;this.adminNotifyMinute=t.get("minutes");var a=this.adminNotifyMinute<10?"0"+this.adminNotifyMinute:this.adminNotifyMinute;this.showadmintime=i+":"+a}else this.dateAdminTime=null,this.showadmintime=""},checkadmin:function(t){"0"==t?(this.adminNotifyStatus=1,this.adminStateTxt="停留时间"):(this.adminNotifyStatus=2,this.adminStateTxt="未联系")},checkfollow:function(t){"0"==t?(this.staffNotifyStatus=1,this.followStateTxt="停留时间"):(this.staffNotifyStatus=2,this.followStateTxt="未联系")},selectCustom:function(t){this.defaultSelectList=t},cancel:function(){var t={flag:"0"};this.$emit("saveBox",t)},onFollowStaff:function(){this.followStaff?(this.followStaffTxt="已开启",this.isStaffNotify=0):(this.followStaffTxt="已关闭",this.isStaffNotify=1)},onAdminStaff:function(){this.adminStaff?(this.adminStaffTxt="已开启",this.isAdminNotify=0):(this.adminStaffTxt="已关闭",this.isAdminNotify=1)},getParams:function(){var t=this.defaultSelectList.map((function(t){return{adminAvatar:t.avatar,adminExtId:t.userid}})),e={stageId:this.stageId,isAdminNotify:this.adminStaff?"0":"1",isStaffNotify:this.followStaff?"0":"1",stageName:this.stageName,stageDescribe:this.stageDescribe,adminNotifyStatus:this.adminNotifyStatus,adminNotifyDays:this.adminNotifyDays,adminNotifyHour:this.adminNotifyHour,adminNotifyMinute:this.adminNotifyMinute,admins:t,staffNotifyStatus:this.staffNotifyStatus,staffNotifyDays:this.staffNotifyDays,staffNotifyHour:this.staffNotifyHour,staffNotifyMinute:this.staffNotifyMinute};return e},getDetail:function(t){if("0"==t.isAdminNotify?(this.adminStaff=!0,this.adminStaffTxt="已开启"):(this.adminStaff=!1,this.adminStaffTxt="已关闭"),"0"==t.isStaffNotify?(this.followStaff=!0,this.followStaffTxt="已开启"):(this.followStaff=!1,this.followStaffTxt="已关闭"),this.stageId=t.stageId||void 0,this.stageName=t.stageName||"",this.stageDescribe=t.stageDescribe||"",this.adminNotifyStatus=t.adminNotifyStatus,"1"==this.adminNotifyStatus?this.adminStateTxt="停留时间":this.adminStateTxt="未联系",this.adminNotifyDays=t.adminNotifyDays||14,this.adminNotifyHour=t.adminNotifyHour||9,this.adminNotifyMinute=t.adminNotifyMinute||0,this.adminStaff){var e=this.adminNotifyHour<10?"0"+this.adminNotifyHour:this.adminNotifyHour,i=this.adminNotifyMinute<10?"0"+this.adminNotifyMinute:this.adminNotifyMinute;this.dateAdminTime=this.$moment(e+":"+i,"HH:mm")}if(this.staffNotifyStatus=t.staffNotifyStatus,"1"==this.staffNotifyStatus?this.followStateTxt="停留时间":this.followStateTxt="未联系",this.staffNotifyDays=t.staffNotifyDays||7,this.staffNotifyHour=t.staffNotifyHour||9,this.staffNotifyMinute=t.staffNotifyMinute||0,this.followStaff){var a=this.staffNotifyHour<10?"0"+this.staffNotifyHour:this.staffNotifyHour,s=this.staffNotifyMinute<10?"0"+this.staffNotifyMinute:this.staffNotifyMinute;this.dateStaffTime=this.$moment(a+":"+s,"HH:mm")}t.admins.length>0?this.defaultSelectList=t.admins.map((function(e){return t.userid=e.adminExtId,t.name=e.name,t.thumbAvatar=e.avatar,Object.assign({},t)})):this.defaultSelectList=[]},emptyDate:function(){this.stageId=void 0,this.adminStaff=!1,this.adminStaffTxt="已关闭",this.followStaff=!0,this.followStaffTxt="已开启",this.stageName="",this.stageDescribe="",this.adminNotifyStatus=1,this.adminStateTxt="停留时间",this.adminNotifyDays=14,this.adminNotifyHour=9,this.adminNotifyMinute=0,this.dateAdminTime=this.$moment("09:00","HH:mm"),this.staffNotifyStatus=1,this.followStateTxt="停留时间",this.staffNotifyDays=7,this.staffNotifyHour=9,this.staffNotifyMinute=0,this.dateStaffTime=this.$moment("09:00","HH:mm"),this.defaultSelectList=[]}},watch:{choicetype:function(t,e){if(-1!=t.indexOf("add"))this.typeStatusData="add",this.Copywriting="添加",this.emptyDate(),sessionStorage.removeItem("customerStageDetail");else{this.typeStatusData="edit",this.Copywriting="编辑";var i=JSON.parse(sessionStorage.getItem("customerStageDetail"));this.getDetail(i)}}},components:{AllEmployees:r["a"]}},u=c,l=(i("0c0f"),i("2877")),d=Object(l["a"])(u,n,o,!1,null,"dad19308",null),m=d.exports,h={data:function(){return{visibleBox:!1,choicetype:"",manageList:[],unManageList:[],firstManageList:[]}},created:function(){this.getmanageList(),sessionStorage.removeItem("customerStageDetail")},methods:{handleClickBySortUp:function(t,e){var i=this;if(0!==e){var a={stageId:t.stageId,exchangeStageId:this.getBrotherStageId("up",t.stageId)};this.move(a).then((function(t){i.manageList.splice(e-1,0,i.manageList[e]),i.manageList.splice(e+1,1),i.unManageList=[],i.firstManageList=[],i.manageList.map((function(t,e){"0"!=e&&i.unManageList.push(t),i.firstManageList.push(t)})),i.firstManageList.pop()}))}},handleClickBySortDown:function(t,e){var i=this;if(e!==this.manageList.length-1){var a={stageId:t.stageId,exchangeStageId:this.getBrotherStageId("down",t.stageId)};this.move(a).then((function(t){i.manageList.splice(e+2,0,i.manageList[e]),i.manageList.splice(e,1),i.unManageList=[],i.firstManageList=[],i.manageList.map((function(t,e){"0"!=e&&i.unManageList.push(t),i.firstManageList.push(t)})),i.firstManageList.pop()}))}},move:function(t){var e=this;return new Promise((function(i,a){Object(f["e"])(t).then((function(t){i(t)})).catch((function(t){e.$message.error(t),a(t)}))}))},getBrotherStageId:function(t,e){var i=this.manageList,a=i.findIndex((function(t){return t.stageId===e}));return"up"===t?i[a-1].stageId:i[a+1].stageId},getmanageList:function(){var t=this,e={};return this.unManageList=[],this.firstManageList=[],Object(f["d"])(e).then((function(e){null!==e&&void 0!==e&&e.data&&(t.disposeClientList(e.data),e.data.map((function(e,i){"0"!=i&&t.unManageList.push(e),t.firstManageList.push(e)})),t.firstManageList.pop())})).catch((function(e){t.$message.error(e)}))},disposeClientList:function(t){this.manageList=t.map((function(t,e){var i=t.adminNotifyHour<10?"0"+t.adminNotifyHour:t.adminNotifyHour,a=t.adminNotifyMinute<10?"0"+t.adminNotifyMinute:t.adminNotifyMinute,s=t.staffNotifyHour<10?"0"+t.staffNotifyHour:t.staffNotifyHour,n=t.staffNotifyMinute<10?"0"+t.staffNotifyMinute:t.staffNotifyMinute;return t.sTime=i+":"+a,t.aTime=s+":"+n,t.key=e,Object.assign({},t)}))},cancelBox:function(){this.visibleBox=!1},saveBox:function(t){this.visibleBox=!1,"1"==t.flag&&this.getmanageList()},add:function(){if(this.manageList.length>=8)this.$message.warning("最多支持添加8个阶段状态");else{var t=(new Date).getTime();this.choicetype="add"+t,this.visibleBox=!0}},edit:function(t){this.visibleBox=!0;var e=(new Date).getTime(),i=JSON.stringify(t);sessionStorage.setItem("customerStageDetail",i),this.choicetype="edit"+e},deleteList:function(t,e,i){e<=0?this.sureDeletel(t,e,i):this.dissatisfaction(t,e)},dissatisfaction:function(t,e){this.$info({title:"提示",icon:"",okText:"确定",content:"【客户状态：".concat(t,"】下还有").concat(e,"个客户，请将该状态下的客户转移至其他客户状态后再删除"),onOk:function(){}})},sureDeletel:function(t,e,i){var a=this;this.$confirm({title:"删除",icon:"",okText:"删除",content:"是否确定删除【客户状态：".concat(t,"】"),onOk:function(){Object(f["c"])({stageId:i}).then((function(t){a.$message.success("删除成功"),a.getmanageList()})).catch((function(t){a.$message.error(t)}))}})}},components:{AddEdit:m}},g=h,p=(i("3a45"),Object(l["a"])(g,a,s,!1,null,"667b7004",null));e["default"]=p.exports},e88b:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o})),i.d(e,"h",(function(){return r})),i.d(e,"f",(function(){return f})),i.d(e,"g",(function(){return c})),i.d(e,"d",(function(){return u})),i.d(e,"c",(function(){return l})),i.d(e,"e",(function(){return d}));var a=i("b775"),s={getCustomerList:"/client_manager/client/getCustomerList",setCustomerStage:"/client_manager/client/setCustomerStage",save:"/client_transformation/customerstage/save",update:"/client_transformation/customerstage/update",list:"/client_transformation/customerstage/list",delete:"/client_transformation/customerstage/delete",order:"/client_transformation/customerstage/change/order",getAdmins:"/enterprise/staff/getAdmins"};function n(t){return Object(a["b"])({url:s.getAdmins,method:"get",params:t})}function o(t){return Object(a["b"])({url:s.getCustomerList,method:"get",params:t})}function r(t){return Object(a["b"])({url:s.setCustomerStage,method:"post",data:t})}function f(t){return Object(a["b"])({url:s.save,method:"post",data:t})}function c(t){return Object(a["b"])({url:s.update,method:"post",data:t})}function u(t){return Object(a["b"])({url:s.list,method:"post",data:t})}function l(t){return Object(a["b"])({url:s.delete,method:"post",data:t})}function d(t){return Object(a["b"])({url:s.order,method:"post",params:t})}}}]);