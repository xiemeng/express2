(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27848829"],{1929:function(t,n,e){"use strict";e("9782")},2909:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var i=e("6b75");function r(t){if(Array.isArray(t))return Object(i["a"])(t)}e("a4d3"),e("e01a"),e("d3b7"),e("d28b"),e("3ca3"),e("ddb0"),e("a630");function a(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var o=e("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return r(t)||a(t)||Object(o["a"])(t)||s()}},"299d":function(t,n,e){},"3dd3":function(t,n,e){"use strict";e.d(n,"f",(function(){return a})),e.d(n,"e",(function(){return o})),e.d(n,"a",(function(){return s})),e.d(n,"c",(function(){return c})),e.d(n,"g",(function(){return u})),e.d(n,"h",(function(){return l})),e.d(n,"d",(function(){return d})),e.d(n,"b",(function(){return f}));var i=e("b775"),r={getlist:"/client_transformation/customersend/list",addSave:"/client_transformation/customersend/save",infoDetails:"/client_transformation/customersend/info/",count:"/client_transformation/customersend/count",remind:"/client_transformation/customersend/remind",staffInfo:"/client_transformation/customersend/info/staff",customerInfo:"/client_transformation/customersend/info/customer",cancel:"/client_transformation/customersend/cancel"};function a(t,n){return Object(i["b"])({url:r.infoDetails+n,method:"get",params:t})}function o(t){return Object(i["b"])({url:r.getlist,method:"post",data:t})}function s(t){return Object(i["b"])({url:r.addSave,method:"post",data:t})}function c(t){return Object(i["b"])({url:r.count,method:"post",data:t})}function u(t){return Object(i["b"])({url:r.remind,method:"post",data:t})}function l(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;return Object(i["b"])({url:r.staffInfo+"/"+t+"?".concat(n),method:"get"})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;return Object(i["b"])({url:r.customerInfo+"/"+t+"?".concat(n),method:"get"})}function f(t){return Object(i["b"])({url:r.cancel,method:"post",data:t})}},"8e34":function(t,n,e){"use strict";e("299d")},9782:function(t,n,e){},a68f:function(t,n,e){"use strict";var i=function(){var t=this,n=t._self._c;return n("div",{staticClass:"page-wrap"},[n("div",[n("p",{staticStyle:{"text-align":"right"}},[n("a-icon",{staticClass:"close-circle",attrs:{type:"close-circle"},on:{click:function(n){return t.$emit("cancle")}}})],1),n("PhoneModel",{attrs:{textList:t.textList}})],1)])},r=[],a=e("e6b1"),o={name:"AlertPhone",components:{PhoneModel:a["a"]},props:{textList:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{}},s=o,c=(e("b04e"),e("2877")),u=Object(c["a"])(s,i,r,!1,null,"28c760da",null);n["a"]=u.exports},b04e:function(t,n,e){"use strict";e("f597")},b9cd:function(t,n,e){"use strict";e.d(n,"l",(function(){return i})),e.d(n,"j",(function(){return r})),e.d(n,"o",(function(){return a})),e.d(n,"n",(function(){return o})),e.d(n,"b",(function(){return s})),e.d(n,"g",(function(){return c})),e.d(n,"d",(function(){return u})),e.d(n,"a",(function(){return l})),e.d(n,"f",(function(){return d})),e.d(n,"k",(function(){return f})),e.d(n,"i",(function(){return m})),e.d(n,"e",(function(){return p})),e.d(n,"p",(function(){return g})),e.d(n,"c",(function(){return h})),e.d(n,"h",(function(){return v})),e.d(n,"q",(function(){return x})),e.d(n,"m",(function(){return b}));var i="LOSS_STATUS",r="GROUP_STATUS",a="ORDER_WAY",o="ORDER_CONDITION",s="ADD_WAY",c="GENDER",u="CUSTOMER_STATUS",l={0:"待分配",1:"待添加",2:"待通过",3:"已添加",4:"导入中"},d={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},f=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:1},{text:"已不是好友",color:"#ffd4b6",id:2},{text:"客户接收达上限",color:"#fbe8ae",id:3},{text:"本月消息已经达到上限",color:"",id:4}],m=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:2},{text:"没有群发任务",color:"",id:4}],p={1:"微信",2:"企业微信"},g=[{id:"immediately",value:"立即发送"},{id:"timing",value:"定时发送"}],h={0:"渠道码",1:"区域扫码",2:"自动拉群",3:"一客一码",4:"加好友",5:"通过群码拉群"},v={0:{text:"拉人中",color:"green"},1:{text:"未开始",color:""},2:{text:"已达上限",color:"orange"},3:{text:"已停用",color:"red"}},x={0:{text:"创建失败",color:"green",id:0},1:{text:"待发送",color:"rgba(34,34,34,.85)",id:1},2:{text:"已发送",color:"rgba(34,34,34,.85)",id:2},3:{text:"已取消",color:"rgba(34,34,34,.85)",id:3},4:{text:"提醒发送",color:"#1890ff",id:4}},b=[{text:"文章",id:"0",format:""},{text:"链接",id:"1"},{text:"海报",id:"2",max:2,format:".bmp,.jpg,.jpeg,.png,.tif,.gif,.pcx,.tga,.exif,.fpx,.svg,.psd,.cdr,.pcd,.dxf,.ufo,.eps,.ai,.raw,.WMF,.webp",tips:"请上传png、jpg格式不超过2M的文件"},{text:"视频",id:"7",max:2e5,format:".MP4",tips:"请上传格式为MP4的视频文件"},{text:"PDF",id:"3",max:20,format:".pdf",icon:"/icons/pdf.png",tips:"请上传PDF格式不超过20M的文件"},{text:"PPT",id:"4",max:20,format:".pptx,.ppt,.pps",icon:"/icons/ppt.svg",tips:"请上传PPT格式不超过20M的文件"},{text:"表格",id:"5",max:20,format:".xlsx,.xls,.csv",icon:"/icons/excel.svg",tips:"请上传csv、xlsx格式不超过20M的文件"},{text:"文档",id:"6",max:20,format:".txt,.doc,.docx",icon:"/icons/word.svg",tips:"请上传doc、txt.docx格式不超过20M的文件"}]},da92:function(t,n,e){"use strict";function i(t,n){return void 0===n&&(n=15),+parseFloat(Number(t).toPrecision(n))}function r(t){var n=t.toString().split(/[eE]/),e=(n[0].split(".")[1]||"").length-+(n[1]||0);return e>0?e:0}function a(t){if(-1===t.toString().indexOf("e"))return Number(t.toString().replace(".",""));var n=r(t);return n>0?i(Number(t)*Math.pow(10,n)):Number(t)}function o(t){m&&(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)&&console.warn(t+" is beyond boundary when transfer to integer, the results may not be accurate")}function s(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var i=n[0],r=n.slice(1);return r.reduce((function(n,e){return t(n,e)}),i)}}var c=s((function(t,n){var e=a(t),i=a(n),s=r(t)+r(n),c=e*i;return o(c),c/Math.pow(10,s)})),u=s((function(t,n){var e=Math.pow(10,Math.max(r(t),r(n)));return(c(t,e)+c(n,e))/e})),l=s((function(t,n){var e=Math.pow(10,Math.max(r(t),r(n)));return(c(t,e)-c(n,e))/e})),d=s((function(t,n){var e=a(t),s=a(n);return o(e),o(s),c(e/s,i(Math.pow(10,r(n)-r(t))))}));function f(t,n){var e=Math.pow(10,n),i=d(Math.round(Math.abs(c(t,e))),e);return t<0&&0!==i&&(i=c(i,-1)),i}var m=!0;function p(t){void 0===t&&(t=!0),m=t}var g={strip:i,plus:u,minus:l,times:c,divide:d,round:f,digitLength:r,float2Fixed:a,enableBoundaryChecking:p};n["a"]=g},e6b1:function(t,n,e){"use strict";var i=function(){var t=this,n=t._self._c;return n("div",{staticClass:"phone-model"},[n("img",{staticClass:"bg",attrs:{src:"/imgs/chatBg.png"}}),n("div",{staticClass:"contant"},[n("p",{staticClass:"time"},[t._v(t._s(t.time))]),t.textList.length>0?n("ul",t._l(t.textList,(function(e,i){return n("li",{key:i,staticClass:"contant-list"},["img"===e.type?[n("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),n("div",{staticClass:"contant-main"},[n("img",{staticClass:"upload-img",attrs:{src:e.pic_url.compress}})])]:t._e(),"link"===e.type?[n("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),n("div",{staticClass:"contant-title"},[n("a-tooltip",{attrs:{title:e.linkTitle}},[n("p",{staticClass:"contant-subtitle"},[t._v(t._s(e.linkTitle))])]),n("div",{staticClass:"contant-contant"},[e.desc?n("a-tooltip",{attrs:{title:e.desc}},[n("span",[t._v(t._s(e.desc))])]):t._e(),n("a-avatar",{attrs:{src:e.coverUrl.compress,size:32,shape:"square"}})],1)],1)]:t._e(),e.type?t._e():[n("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),n("div",{staticClass:"contant-main"},[t._v(t._s(e))])]],2)})),0):t._e()])])},r=[],a={name:"PhoneModel",data:function(){return{time:this.$moment().format("HH:mm")}},props:{textList:{type:[Array],default:function(){return[]}}},watch:{textList:function(){}}},o=a,s=(e("8e34"),e("2877")),c=Object(s["a"])(o,i,r,!1,null,"1aa7a172",null);n["a"]=c.exports},ef07:function(t,n,e){"use strict";e.r(n);e("9911");var i=function(){var t=this,n=t._self._c;return n("div",{staticClass:"page-box"},[n("header",{staticClass:"header"},[n("a-space",{attrs:{size:12}},[n("a-button",{attrs:{type:"primary",size:"large"},on:{click:function(n){return t.$router.push({name:"NewGroup",query:{state:"add"}})}}},[t._v(" 新建群发 ")])],1)],1),n("a-table",{staticClass:"background-white",attrs:{pagination:t.pagination,columns:t.columns,"data-source":t.channelList},on:{change:t.change},scopedSlots:t._u([{key:"massContent",fn:function(e,i,r){return n("div",{attrs:{index:r}},[n("div",{staticClass:"contant-wrap"},[n("p",{staticStyle:{color:"#139A32","margin-bottom":"8px"}},[t._v("[共"+t._s(t.getContantLength(i.context))+"条]")]),t._l(i.context,(function(e,i){return n("div",{key:i},[e.content?n("span",[t._v(t._s(e.content))]):t._l(e,(function(e,i){return n("div",{key:i},["image"===e.msgtype&&e.image?[n("a-avatar",{attrs:{src:e.image.pic_url,shape:"square"}})]:t._e(),"link"===e.msgtype?[n("div",{staticClass:"link-box"},[n("a-avatar",{attrs:{src:e.link.picurl,shape:"square",size:60}}),n("div",{staticClass:"link-right"},[n("h5",[t._v(t._s(e.link.title))]),n("p",[t._v(t._s(e.link.desc))])])],1)]:t._e()],2)}))],2)}))],2),t.getContantLength(i.context)>=3?n("a-button",{attrs:{type:"link"},on:{click:function(n){return t.lookAll(i.context)}}},[t._v(" 查看全部 ")]):t._e()],1)}},{key:"operation",fn:function(e){return n("div",{},["0"==e.missionStatus?n("span",{staticClass:"create-error",attrs:{data:e.missionId}},[t._v(" 创建失败 "),n("a-tooltip",{attrs:{title:"在所选范围内没有满足条件的客户"}},[n("a-icon",{staticStyle:{"margin-left":"4px"},attrs:{type:"question-circle"}})],1)],1):n("div",[n("a-tooltip",{attrs:{title:e.memberNotSent?"":"没有未发送的成员，无法发送提醒"}},[n("a-button",{attrs:{disabled:!e.memberNotSent,type:"link"},on:{click:function(n){return t.remindGruoup(e.missionId,e.memberNotSent&&2===e.taskStatus.id)}}},[e.memberNotSent&&2===e.taskStatus.id?n("span",[t._v(" 提醒发送 ")]):n("span",{style:{color:e.taskStatus.color}},[t._v(" "+t._s(e.taskStatus.text)+" ")])])],1),n("a-button",{attrs:{type:"link"},on:{click:function(n){return t.$router.push({name:"distributionDetails",query:{missionId:e.missionId}})}}},[t._v(" 详情 ")]),e.memberNotSent&&1===e.taskStatus.id?n("a-button",{attrs:{type:"link"},on:{click:function(n){return t.cancleSend(e)}}},[t._v(" 取消发送 ")]):t._e()],1)])}}])}),n("AlertPhone",{directives:[{name:"show",rawName:"v-show",value:t.isAlertPhone,expression:"isAlertPhone"}],attrs:{textList:t.textList},on:{cancle:function(n){t.isAlertPhone=!1}}})],1)},r=[],a=e("5530"),o=e("2909"),s=(e("d81d"),e("d3b7"),e("3dd3")),c=e("b9cd"),u=e("da92"),l=e("a68f"),d={name:"CustomerGroup",components:{AlertPhone:l["a"]},data:function(){return{channelList:[],columns:[{title:"群发类型",key:"sendTypeText",dataIndex:"sendTypeText"},{title:"发送时间",key:"sendTime",dataIndex:"sendTime"},{title:"群发内容",key:"massContent",dataIndex:"massContent",scopedSlots:{customRender:"massContent"}},{title:"已发送成员",key:"sendedStaffCount",dataIndex:"sendedStaffCount"},{title:"送达客户",key:"successCount",dataIndex:"successCount"},{title:"未发送成员",key:"memberNotSent",dataIndex:"memberNotSent"},{title:"未送达客户",key:"undeliveredCustomer",dataIndex:"undeliveredCustomer"},{title:"操作",key:"operation",align:"right",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],pagination:{current:1,pageSize:10,total:0},isAlertPhone:!1,textList:[]}},created:function(){this.getPageList()},methods:{getContantLength:function(t){var n,e=0;return t.text&&(e=1),(null===(n=t.attachments)||void 0===n?void 0:n.length)>0&&(e+=t.attachments.length),e},lookAll:function(t){this.textList=[];var n,e=t.attachments.map((function(t){return"link"===t.msgtype?{type:"link",linkTitle:t.link.title,desc:t.link.desc,coverUrl:{compress:t.link.picurl}}:"image"===t.msgtype&&t.image?{type:"img",pic_url:{compress:t.image.pic_url}}:void 0}));(t.text&&this.textList.push(t.text.content),e)&&(n=this.textList).push.apply(n,Object(o["a"])(e));this.isAlertPhone=!0},change:function(t){var n=t.current;this.pagination.current=n,this.getPageList()},cancleSend:function(t){var n=this;Object(s["b"])([t.missionId]).then((function(t){n.$message.success("取消成功"),n.getPageList()})).catch((function(t){n.$message.error(t)}))},getPageList:function(){var t=this,n={page:this.pagination.current,limit:this.pagination.pageSize};this.loading=!0,Object(s["e"])(n).then((function(n){n.data&&(t.channelList=n.data.list.map((function(t){"1"==(null===t||void 0===t?void 0:t.sendType)?t.sendTypeText="立即发送":t.sendTypeText="定时发送";var n=t.totalStaffCount||0,e=t.sendedStaffCount||0,i=t.totalCustomerCount||0,r=t.successCount||0,o=t.failLimitCount||0,s=t.failNoFriendCount||0;t.memberNotSent=u["a"].minus(n,e),t.undeliveredCustomer=u["a"].minus(i,r,o,s),t.context=JSON.parse(t.messageContent),t.taskStatus=c["q"][t.missionStatus];var l=Object(a["a"])(Object(a["a"])({},t),{},{key:t.missionId});return l.operation=l,l})),t.pagination.total=n.data.totalCount)})).catch((function(n){t.$message.error(n)})).finally((function(){return t.loading=!1}))},remindGruoup:function(t,n){if(n){var e=this;this.$confirm({title:"提示",icon:"",content:"确认后将会给所有未发送成员发送提醒通知，是否发送？",onOk:function(){e.remind(t)}})}},remind:function(t){var n=this,e={missionId:t};Object(s["g"])(e).then((function(t){n.$message.success(t.data)})).catch((function(t){n.$message.error(t)}))}}},f=d,m=(e("1929"),e("2877")),p=Object(m["a"])(f,i,r,!1,null,"66b2279c",null);n["default"]=p.exports},f597:function(t,n,e){}}]);