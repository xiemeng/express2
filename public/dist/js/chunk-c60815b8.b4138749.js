(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c60815b8"],{"161b":function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return o}));var i=a("b775"),n={queryGroupPageByGroupSop:"/client_group/customerGroup/queryGroupPageByGroupSop",addOrEditGroupTag:"/client_group/groupTagController/addOrEditGroupTag",delGroupTag:"/client_group/groupTagController/delGroupTag",queryGroupTag:"/client_group/groupTagController/queryGroupTag"};function s(t){return Object(i["b"])({url:n.addOrEditGroupTag,method:"post",data:t})}function r(t){return Object(i["b"])({url:n.delGroupTag,method:"post",data:t})}function o(t){return Object(i["b"])({url:n.queryGroupTag,method:"post",data:t})}},"1bee":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"b",(function(){return s}));a("a9e3"),a("ac1f"),a("5319"),a("4d63"),a("25f0");function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss",a=e,i=new Date(Number(t)),n={"M+":i.getMonth()+1,"D+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),"S+":i.getMilliseconds()};for(var s in/(y+)/i.test(a)&&(a=a.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+s+")").test(a)&&(a=a.replace(RegExp.$1,1===RegExp.$1.length?n[s]:("00"+n[s]).substr((""+n[s]).length)));return a}function n(t){var e=parseInt(t/3600)<10?"0"+parseInt(t/3600):parseInt(t/3600),a=parseInt(t%3600/60)<10?"0"+parseInt(t%3600/60):parseInt(t%3600/60);return e+":"+a}function s(t,e){var a=Date.parse(new Date),i=r(a,t),n=new Date(i),s=n.getTime(),o=r(a,e),c=new Date(o),l=c.getTime();return"start"?s>=l:l<=s}function r(t,e){var a=new Date(t),i=a.getFullYear()+"-",n=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",s=a.getDate()+" ";a.getHours(),a.getMinutes(),a.getSeconds();return i+n+s+e+":00"}},2314:function(t,e,a){"use strict";a("afd2")},"260e":function(t,e,a){},"299d":function(t,e,a){},"2bf4":function(t,e,a){"use strict";var i=a("2909"),n=a("5530"),s=(a("d3b7"),a("d81d"),a("3ca3"),a("ddb0"),a("9911"),a("a15b"),a("a9e3"),a("d885")),r=a("cf5f");e["a"]={methods:{addAccessory:function(t){this.attachments=t},uploadMedia:function(t){var e=this,a=t||this.attachments;return new Promise((function(t,i){var n=(null===a||void 0===a?void 0:a.map((function(t){return new Promise((function(a,i){if("link"===t.type)e.interactiveRadarAdd(t).then((function(t){a(t)}));else if("img"===t.type&&t.pic_url.file){var n=new FormData;n.append("file",t.pic_url.file),n.append("dir","clientTransformation"),n.append("type","image"),Object(r["y"])(n).then((function(e){t.pic_url.fileUrl=e.data.fileUrl,t.pic_url.mediaId=e.data.mediaId,a(e.data)}))}else a()}))})))||[];Promise.all(n).then((function(e){t()})).catch((function(t){e.$message.error(t||t.message),e.loading=!1,i(t)}))}))},channelCodeUploadFileFun:function(t){var e=this,a=t||this.attachments;return new Promise((function(t,i){var n=(null===a||void 0===a?void 0:a.map((function(t){return new Promise((function(a,i){if("link"===t.type)e.interactiveRadarAdd(t).then((function(t){a(t)}));else if("img"===t.type&&t.pic_url.file){var n=new FormData;n.append("file",t.pic_url.file),Object(r["d"])(n).then((function(e){t.pic_url.fileUrl=e.data.fileUrl,t.pic_url.mediaId=e.data.mediaId,a(e.data)}))}else a()}))})))||[];Promise.all(n).then((function(e){t()})).catch((function(t){e.$message.error(t||t.message),e.loading=!1,i(t)}))}))},getAttachments:function(t){var e=t||this.attachments;return null===e||void 0===e?void 0:e.map((function(t){if("img"===t.type)return{msgtype:"image",image:{media_id:t.pic_url.mediaId,pic_url:t.pic_url.fileUrl||t.pic_url.compress,title:t.title}};if("link"===t.type){var e="normal_link";t.linktype?e=t.linktype:t.radarId&&(e="radar_link");var a=t.radarId||t.formId||t.id;return a&&(a=String(a)),{msgtype:"link",link:{title:t.linkTitle,picurl:t.picurl||t.coverUrl.compress,desc:t.desc,url:t.url||t.link||t.activityLink,radarId:a,type:e}}}}))},interactiveRadarAdd:function(t){var e=this;return new Promise((function(a,i){e.getParamsLink(t).then((function(e){t.isRadar&&t.randerIsEdit?Object(s["f"])(e).then((function(e){t.radarId=e.data.radarId,t.url=e.data.radarLink+t.source,a(e)})).catch((function(t){i(t)})):a()}))}))},getParamsLink:function(t){return new Promise((function(e,a){var i=new FormData,n=t.isCustomerTag?[{autoMarkTagBitmaps:t.selectCustomerTagList.map((function(t){return t.bitmap})).join(",")}]:[];if(i.append("type",1),i.append("radarName",t.linkTitle),i.append("link",t.url),i.append("activityNotify",Number(t.activityNotify)),i.append("behaviorNotify",Number(t.behaviorNotify)),i.append("tagRule",JSON.stringify(n)),i.append("title",t.radarTitle),i.append("desc",t.desc),i.append("hasCustomerTag",Number(t.isCustomerTag)),t.isScoreRule){var s=JSON.stringify(t.ruleDetails.map((function(t){var e,a;return{autoMarkTagBitmaps:null===(e=t.selectTagList)||void 0===e||null===(a=e.map((function(t){return t.bitmap})))||void 0===a?void 0:a.join(","),hasTag:Number(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count||0}})));i.append("scoreRule",s)}if(t.coverUrl.file){var o=new FormData;o.append("file",t.coverUrl.file),o.append("dir","clientTransformation"),Object(r["m"])(o).then((function(a){i.append("coverUrl",a.data),t.picurl=a.data,e(i)})).catch((function(t){a(t)}))}else e(i)}))},attachmentsDetail:function(t){return null===t||void 0===t?void 0:t.map((function(t){var e,a,i,s,r,o="",c="",l="",u="",d={};("image"===t.msgtype&&(o="图文",c="visibileAddImg",u="img",l={compress:t.image.pic_url}),"link"===t.msgtype)&&(u="link",t.linktype=t.link.type,"radar_link"!==t.linktype&&"normal_link"!==t.linktype||(c="visibileAddLink",o="链接"),"form_link"===t.linktype&&(c="visibileForm",o="自定义表单"),"luck_link"===t.linktype&&(c="visibileLuckDraw",o="抽奖活动"),d={compress:t.link.picurl},t.linkTitle=t.link.title,t.desc=t.link.desc,t.url=t.link.url,t.link.interactRadar&&(t.isRadar=!0,t.behaviorNotify=Boolean(t.link.interactRadar.behaviorNotify),t.activityNotify=Boolean(t.link.interactRadar.activityNotify),t.isCustomerTag=(null===(e=t.link.interactRadar.tagRules)||void 0===e?void 0:e.length)>0,t.radarId=null===(a=t.link.interactRadar)||void 0===a?void 0:a.radarId,t.radarTitle=t.link.title,t.selectCustomerTagList=null===(i=t.link.interactRadar.tagRules[0])||void 0===i||null===(s=i.customerTags)||void 0===s?void 0:s.map((function(t){return Object(n["a"])(Object(n["a"])({},t),{},{key:t.tagId})})),t.isScoreRule=(null===(r=t.link.interactRadar.scoreRules)||void 0===r?void 0:r.length)>0,t.ruleDetails=t.link.interactRadar.scoreRules.map((function(t){var e;return Object(n["a"])(Object(n["a"])({},t),{},{autoMarkTagBitmaps:t.autoMarkTagBitmaps,selectTagList:null===(e=t.customerTags)||void 0===e?void 0:e.map((function(t){return Object(n["a"])(Object(n["a"])({},t),{},{key:t.tagId})})),hasTag:Boolean(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count})}))));return Object(n["a"])(Object(n["a"])({},t),{},{key:c,pic_url:l,type:u,coverUrl:d,typeText:o})}))}},computed:{state:function(){return this.$route.query.state},isAddText:function(){return"add"===this.$route.query.state?"新建":"修改"},textList:function(){var t=[];return this.messageOne&&t.push(this.messageOne),this.attachments&&t.push.apply(t,Object(i["a"])(this.attachments)),t}}}},"3dd3":function(t,e,a){"use strict";a.d(e,"f",(function(){return s})),a.d(e,"e",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"c",(function(){return c})),a.d(e,"g",(function(){return l})),a.d(e,"h",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return f}));var i=a("b775"),n={getlist:"/client_transformation/customersend/list",addSave:"/client_transformation/customersend/save",infoDetails:"/client_transformation/customersend/info/",count:"/client_transformation/customersend/count",remind:"/client_transformation/customersend/remind",staffInfo:"/client_transformation/customersend/info/staff",customerInfo:"/client_transformation/customersend/info/customer",cancel:"/client_transformation/customersend/cancel"};function s(t,e){return Object(i["b"])({url:n.infoDetails+e,method:"get",params:t})}function r(t){return Object(i["b"])({url:n.getlist,method:"post",data:t})}function o(t){return Object(i["b"])({url:n.addSave,method:"post",data:t})}function c(t){return Object(i["b"])({url:n.count,method:"post",data:t})}function l(t){return Object(i["b"])({url:n.remind,method:"post",data:t})}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;return Object(i["b"])({url:n.staffInfo+"/"+t+"?".concat(e),method:"get"})}function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;return Object(i["b"])({url:n.customerInfo+"/"+t+"?".concat(e),method:"get"})}function f(t){return Object(i["b"])({url:n.cancel,method:"post",data:t})}},"3de3":function(t,e,a){"use strict";a("95d0")},"3fc5":function(t,e,a){},"666f":function(t,e,a){"use strict";a("aa6e")},"6bd9":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"use-person"},[e("ul",{staticClass:"a-line-omit",on:{click:function(e){t.visibleUsePerson=!0}}},[t._l(t.usePersionList,(function(a){return e("li",{key:a.key,staticClass:"a-line-omit"},[e("a-tooltip",{attrs:{title:a.title}},[a.icon?e("a-icon",{staticClass:"icon",attrs:{type:a.icon}}):e("a-avatar",{staticClass:"imgs",attrs:{size:23,src:a.source.thumbAvatar||t.defaultThumbAvatar}}),e("span",{staticClass:"title"},[t._v(" "+t._s(a.title)+" ")])],1)],1)})),t.usePersionList.length<1?e("p",{staticClass:"font-color-black-25"},[t._v(t._s(t.placeHolder))]):t._e()],2),t.usePersionList.length>2?e("span",{staticClass:"omit"},[t._v("等"+t._s(t.usePersionList.length)+"个账号")]):t._e(),e("a-icon",{attrs:{type:"caret-down"}})],1),e("a-modal",{attrs:{footer:null,width:"680px",centered:""},model:{value:t.visibleUsePerson,callback:function(e){t.visibleUsePerson=e},expression:"visibleUsePerson"}},[e("AddTransfer",t._b({attrs:{type:t.type,title:t.title,selectList:t.usePersionList,selectRoleIdList:t.selectRoleIdList},on:{serviceOk:t.serviceOk,cancle:function(e){t.visibleUsePerson=!1}}},"AddTransfer",t.source,!1))],1)],1)},n=[],s=(a("d81d"),a("1eb1")),r={name:"UsePerson",props:{defaultUsePerson:{type:[Array],default:function(){return[]}},placeHolder:{type:[String],default:""},type:{type:[String],default:""},title:{type:[String],default:"选择成员"},value:{type:[Array],default:function(){return[]}},needControlReturn:{type:Boolean,default:!1},source:{type:Object,default:function(){return{}}}},components:{AddTransfer:s["a"]},data:function(){return{defaultThumbAvatar:a("b5c3"),visibleUsePerson:!1,selectRoleIdList:[],usePersionList:this.value}},watch:{value:function(){this.usePersionList=this.value}},methods:{serviceOk:function(t){var e=this;t.length<1?this.usePersionList=this.defaultUsePerson:this.usePersionList=t,this.usePersionList.map((function(t){t.value=100})),this.needControlReturn||(this.visibleUsePerson=!1),this.$emit("input",this.usePersionList),this.$emit("usePersionInfo",this.usePersionList,(function(){e.visibleUsePerson=!1}))}}},o=r,c=(a("f0b2"),a("2877")),l=Object(c["a"])(o,i,n,!1,null,"de146f5e",null);e["a"]=l.exports},7581:function(t,e,a){"use strict";a("b0c0");var i=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.pageList.length>0?e("ul",{staticClass:"randar-list-wrap"},t._l(t.pageList,(function(a){return e("li",{key:a.formId,staticClass:"randar-list",on:{click:function(e){t.selectRandarId=a.formId}}},[e("header",{staticClass:"randar-head"},[e("div"),e("a-checkbox",{attrs:{checked:t.selectRandarId===a.formId}})],1),e("section",{staticClass:"randar-main"},[e("div",{staticClass:"randar-main-content"},[e("p",[t._v(t._s(a.name))]),e("p",{staticClass:"aks-tips"},[t._v(t._s(a.describe))])]),e("a-avatar",{attrs:{size:40,src:a.cover,shape:"square"}})],1)])})),0):e("a-empty"),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e(),!t.loading&&t.pageList.length>0?e("div",{staticClass:"loading-container"},[t._v("没有更多数据了")]):t._e()],1)])},n=[],s=a("2909"),r=(a("7db0"),a("d3b7"),a("2a86")),o=a("487a"),c=a.n(o),l=a("8f19"),u={name:"AddForm",directives:{infiniteScroll:c.a},components:{CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""}},data:function(){return{sourceModal:{title:"自定义表单"},pagination:{current:1,pageSize:10,total:0},form:{typeText:"自定义表单",type:"link",linkTitle:"",desc:"",coverUrl:{compress:""}},type:"",typeText:{1:"链接",2:"PDF",3:"文章",4:"文章"},typeImg:{1:"/imgs/default-cover.png",2:"/icons/pdf.png",3:"/imgs/default-cover.png",4:"/imgs/default-cover.png"},radarName:"",loading:!1,busy:!1,pageList:[],selectRandarId:""}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{serviceOk:function(){var t=this;if(this.selectRandarId){var e=this.pageList.find((function(e){return e.formId===t.selectRandarId}));e.typeText="自定义表单",e.linkTitle=e.name,e.desc=e.describe,e.type="link",e.key="visibileForm",e.linktype="form_link",e.coverUrl={compress:e.cover},this.$emit("serviceOk",e)}else this.$message.warning("请选择一个自定义表单")},init:function(){var t=this,e={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,source:this.source,status:1};this.loading=!0,Object(l["f"])(e).then((function(e){var a;e.data.list.length>0&&(a=t.pageList).push.apply(a,Object(s["a"])(e.data.list));if(t.pagination.current++,e.data.list.length<t.pagination.pageSize)return t.busy=!0,void(t.loading=!1);t.pagination.total=e.data.total})).catch((function(e){t.$message.error(e||e.message)}))},selectTab:function(t){this.type=t,this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},search:function(){this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},handleInfiniteOnLoad:function(){!this.busy&&this.init()}}},d=u,f=(a("2314"),a("2877")),m=Object(f["a"])(d,i,n,!1,null,"66fbf478",null);e["a"]=m.exports},"7a44":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[e("ul",{staticClass:"list-wrap"},t._l(t.attachments,(function(a,i){return e("li",{key:i,staticClass:"list"},[e("div",[e("a-icon",{staticClass:"button",attrs:{type:"minus-circle"},on:{click:function(e){return t.deleteAttachments(i)}}}),t._v(" 【"+t._s(a.typeText)+"】: "+t._s(a.title||a.linkTitle)+" ")],1),e("a-icon",{staticClass:"button",attrs:{type:"form"},on:{click:function(e){return t.editAttachments(a,i)}}})],1)})),0),e("a-dropdown",{attrs:{placement:"topCenter",trigger:["click"]}},[e("a-button",{staticClass:"add-button",attrs:{type:"link",block:"",size:"large"}},[e("a-icon",{attrs:{type:"plus-circle"}}),t._v(" 添加附件 ")],1),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},t._l(t.menuList,(function(a){return e("a-menu-item",{key:a.id,on:{click:function(e){return t.openAccessory(a.key)}}},[t._v(" "+t._s(a.text)+" ")])})),1)],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"580px"},model:{value:t.visibileAddImg,callback:function(e){t.visibileAddImg=e},expression:"visibileAddImg"}},[e("AddImg",{attrs:{editData:t.editData},on:{cancle:function(e){t.visibileAddImg=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"580px"},model:{value:t.visibileAddLink,callback:function(e){t.visibileAddLink=e},expression:"visibileAddLink"}},[e("AddLink",{attrs:{editData:t.editData,source:t.source,isNeedSelectRadar:t.isNeedSelectRadar,isNeedRader:t.isNeedRader},on:{cancle:function(e){t.visibileAddLink=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"880px"},model:{value:t.visibileForm,callback:function(e){t.visibileForm=e},expression:"visibileForm"}},[e("AddForm",{attrs:{editData:t.editData,source:t.source},on:{cancle:function(e){t.visibileForm=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"880px"},model:{value:t.visibileLuckDraw,callback:function(e){t.visibileLuckDraw=e},expression:"visibileLuckDraw"}},[e("AddluckyDraw",{attrs:{editData:t.editData,source:t.source},on:{cancle:function(e){t.visibileLuckDraw=!1},serviceOk:t.serviceOk}})],1)],1)},n=[],s=(a("a9e3"),a("a434"),function(){var t=this,e=t._self._c;return e("CommonModal",t._b({attrs:{loading:t.loading},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.source,!1),[e("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},t._l(t.formInfoList,(function(t,a){return e("a-form-model-item",{key:a,attrs:{label:t.title,prop:t.prop}},[e("FormList",{staticClass:"input",attrs:{formInfo:t}})],1)})),1)],1)}),r=[],o=(a("d3b7"),a("159b"),a("2a86")),c=a("26f2"),l={name:"AddImg",components:{CommonModal:o["a"],FormList:c["a"]},props:{editData:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},data:function(){return{source:{title:"添加图片"},labelCol:{span:4},wrapperCol:{span:6},formInfoList:[{title:"图片标题",prop:"title",type:"input",tips:"请输入图片标题",maxLength:30,value:""},{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}}],form:{pic_url:{},title:"",type:"img",typeText:"图片",key:"visibileAddImg"},rules:{title:[{required:!1,message:"未填写图片标题"}],pic_url:[{required:!0,message:"未选择图片"}]}}},watch:{editData:{handler:function(){var t;null!==(t=this.editData)&&void 0!==t&&t.type&&(this.form.title=this.editData.title||"",this.form.pic_url=this.editData.pic_url,this.getlistValue())},immediate:!0}},methods:{serviceOk:function(){var t=this;this.getFormValue()&&this.$refs.ruleForm.validate((function(e){if(!e)return!1;t.form.pic_url.compress?t.$emit("serviceOk",t.form):t.$message.warning("图片没有上传")}))},getFormValue:function(){var t=this;return this.formInfoList.forEach((function(e){e.type,t.form[e.prop]=e.value})),!0},getlistValue:function(){var t=this;this.formInfoList.forEach((function(e){e.type,e.value=t.form[e.prop]}))}}},u=l,d=(a("f564"),a("2877")),f=Object(d["a"])(u,s,r,!1,null,"cd8ffb1e",null),m=f.exports,p=a("a2ba"),h=a("7581"),g=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.pageList.length>0?e("ul",{staticClass:"randar-list-wrap"},t._l(t.pageList,(function(a){return e("li",{key:a.id,staticClass:"randar-list",on:{click:function(e){t.selectRandarId=a.id}}},[e("header",{staticClass:"randar-head"},[e("div"),e("a-checkbox",{attrs:{checked:t.selectRandarId===a.id}})],1),e("section",{staticClass:"randar-main"},[e("div",{staticClass:"randar-main-content"},[e("p",[t._v(t._s(a.activityName))]),e("p",{staticClass:"aks-tips"},[t._v(t._s(a.activityExplain))])]),e("a-avatar",{attrs:{size:40,src:a.cover,shape:"square"}})],1)])})),0):e("a-empty"),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e(),!t.loading&&t.pageList.length>0?e("div",{staticClass:"loading-container"},[t._v("没有更多数据了")]):t._e()],1)])},v=[],b=a("2909"),y=(a("7db0"),a("487a")),k=a.n(y),x=a("8bac"),_={name:"AddluckyDraw",directives:{infiniteScroll:k.a},components:{CommonModal:o["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""}},data:function(){return{sourceModal:{title:"抽奖活动"},pagination:{current:1,pageSize:10,total:0},form:{typeText:"抽奖活动",type:"link",linkTitle:"",desc:"",key:"visibileLuckDraw",coverUrl:{compress:""}},type:"",typeImg:{1:"/imgs/default-cover.png",2:"/icons/pdf.png",3:"/imgs/default-cover.png",4:"/imgs/default-cover.png"},radarName:"",loading:!1,busy:!1,pageList:[],selectRandarId:""}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{serviceOk:function(){var t=this;if(this.selectRandarId){var e=this.pageList.find((function(e){return e.id===t.selectRandarId}));e.typeText="抽奖活动",e.linkTitle=e.activityName,e.desc=e.activityExplain,e.type="link",e.key="visibileLuckDraw",e.linktype="luck_link",e.coverUrl={compress:e.cover},this.$emit("serviceOk",e)}else this.$message.warning("请选择一个自定义表单")},init:function(){var t=this,e={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,source:this.source,name:"",status:1};this.loading=!0,Object(x["f"])(e).then((function(e){var a;e.data.list.length>0&&((a=t.pageList).push.apply(a,Object(b["a"])(e.data.list)),t.pageList.forEach((function(t){t.cover="https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/h5/img/luckyBg.png"})));if(t.pagination.current++,e.data.list.length<t.pagination.pageSize)return t.busy=!0,void(t.loading=!1);t.pagination.total=e.data.total})).catch((function(e){t.$message.error(e||e.message)}))},selectTab:function(t){this.type=t,this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},search:function(){this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},handleInfiniteOnLoad:function(){!this.busy&&this.init()}}},C=_,L=(a("3de3"),Object(d["a"])(C,g,v,!1,null,"ec688aec",null)),O=L.exports,T={name:"Accessory",components:{AddImg:m,AddLink:p["a"],AddForm:h["a"],AddluckyDraw:O},props:{source:{type:String,default:""},maxLength:{type:Number,default:9},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0},attachmentsWrap:{type:Array,default:function(){return[]}},menuList:{type:Array,default:function(){return[{text:"图片",id:1,key:"visibileAddImg"},{text:"链接",id:2,key:"visibileAddLink"},{text:"自定义表单",id:4,key:"visibileForm"},{text:"抽奖活动",id:5,key:"visibileLuckDraw"}]}}},data:function(){return{visibileAddImg:!1,visibileAddLink:!1,visibileForm:!1,visibileLuckDraw:!1,key:"",editData:{},editIndex:void 0,attachments:[]}},watch:{attachmentsWrap:{handler:function(){this.attachments=this.attachmentsWrap},deep:!0,immediate:!0}},methods:{openAccessory:function(t){this.attachments.length>=this.maxLength?this.$message.warning("最多上传".concat(this.maxLength,"个附件")):(this.editData={},this.editIndex=void 0,this.key=t,this[this.key]=!0)},serviceOk:function(t){void 0===this.editIndex?this.attachments.length>=this.maxLength?this.$message.warning("最多上传".concat(this.maxLength,"个附件")):this.attachments.push(t):this.$set(this.attachments,this.editIndex,t),this[this.key]=!1,this.$emit("serviceOk",this.attachments)},deleteAttachments:function(t){this.attachments.splice(t,1)},editAttachments:function(t,e){this.editData=t,this.editIndex=e,this.key=t.key,this[this.key]=!0}}},w=T,I=(a("8897"),Object(d["a"])(w,i,n,!1,null,"6cd29031",null));e["a"]=I.exports},"82bc":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{on:{click:function(e){return t.hidebox()}}},[e("a-page-header",{staticClass:"page-header background-white",attrs:{title:"".concat(t.isAddText,"群发")},on:{back:function(e){return t.$router.go(-1)}}}),e("section",{staticClass:"section background-white page-box"},[e("a-form",{attrs:{"label-col":{span:2},"wrapper-col":{span:12},form:t.form},on:{submit:t.handleSubmit}},[e("p",{staticClass:"base-info"},[t._v("基础信息")]),e("a-form-item",{attrs:{label:"选择群发账号",required:""}},[e("div",{staticClass:"content"},[e("usePerson",{attrs:{type:"deptId",placeHolder:"请选择群发账号"},on:{usePersionInfo:t.usePersionInfo},model:{value:t.userIds,callback:function(e){t.userIds=e},expression:"userIds"}})],1)]),e("a-form-item",{attrs:{label:"选择客户",required:""}},[e("div",{staticClass:"content"},[e("div",[e("a-radio-group",{attrs:{name:"radioGroup"},on:{change:t.radioGroupChange},model:{value:t.screeningCustomer,callback:function(e){t.screeningCustomer=e},expression:"screeningCustomer"}},[e("a-radio",{attrs:{value:0}},[t._v("全部客户")]),e("a-radio",{attrs:{value:1}},[t._v("筛选客户")])],1)],1),"0"==t.screeningCustomer?e("div",{staticClass:"all-num"},[t._v(" 将群发消息给全部账号的 "),t.allNum?e("a-button",{attrs:{type:"link"}},[t._v(t._s(t.allNum))]):e("a-button",{staticClass:"look-member-num",attrs:{type:"link"},on:{click:function(e){return t.getCalculateNum("allNum")}}},[t._v(" 查看 ")]),t._v(" 个客户 ")],1):t._e(),"1"==t.screeningCustomer?e("div",{staticClass:"select-content"},[e("p",{staticClass:"bar"},[t._v("筛选客户")]),e("div",{staticClass:"client-info"},[e("div",{staticClass:"info-title"},[t._v("性别:")]),e("div",{staticClass:"tabs"},[e("a-radio-group",{attrs:{name:"radioGroup"},on:{change:function(e){t.seeShow=!0}},model:{value:t.criteriaGender,callback:function(e){t.criteriaGender=e},expression:"criteriaGender"}},[e("a-radio",{attrs:{value:0}},[t._v("全部性别")]),e("a-radio",{attrs:{value:1}},[t._v("仅男性粉丝")]),e("a-radio",{attrs:{value:2}},[t._v("仅女性粉丝")]),e("a-radio",{attrs:{value:3}},[t._v("未知性别")])],1)],1)]),e("div",{staticClass:"client-info"},[e("div",{staticClass:"info-title"},[t._v("所在群聊:")]),e("div",{staticClass:"tabs"},[e("UsePerson",{staticStyle:{width:"340px"},attrs:{title:"群聊",type:"custGrpList",placeHolder:"请选择群聊"},on:{usePersionInfo:t.useInfo},model:{value:t.inGroups,callback:function(e){t.inGroups=e},expression:"inGroups"}})],1)]),e("div",{staticClass:"client-info"},[e("div",{staticClass:"info-title"},[t._v("添加时间:")]),e("div",{staticClass:"tabs"},[e("a-range-picker",{staticStyle:{width:"340px"},attrs:{allowClear:"",value:t.showLossDateTime,"disabled-date":t.disabledDate},on:{change:t.changeDate}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1)],1)]),e("div",{staticClass:"client-info"},[e("div",{staticClass:"info-title"},[t._v("标签:")]),e("div",{on:{click:function(e){return t.activelable()}}},[e("a-select",{ref:"labelname",staticStyle:{width:"400px"},attrs:{allowClear:"",mode:"multiple",placeholder:"请选择标签"},on:{change:t.labelkefuchange},model:{value:t.labelkefuList,callback:function(e){t.labelkefuList=e},expression:"labelkefuList"}},[e("div",{attrs:{slot:"dropdownRender"},slot:"dropdownRender"})])],1)]),e("div",{staticClass:"client-info",staticStyle:{"margin-bottom":"0"}},[e("div",{staticClass:"info-title"},[t._v("排除客户:")]),e("div",{on:{click:function(e){return t.cusactivelable()}}},[e("a-select",{ref:"labelname",staticStyle:{width:"400px"},attrs:{allowClear:"",mode:"multiple",placeholder:"请选择标签"},on:{change:t.cuslabelkefuchange},model:{value:t.cuslabelkefuList,callback:function(e){t.cuslabelkefuList=e},expression:"cuslabelkefuList"}},[e("div",{attrs:{slot:"dropdownRender"},slot:"dropdownRender"})])],1)]),e("p",{staticClass:"text-gray"},[t._v(" 可根据标签选择客户，群发时将不会发送给该标签内的客户。若选择了排除的客户，需要较长时间创建本条群发消息哦～ ")]),e("div",{staticClass:"divider line",staticStyle:{"padding-left":"24px","padding-right":"24px",width:"px"}},[e("span",{staticClass:"ant-divider ant-divider-horizontal"})]),"0"!=t.criteriaGender?e("div",{staticClass:"client-info client-info-tips"},[e("div",{staticClass:"divider",staticStyle:{"padding-top":"0px","padding-bottom":"0px",height:"px"}},[e("span",{staticClass:"ant-divider ant-divider-vertical"})]),t._v(" 将发送消息给属于 "),t.spanName.length>0?e("span",[t._l(t.spanName,(function(a,i){return e("span",{key:i},[t._v(" ["+t._s(a.tagName)+"] ， ")])})),t._v(" "+t._s(t.spanName.length)+"个标签的符合 ")],2):t._e(),t._v(" 条件的粉丝 ")]):t._e()]):t._e(),"1"==t.screeningCustomer?e("p",{staticClass:"content-select-all"},[e("span",{staticClass:"icon-wrap",staticStyle:{color:"#666666"}},[e("a-icon",{staticClass:"file-search",attrs:{type:"file-search"}}),t._v("查看该消息预计送达人数： "),t.seeShow?e("span",{staticClass:"btn",on:{click:t.getCalculateNum}},[t._v("查看")]):e("span",[t._v(t._s(t.CalculateNum))])],1)]):t._e(),t.seeShow&&t.loadingSee?e("em",{staticClass:"em-txt"},[t._v("人数计算中，请耐心等待。（此过程可能需要数分钟）")]):t._e(),"2"==t.screeningCustomer?e("div",{staticClass:"content"},[e("p",{staticClass:"content-select-all"},[t._v(" 将群发消息给全部账号的 "),e("span",[t._v(t._s(t.num.length))]),t._v("个客户 ")])]):t._e()])]),e("p",{staticClass:"base-info"},[t._v("编辑群发消息")]),e("a-form-item",{attrs:{label:"群发内容","wrapper-col":{span:16}}},[e("div",{staticClass:"flex-box"},[e("div",[e("div",{staticClass:"textarea-wrap"},[e("a-textarea",{attrs:{placeholder:"请输入群发内容","allow-clear":"",autoSize:{minRows:7,maxRows:7}},model:{value:t.messageOne,callback:function(e){t.messageOne=e},expression:"messageOne"}}),e("div",{staticClass:"statistics font-color-black-25"},[t._v(t._s(t.messageOne.length)+"/"+t._s(t.maxLength))])],1),e("Accessory",{attrs:{source:"customer_send"},on:{serviceOk:t.addAccessory}}),e("div",{staticClass:"tips"},[e("span",[t._v("注意:")]),t._v(" 客户每个月最多接收来自同一企业的管理员的 4 条群发消息，4条消息可在同一天发送 ")])],1),e("PhoneModel",{attrs:{textList:t.textList}})],1)]),e("a-form-item",{attrs:{label:"群发时间"}},[e("a-radio-group",{attrs:{name:"radioGroup"},on:{change:t.changeSendTime},model:{value:t.sendTime,callback:function(e){t.sendTime=e},expression:"sendTime"}},t._l(t.sendTimeEnum,(function(a){return e("a-radio",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.value)+" ")])})),1),e("div",[t.sendTime===t.sendTimeEnum[1].id?e("a-space",{staticClass:"select-time"},[e("a-date-picker",{attrs:{allowClear:"",disabledDate:t.disabledDatenow},on:{change:t.changeDate2},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),e("a-time-picker",{attrs:{format:"HH:mm",allowClear:""},on:{change:t.changeDate3},model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1):t._e()],1)],1),e("a-form-item",{attrs:{"wrapper-col":{span:12,offset:2}}},[e("a-button",{attrs:{type:"primary","html-type":"submit"}},[t._v(" 通知成员发送 ")])],1)],1),e("a-modal",{staticClass:"noBottomBorder",attrs:{allowClear:"",centered:!0,width:600,okText:"保存"},on:{ok:t.labelOk,cancel:t.labelCancel},model:{value:t.labelShow,callback:function(e){t.labelShow=e},expression:"labelShow"}},[e("div",{staticClass:"box"},[e("h2",{staticClass:"dialog-title"},[t._v("选择标签")]),e("div",{staticClass:"flex"},[e("span",{class:[{active:t.defalutLabelActive},"tab"],on:{click:function(e){return t.tabLabel(0)}}},[t._v("以下标签满足其中之一")]),e("span",{class:[{active:!t.defalutLabelActive},"tab"],on:{click:function(e){return t.tabLabel(1)}}},[t._v("以下标签同时满足")])]),e("a-input-search",{staticClass:"search-box",attrs:{placeholder:t.tagplaceholder},on:{search:t.onSearchLabel,pressEnter:t.onSearchLabel},model:{value:t.searchLabel,callback:function(e){t.searchLabel=e},expression:"searchLabel"}}),t._l(t.groupList,(function(a,i){return e("div",{key:i,staticClass:"tag-group"},[e("p",{staticClass:"tag-group-name"},[t._v(t._s(a.groupName||a.grpTagName)+"：")]),e("div",{staticClass:"group-wrap"},t._l(a.tags,(function(a,i){return e("li",{key:i,staticClass:"tag",class:[{active:t.spanIndex.indexOf(a.tagId)>-1},"tab"],on:{click:function(e){return t.changeSpan(a.tagId,a.tagName)}}},[t._v(" "+t._s(a.tagName)+" ")])})),0)])}))],2)]),e("a-modal",{staticClass:"noBottomBorder",attrs:{allowClear:"",centered:!0,width:600,okText:"保存"},on:{ok:t.cuslabelOk,cancel:t.cuslabelCancel},model:{value:t.cuslabelShow,callback:function(e){t.cuslabelShow=e},expression:"cuslabelShow"}},[e("div",{staticClass:"box"},[e("h2",{staticClass:"dialog-title"},[t._v("选择标签")]),e("a-input-search",{staticClass:"search-box",attrs:{placeholder:t.tagplaceholder},on:{search:t.onSearchLabel2,pressEnter:t.onSearchLabel2},model:{value:t.searchLabel2,callback:function(e){t.searchLabel2=e},expression:"searchLabel2"}}),t._l(t.groupList2,(function(a,i){return e("div",{key:i,staticClass:"tag-group"},[e("p",{staticClass:"tag-group-name"},[t._v(t._s(a.groupName||a.grpTagName)+"：")]),e("div",{staticClass:"group-wrap"},t._l(a.tags,(function(a,i){return e("li",{key:i,staticClass:"tag",class:[{active:t.spanIndex2.indexOf(a.tagId)>-1},"tab"],on:{click:function(e){return t.changeSpan2(a.tagId,a.tagName)}}},[t._v(" "+t._s(a.tagName)+" ")])})),0)])}))],2)]),e("a-modal",{staticClass:"noBottomBorder",attrs:{allowClear:"",centered:!0,width:500,okText:"创建",confirmLoading:t.confirmLoading},on:{ok:t.newlyBuildOk,cancel:t.newlyBuildCancel},model:{value:t.newlyBuild,callback:function(e){t.newlyBuild=e},expression:"newlyBuild"}},[e("div",{staticClass:"box"},[e("h2",{staticClass:"dialog-title"},[t._v("新建群发")]),e("div",{staticClass:"dialog-text"},[t._v(" 确定为全部员工创建群发任务? "),e("br"),t._v(" 提示：若客户添加过多个员工，"+t._s(t.ENTERPRICE_NAME)+"将自动去重，客户只会收到一次推送 ")])])])],1)],1)},n=[],s=a("c7eb"),r=a("1da1"),o=(a("d3b7"),a("d81d"),a("a434"),a("a9e3"),a("6bd9")),c=a("b7fd"),l=a("3dd3"),u=a("8e87"),d=a("b9cd"),f=a("1c9c"),m=a("7183"),p=a("1bee"),h=a("e6b1"),g=a("161b"),v=a("2bf4"),b=a("7a44"),y=[{title:"全部账号",icon:"usergroup-add",default:!0}],k={name:"NewGroup",components:{Contenteditable:u["a"],usePerson:o["a"],StaffList:c["a"],UsePerson:o["a"],PhoneModel:h["a"],Accessory:b["a"]},data:function(){return{newlyBuild:!1,cuslabelShow:!1,confirmLoading:!1,serviceList:[],allNum:"",labelShow:!1,defalutLabelActive:!0,groupList:[],groupList2:[],tagplaceholder:"请输入企业标签",spanIndex:[],spanIndex2:[],searchLabel:"",searchLabel2:"",filterType:2,activelableVal:"0",labelkefuList:[],cuslabelkefuList:[],DataGroupList:[],spanName:[],spanName2:[],seeShow:!0,loadingSee:!1,CalculateNum:0,showAll:!1,showLossDateTime:null,criteriaGender:0,screeningCustomer:0,form:this.$form.createForm(this,{name:"coordinated"}),userIds:[{key:"999999",title:"全部账号",source:{deptWxIds:null,userIds:null,thumbAvatar:""}}],maxLength:600,usePersionList:y,messageOne:"",sendTime:d["p"][0].id,sendTimeEnum:d["p"],date:"",time:"",num:[],noChose:!1,isOpen:!1,sendType:1,attachments:[],inGroups:[]}},mixins:[v["a"]],watch:{criteriaGender:function(){this.seeShow=!0}},methods:{handleSubmit:function(t){var e=this;t.preventDefault(),this.validateFields().then((function(){e.newlyBuild=!0})).catch((function(t){e.$message.warning(t)}))},validateFields:function(){var t=this;return new Promise((function(e,a){"1"!=t.sendType&&(t.dateStringTime&&t.dateString?t.dateString===t.$moment().format("YYYY-MM-DD")&&Object(p["b"])(t.$moment().format("HH:mm"),t.dateStringTime)&&a("发送时间不能早已当前时间"):a("请选择时间")),!t.messageOne&&t.attachments.length<1&&a("消息内容不能为空"),e()}))},newlyBuildOk:function(){var t=this;return Object(r["a"])(Object(s["a"])().mark((function e(){var a;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.confirmLoading=!0,e.next=3,t.uploadMedia();case 3:a=t.getParams(),Object(l["a"])(a).then((function(e){t.$message.success("".concat(t.isAddText,"群发成功")),t.$router.go(-1)})).catch((function(e){t.$message.warning(e)})).finally((function(){t.newlyBuild=!1,t.confirmLoading=!1}));case 5:case"end":return e.stop()}}),e)})))()},newlyBuildCancel:function(){this.newlyBuild=!1},cuslabelOk:function(){this.seeShow=!0,this.cuslabelShow=!1,this.cuslabelkefuList=this.spanName2.map((function(t){return t.tagName})),this.exclueTags=this.spanIndex2},cuslabelkefuchange:function(t){var e=this;if(this.seeShow=!0,t<=0)this.exclueTags=[],this.spanIndex2=[],this.spanName2=[];else{var a=[],i=[];t.map((function(t){e.spanName2.map((function(e){t==e.tagName&&(a.push(e.index),i.push({tagName:e.tagName,index:e.index}))}))})),this.spanIndex2=a,this.spanName2=i,this.exclueTags=a}},cuslabelCancel:function(){this.cuslabelShow=!1},hidebox:function(){this.isOpen=!1},serviceChange:function(t){this.isOpen=!1,t.length<=0&&(this.inGroups=void 0)},closeopengroup:function(t){this.inGroups.push(t.chatId),this.serviceList.push(t.groupName)},getCalculateNum:function(t){var e=this,a=this.getParams();delete a.sendTime,delete a.sendType,delete a.messageContent,this.seeShow=!0,this.loadingSee=!0,Object(l["c"])(a).then((function(a){"allNum"===t?e.allNum=(null===a||void 0===a?void 0:a.data)||0:(e.seeShow=!1,e.CalculateNum=(null===a||void 0===a?void 0:a.data)||0)})).catch((function(t){e.$message.error(t)})).finally((function(){e.loadingSee=!1}))},tabLabel:function(t){this.isNumOpen=!1,this.isOpen=!1,this.isOpengroup=!1,"0"==t?(this.defalutLabelActive=!0,this.filterType=2):(this.defalutLabelActive=!1,this.filterType=1)},onSearchLabel:function(){var t=this,e={tagName:this.searchLabel||""};"0"==this.activelableVal?Object(m["c"])(e).then((function(e){t.groupList=e.data.tagGroup||[]})):Object(g["c"])({grpName:this.searchLabel}).then((function(e){t.groupList=e.data||[]}))},onSearchLabel2:function(){var t=this,e={tagName:this.searchLabel2||""};"0"==this.activelableVal?Object(m["c"])(e).then((function(e){t.groupList2=e.data.tagGroup||[]})):Object(g["c"])({grpName:this.searchLabel2}).then((function(e){t.groupList2=e.data||[]}))},changeSpan:function(t,e){var a=this.spanIndex.indexOf(t),i=this.spanName.indexOf(e);if(a>-1)this.spanIndex.splice(a,1),this.spanName.splice(i,1);else{this.spanIndex.push(t);var n={tagName:e,index:t};this.spanName.push(n)}},changeSpan2:function(t,e){var a=this.spanIndex2.indexOf(t),i=this.spanName2.indexOf(e);if(a>-1)this.spanIndex2.splice(a,1),this.spanName2.splice(i,1);else{this.spanIndex2.push(t);var n={tagName:e,index:t};this.spanName2.push(n)}},labelOk:function(){this.seeShow=!0,this.labelShow=!1,this.labelkefuList=this.spanName.map((function(t){return t.tagName})),this.includeTags=this.spanIndex,this.defalutLabelActive?this.filterType=2:this.filterType=1},labelkefuchange:function(t){var e=this;if(this.seeShow=!0,t<=0)this.includeTags=[],this.filterType=0,this.spanIndex=[],this.spanName=[];else{var a=[],i=[];t.map((function(t){e.spanName.map((function(e){t==e.tagName&&(a.push(e.index),i.push({tagName:e.tagName,index:e.index}))}))})),this.spanName=i,this.spanIndex=a,this.includeTags=a}},labelCancel:function(){this.labelShow=!1},activelable:function(t){var e=this;this.activelableVal=t,this.tagplaceholder="请输入企业标签";var a={tagName:this.searchLabel||""};Object(m["c"])(a).then((function(t){e.groupList=t.data.tagGroup||[]})),this.isOpen=!1,this.labelShow=!0},cusactivelable:function(t){var e=this;this.activelableVal=t,this.tagplaceholder="请输入企业标签";var a={tagName:this.searchLabel2||""};Object(m["c"])(a).then((function(t){e.groupList2=t.data.tagGroup||[]})),this.isOpen=!1,this.cuslabelShow=!0},changeDate:function(t,e){this.showLossDateTime=t,this.seeShow=!0,e[0]?(this.addTimeFrom=e[0],this.addTimeTo=e[1]):(this.addTimeFrom=void 0,this.addTimeTo=void 0)},changeDate2:function(t,e){this.dateString=e},changeDate3:function(t,e){this.dateStringTime=e},radioGroupChange:function(){var t=this;"0"==this.screeningCustomer&&this.num.length<=0&&Object(f["q"])({name:""}).then((function(e){t.num=e.data}))},usePersionInfo:function(t){if(this.allNum=!1,this.seeShow=!0,t.length<=0)return this.noChose=!1,void(this.userIds=[{key:"999999",title:"全部账号",source:{deptWxIds:null,userIds:null,thumbAvatar:""}}]);this.noChose=!0,this.userIds=t},useInfo:function(t){this.seeShow=!0,this.inGroups=t},changeSendTime:function(t){var e=t.target.value;this.sendType="timing"==e?2:1},disabledDate:function(t){return t&&t>Date.now()},disabledDatenow:function(t){return t&&t<this.$moment().subtract(1,"days")},disabledHours:function(){for(var t=this.$moment().toObject().hours,e=[],a=0;a<t;a++)e.push(a);return e},disabledMinutes:function(){for(var t=this.$moment().toObject().minutes,e=[],a=0;a<t;a++)e.push(a);return e},getParams:function(){var t;if(this.noChose){var e=this.userIds.map((function(t){return t.source.userid}));this.staffFilter={userIds:e},t=1}else t=0,this.staffFilter={deptWxIds:null,userIds:null};var a=this.screeningCustomer,i={text:{content:this.messageOne},attachments:this.getAttachments()};this.messageOne||delete i.text;var n={staffChooseType:t,staffFilter:this.staffFilter,customerChooseType:a,sendType:this.sendType,messageContent:i};"1"==this.sendType?n.sendTime=null:n.sendTime=this.dateString+" "+this.dateStringTime+":00";var s,r=this.inGroups.map((function(t){return t.source.chatId}));"1"==a&&(n.customerFilter={gender:this.criteriaGender,inGroups:r,addTimeStart:this.addTimeFrom?this.addTimeFrom+" 00:00:00":"",addTimeEnd:this.addTimeTo?this.addTimeTo+" 23:59:59":"",filterType:(null===(s=this.includeTags)||void 0===s?void 0:s.length)>0?this.filterType:null,includeTags:this.includeTags?this.includeTags.map((function(t){return Number(t)})):[],exclueTags:this.exclueTags?this.exclueTags.map((function(t){return Number(t)})):[]});return n},serviceOk:function(t){t.length<1?this.usePersionList=y:this.usePersionList=t,this.visibleUsePerson=!1},insertNickname:function(){var t=document.createElement("span");t.className="nick-name",t.innerHTML="用户昵称",this.$refs.contenteditable.insertHtmlAtCaret(t)}}},x=k,_=(a("666f"),a("2877")),C=Object(_["a"])(x,i,n,!1,null,"6d150d84",null);e["default"]=C.exports},8897:function(t,e,a){"use strict";a("e53d")},"8bac":function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"g",(function(){return o})),a.d(e,"h",(function(){return c})),a.d(e,"j",(function(){return l})),a.d(e,"e",(function(){return u})),a.d(e,"f",(function(){return d})),a.d(e,"a",(function(){return f})),a.d(e,"d",(function(){return m})),a.d(e,"i",(function(){return p}));var i=a("b775"),n={getList:"/marketing/luckyActivity/list",addSave:"/marketing/luckyActivity/save",updateList:"/marketing/luckyActivity/update",deleteList:"/marketing/luckyActivity/delete",getInfo:"/marketing/luckyActivity/info",uploadFile:"/marketing/luckActivityPrize/uploadFile",prizeInfo:"/marketing/luckActivityPrize/prizeInfo",numberOfPeopleInfo:"/marketing/luckyActivity/numberOfPeopleInfo",customerInfo:"/marketing/luckyActivity/customerInfo",cancelAfterVerification:"/marketing/luckyActivity/cancelAfterVerification"};function s(t){return Object(i["b"])({url:n.cancelAfterVerification,method:"post",data:t})}function r(t){return Object(i["b"])({url:n.customerInfo,method:"get",params:t})}function o(t){return Object(i["b"])({url:n.numberOfPeopleInfo,method:"get",params:t})}function c(t){return Object(i["b"])({url:n.prizeInfo,method:"get",params:t})}function l(t){return Object(i["b"])({url:n.uploadFile,method:"post",data:t})}function u(t){return Object(i["b"])({url:n.getInfo,method:"get",params:t})}function d(t){return Object(i["b"])({url:n.getList,method:"get",params:t})}function f(t){return Object(i["b"])({url:n.addSave,method:"post",data:t})}function m(t){return Object(i["b"])({url:n.deleteList,method:"post",data:t})}function p(t){return Object(i["b"])({url:n.updateList,method:"post",data:t})}},"8e34":function(t,e,a){"use strict";a("299d")},"8e87":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"textarea",class:t.classNmae,attrs:{contenteditable:"true",maxLength:"maxLength","data-form-type":"reason","data-placeholder":"请输入回复框的内容"},domProps:{innerHTML:t._s(t.innerText)},on:{blur:t.textareaBlur,input:t.changeText}})},n=[],s=(a("a9e3"),a("ac1f"),a("466d"),a("5319"),{name:"Contenteditable",props:{classNmae:{type:String,default:"link-textarea"},value:{type:String,default:""},maxLength:{type:[String,Number],default:""}},computed:{state:function(){return this.$route.query.state}},data:function(){return{innerText:"",isLocked:!0,sel:null,range:null,textareaElement:"",num:0}},watch:{value:{handler:function(){"add"!==this.state&&this.isLocked&&this.value&&(this.innerText=this.value,this.isLocked=!1)},immediate:!0},classNmae:{handler:function(){this.textareaElement=document.querySelector(this.classNmae),this.textareaElement&&(this.textareaElement.focus(),this.textareaElement.blur())},immediate:!0}},methods:{keepLastIndex:function(t){t&&this.$nextTick((function(){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){e=document.selection.createRange();e.moveToElementText(t),e.collapse(!1),e.select()}}))},textareaBlur:function(){this.sel=window.getSelection(),this.range=this.sel.getRangeAt(0),this.range.deleteContents()},changeText:function(t){var e=this;this.controlMaxlength(t.target.innerHTML,t),this.$nextTick((function(){e.$emit("input",e.checkInnerHtml(e.$el.innerHTML))}))},controlMaxlength:function(t,e){(null===t||void 0===t?void 0:t.length)>this.maxLength&&(this.innerText=t.substring(0,this.maxLength-this.num),this.num++,this.num>6&&(this.num=0)),this.keepLastIndex(this.textareaElement)},checkInnerHtml:function(t){var e=/<span[^>]*>([\s\S]*?)<\/span>/i,a=t.match(e),i=t;return a&&"客户昵称"!==a[1]&&(i=t.replace(/<span class="nick-name">/g,"").replace(/<\/span>/g,""),this.innerText=i,this.keepLastIndex(this.textareaElement)),i},insertHtmlAtCaret:function(t){if(window.getSelection){if(this.sel.getRangeAt&&this.sel.rangeCount){var e=document.createDocumentFragment(),a=e.appendChild(t),i=document.createElement("div");i.innerHTML="&#8203",a=e.appendChild(i.firstChild),this.range.insertNode(e),a&&(this.range=this.range.cloneRange(),this.range.setStartAfter(a),this.range.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(this.range),this.$emit("input",this.$el.innerHTML))}}else document.selection&&"Control"!=document.selection.type&&(document.selection.createRange().pasteHTML(html),this.$emit("input",this.$el.innerHTML))}}}),r=s,o=(a("d3ba"),a("2877")),c=Object(o["a"])(r,i,n,!1,null,"6c1514fc",null);e["a"]=c.exports},"8f19":function(t,e,a){"use strict";a.d(e,"n",(function(){return s})),a.d(e,"q",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"j",(function(){return c})),a.d(e,"h",(function(){return l})),a.d(e,"f",(function(){return u})),a.d(e,"l",(function(){return d})),a.d(e,"d",(function(){return f})),a.d(e,"e",(function(){return m})),a.d(e,"i",(function(){return p})),a.d(e,"g",(function(){return h})),a.d(e,"b",(function(){return g})),a.d(e,"k",(function(){return v})),a.d(e,"m",(function(){return b})),a.d(e,"c",(function(){return y})),a.d(e,"p",(function(){return k})),a.d(e,"o",(function(){return x}));var i=a("b775"),n={customerFormSave:"/client_transformation/customerForm/save",dateInfoList:"/client_transformation/customerFormData/dateInfoList",customerFormList:"/client_transformation/customerForm/list",customerFormInfo:"/client_transformation/customerForm/info",customerFormUpdate:"/client_transformation/customerForm/update",customerFormPublish:"/client_transformation/customerForm/publish",customerFormDelete:"/client_transformation/customerForm/delete",dataInfo:"/client_transformation/customerFormData/dataInfo",analysis:"/client_transformation/customerFormData/analysis",staffList:"/client_transformation/customerFormData/staffList",infoList:"/client_transformation/customerFormData/infoList",analysisExport:"/client_transformation/customerFormData/analysisExport",dataInfoExport:"/client_transformation/customerFormData/dataInfoExport",infoCityList:"/client_transformation/customerFormData/infoCityList",batchTags:"/client_transformation/customerFormData/batchTags",selectList:"/client_transformation/customerForm/userData/selectList",queryDataList:"/client_transformation/customerFormData/queryDataList"};function s(t){return Object(i["b"])({url:n.infoList,method:"post",data:t})}function r(t){return Object(i["b"])({url:n.staffList,method:"get",params:t})}function o(t){return Object(i["b"])({url:n.analysis,method:"get",params:t})}function c(t){return Object(i["b"])({url:n.dataInfo,method:"get",params:t})}function l(t){return Object(i["b"])({url:n.customerFormSave,method:"post",data:t})}function u(t){return Object(i["b"])({url:n.customerFormList,method:"get",params:t})}function d(t){return Object(i["b"])({url:n.dateInfoList,method:"get",params:t})}function f(t){return Object(i["b"])({url:n.customerFormDelete,method:"post",data:t})}function m(t){return Object(i["b"])({url:n.customerFormInfo,method:"get",params:t})}function p(t){return Object(i["b"])({url:n.customerFormUpdate,method:"post",data:t})}function h(t){return Object(i["b"])({url:n.customerFormPublish,method:"post",data:t})}function g(t){return Object(i["b"])({url:n.analysisExport,method:"get",params:t,responseType:"blob"})}function v(t){return Object(i["b"])({url:n.dataInfoExport,method:"get",params:t,responseType:"blob"})}function b(t){return Object(i["b"])({url:n.infoCityList,method:"get",params:t})}function y(t){return Object(i["b"])({url:n.batchTags,method:"post",data:t})}function k(t){return Object(i["b"])({url:n.selectList,method:"get",params:t})}function x(t){return Object(i["b"])({url:n.queryDataList,method:"post",data:t})}},"95d0":function(t,e,a){},9694:function(t,e,a){},a2ba:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({attrs:{loading:t.loading},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("AddLinkWrap",{ref:"AddLinkWrap",staticClass:"add-link-wrap",attrs:{editData:t.editData,isNeedTag:t.isNeedTag,source:t.source,isNeedRader:t.isNeedRader,isNeedSelectRadar:t.isNeedSelectRadar}})],1)},n=[],s=a("7807"),r=a("2a86"),o={name:"AddLink",components:{AddLinkWrap:s["a"],CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""},loading:{type:Boolean,default:!1},isNeedTag:{type:Boolean,default:!1},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0}},watch:{editData:{handler:function(){this.sourceModal.title=this.editData.id?"修改链接":"添加链接"},immediate:!0}},data:function(){return{sourceModal:{}}},methods:{serviceOk:function(){var t=this;this.$refs.AddLinkWrap.getFormValue()&&this.$refs.AddLinkWrap.$refs.ruleForm.validate((function(e){if(!e)return!1;t.$emit("serviceOk",t.$refs.AddLinkWrap.form)}))}}},c=o,l=(a("d6b1"),a("2877")),u=Object(l["a"])(c,i,n,!1,null,"2002f84d",null);e["a"]=u.exports},aa6e:function(t,e,a){},afd2:function(t,e,a){},b4f0:function(t,e,a){},b52b:function(t,e,a){"use strict";a.d(e,"j",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"i",(function(){return c})),a.d(e,"g",(function(){return l})),a.d(e,"e",(function(){return u})),a.d(e,"h",(function(){return d})),a.d(e,"b",(function(){return f})),a.d(e,"d",(function(){return m})),a.d(e,"f",(function(){return p}));var i=a("b775"),n={labelGroupList:"/client_group/tagBuildGroup/page",labelGroupAdd:"/client_group/tagBuildGroup/add",labelGroupDel:"/client_group/tagBuildGroup/delGroupTagPull",getChat:"/client_group/tagBuildGroup/getChat",getStatistics:"/client_group/tagBuildGroup/getStatistics",queryCustomers:"/client_group/tagBuildGroup/customer/get",customersDetail:"/client_group/tagBuildGroup/staff/get",remind:"/client_group/tagBuildGroup/remind",calculateNum:"/client_group/tagBuildGroup/calculateNum",updateDate:"/client_group/tagBuildGroup/getNewData"};function s(t){return Object(i["b"])({url:n.updateDate,method:"get",params:t})}function r(t){return Object(i["b"])({url:n.getChat,method:"get",params:t})}function o(t){return Object(i["b"])({url:n.calculateNum,method:"post",data:t})}function c(t){return Object(i["b"])({url:n.remind,method:"post",data:t})}function l(t){return Object(i["b"])({url:n.labelGroupList,method:"get",params:t})}function u(t){return Object(i["b"])({url:n.labelGroupAdd,method:"post",data:t})}function d(t){return Object(i["b"])({url:n.queryCustomers,method:"post",data:t})}function f(t){return Object(i["b"])({url:n.customersDetail,method:"post",data:t})}function m(t){return Object(i["b"])({url:n.getStatistics,method:"get",params:t})}function p(t){return Object(i["b"])({url:n.labelGroupDel,method:"post",params:t})}},b5c3:function(t,e,a){t.exports=a.p+"assets/default.c42b7ede.svg"},b7fd:function(t,e,a){"use strict";a("b0c0");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"groupbox"},[e("div",{staticClass:"title"},[t._v(" 全部"+t._s(t.title)+" ("+t._s(t.total)+") ")]),e("div",{staticClass:"search-box"},[e("a-input-search",{attrs:{allowClear:"",placeholder:"请输入".concat(t.title,"名称")},on:{search:t.onSearchGroupleader,pressEnter:t.onSearchGroupleader,blur:t.blursearch,focus:t.searchClick},model:{value:t.searchGroupleader,callback:function(e){t.searchGroupleader=e},expression:"searchGroupleader"}})],1),e("div",{staticClass:"list-wrap"},[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.allemployees,expression:"allemployees"}],staticClass:"demo-infinite-container",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.staffdata.length>0?e("a-list",{attrs:{"data-source":t.staffdata},scopedSlots:t._u([{key:"renderItem",fn:function(a,i){return e("div",{key:i,staticClass:"list-item",on:{click:function(e){return t.choiceGroup(a)}}},[e("div",{staticClass:"item-content"},[e("img",{staticClass:"avatar",attrs:{src:a.thumbAvatar||t.defaultThumbAvatar,alt:""}}),e("span",{staticClass:"name"},[t._v(t._s(a.name||a.groupName||a.staffName))])]),t.defalytStaffIndex==(a.staffId||a.groupId)?e("a-icon",{staticClass:"img",attrs:{type:"check-circle"}}):e("div",{staticClass:"circle"})],1)}}],null,!1,1114407245)}):e("div",{staticClass:"cter"},[t._v("没有更多相关"+t._s(t.title)+"哦~~")])],1)])])},n=[],s=a("2909"),r=(a("d81d"),a("99af"),a("1c9c")),o=a("b52b"),c=a("487a"),l=a.n(c),u={directives:{infiniteScroll:l.a},props:{type:{type:String,default:"Staff"},title:{type:String,default:"员工"},tagPullId:{type:String,default:""}},data:function(){return{defaultThumbAvatar:a("b5c3"),staffdata:[],defalytStaffIndex:"",loading:!1,busy:!1,total:0,page:1,limit:10,searchGroupleader:""}},created:function(){},methods:{searchClick:function(){this.$emit("isSearchNoHide","1")},blursearch:function(){this.$emit("isSearchNoHide","2")},allemployees:function(){var t=this;switch(this.type){case"Staff":var e={currentPage:this.page,pageSize:this.limit,name:this.searchGroupleader||""};if(this.loading=!0,"0"!=this.total&&this.staffdata.length>=this.total)return void(this.busy=!0);Object(r["q"])(e).then((function(e){e.data.list.map((function(t){t.flag=!1}));var a=e.data.list;t.total=e.data.total,t.staffdata.length>=t.total?t.busy=!0:(t.page>1?t.staffdata=[].concat(Object(s["a"])(t.staffdata),Object(s["a"])(a)):t.staffdata=Object(s["a"])(a),t.page=t.page+1,t.loading=!1)}));break;case"customersDetail":var a={tagPullId:this.tagPullId||""};Object(o["b"])(a).then((function(e){t.total=e.data.total,t.staffdata=e.data.list||[]}));break;case"customer":var i={name:this.searchGroupleader||""};Object(r["n"])(i).then((function(e){t.total=e.data.total,t.staffdata=e.data.list||[]}));break;case"custGrpList":var n={grpName:this.searchGroupleader||"",filterType:0,grpStatus:0,orderCondition:1,orderWay:1,date:"",currentPage:1,pageSize:9999};Object(r["j"])(n).then((function(e){t.total=e.data.total,t.staffdata=e.data.list||[]}));break}},onSearchGroupleader:function(){this.$emit("isSearchNoHide","0"),this.page=1,this.staffdata=[],this.allemployees()},choiceGroup:function(t){this.defalytStaffIndex=t.userid||t.groupId||t.staffId,"Staff"==this.type?(this.$emit("closeopenstaff",t),this.$emit("closeopencustomer",t)):"customer"==this.type?this.$emit("closeopencustomer",t):"custGrpList"==this.type?this.$emit("closeopengroup",t):"customersDetail"==this.type&&this.$emit("closeopencustomer",t)}}},d=u,f=(a("be8d"),a("2877")),m=Object(f["a"])(d,i,n,!1,null,"e031d236",null);e["a"]=m.exports},b9cd:function(t,e,a){"use strict";a.d(e,"l",(function(){return i})),a.d(e,"j",(function(){return n})),a.d(e,"o",(function(){return s})),a.d(e,"n",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"g",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"a",(function(){return u})),a.d(e,"f",(function(){return d})),a.d(e,"k",(function(){return f})),a.d(e,"i",(function(){return m})),a.d(e,"e",(function(){return p})),a.d(e,"p",(function(){return h})),a.d(e,"c",(function(){return g})),a.d(e,"h",(function(){return v})),a.d(e,"q",(function(){return b})),a.d(e,"m",(function(){return y}));var i="LOSS_STATUS",n="GROUP_STATUS",s="ORDER_WAY",r="ORDER_CONDITION",o="ADD_WAY",c="GENDER",l="CUSTOMER_STATUS",u={0:"待分配",1:"待添加",2:"待通过",3:"已添加",4:"导入中"},d={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},f=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:1},{text:"已不是好友",color:"#ffd4b6",id:2},{text:"客户接收达上限",color:"#fbe8ae",id:3},{text:"本月消息已经达到上限",color:"",id:4}],m=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:2},{text:"没有群发任务",color:"",id:4}],p={1:"微信",2:"企业微信"},h=[{id:"immediately",value:"立即发送"},{id:"timing",value:"定时发送"}],g={0:"渠道码",1:"区域扫码",2:"自动拉群",3:"一客一码",4:"加好友",5:"通过群码拉群"},v={0:{text:"拉人中",color:"green"},1:{text:"未开始",color:""},2:{text:"已达上限",color:"orange"},3:{text:"已停用",color:"red"}},b={0:{text:"创建失败",color:"green",id:0},1:{text:"待发送",color:"rgba(34,34,34,.85)",id:1},2:{text:"已发送",color:"rgba(34,34,34,.85)",id:2},3:{text:"已取消",color:"rgba(34,34,34,.85)",id:3},4:{text:"提醒发送",color:"#1890ff",id:4}},y=[{text:"文章",id:"0",format:""},{text:"链接",id:"1"},{text:"海报",id:"2",max:2,format:".bmp,.jpg,.jpeg,.png,.tif,.gif,.pcx,.tga,.exif,.fpx,.svg,.psd,.cdr,.pcd,.dxf,.ufo,.eps,.ai,.raw,.WMF,.webp",tips:"请上传png、jpg格式不超过2M的文件"},{text:"视频",id:"7",max:2e5,format:".MP4",tips:"请上传格式为MP4的视频文件"},{text:"PDF",id:"3",max:20,format:".pdf",icon:"/icons/pdf.png",tips:"请上传PDF格式不超过20M的文件"},{text:"PPT",id:"4",max:20,format:".pptx,.ppt,.pps",icon:"/icons/ppt.svg",tips:"请上传PPT格式不超过20M的文件"},{text:"表格",id:"5",max:20,format:".xlsx,.xls,.csv",icon:"/icons/excel.svg",tips:"请上传csv、xlsx格式不超过20M的文件"},{text:"文档",id:"6",max:20,format:".txt,.doc,.docx",icon:"/icons/word.svg",tips:"请上传doc、txt.docx格式不超过20M的文件"}]},be8d:function(t,e,a){"use strict";a("9694")},d3ba:function(t,e,a){"use strict";a("e7a1")},d6b1:function(t,e,a){"use strict";a("260e")},e53d:function(t,e,a){},e6b1:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"phone-model"},[e("img",{staticClass:"bg",attrs:{src:"/imgs/chatBg.png"}}),e("div",{staticClass:"contant"},[e("p",{staticClass:"time"},[t._v(t._s(t.time))]),t.textList.length>0?e("ul",t._l(t.textList,(function(a,i){return e("li",{key:i,staticClass:"contant-list"},["img"===a.type?[e("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),e("div",{staticClass:"contant-main"},[e("img",{staticClass:"upload-img",attrs:{src:a.pic_url.compress}})])]:t._e(),"link"===a.type?[e("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),e("div",{staticClass:"contant-title"},[e("a-tooltip",{attrs:{title:a.linkTitle}},[e("p",{staticClass:"contant-subtitle"},[t._v(t._s(a.linkTitle))])]),e("div",{staticClass:"contant-contant"},[a.desc?e("a-tooltip",{attrs:{title:a.desc}},[e("span",[t._v(t._s(a.desc))])]):t._e(),e("a-avatar",{attrs:{src:a.coverUrl.compress,size:32,shape:"square"}})],1)],1)]:t._e(),a.type?t._e():[e("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),e("div",{staticClass:"contant-main"},[t._v(t._s(a))])]],2)})),0):t._e()])])},n=[],s={name:"PhoneModel",data:function(){return{time:this.$moment().format("HH:mm")}},props:{textList:{type:[Array],default:function(){return[]}}},watch:{textList:function(){}}},r=s,o=(a("8e34"),a("2877")),c=Object(o["a"])(r,i,n,!1,null,"1aa7a172",null);e["a"]=c.exports},e7a1:function(t,e,a){},f0b2:function(t,e,a){"use strict";a("b4f0")},f564:function(t,e,a){"use strict";a("3fc5")}}]);