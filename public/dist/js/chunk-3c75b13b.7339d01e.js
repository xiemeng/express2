(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c75b13b"],{"0a2c":function(t,e,n){"use strict";n("c0e2")},1011:function(t,e,n){"use strict";n("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",[e("ul",t._l(t.sendContentList,(function(n,a){return e("li",{key:a,staticClass:"send-content"},[t.needTitle?e("span",[t._v("消息"+t._s(a+1)+"：")]):t._e(),e("div",{staticClass:"flex1"},[e("p",{staticClass:"radio"},[e("a-radio-group",{on:{change:function(e){return t.changeType(a)}},model:{value:n.msgType,callback:function(e){t.$set(n,"msgType",e)},expression:"item.msgType"}},t._l(t.msgTypeList,(function(n,a){return e("a-radio",{key:a,attrs:{value:n.id}},[t._v(" "+t._s(n.text)+" ")])})),1),0!==a?e("a-icon",{attrs:{type:"delete"},on:{click:function(e){return t.$emit("delContent",a)}}}):t._e()],1),0===n.msgType?e("div",{staticClass:"textarea-wrap"},[e("a-textarea",{staticClass:"textarea",attrs:{maxLength:n.maxLength,placeholder:"请输入内容",autoSize:{minRows:4,maxRows:4}},model:{value:n.msgContent,callback:function(e){t.$set(n,"msgContent",e)},expression:"item.msgContent"}}),n.maxLength?e("p",{staticClass:"statistics font-color-black-25"},[t._v(" "+t._s(n.msgContent.length)+"/"+t._s(n.maxLength)+" ")]):t._e()],1):t._e(),1===n.msgType?e("div",[e("FormList",{staticClass:"input",attrs:{formInfo:n.imageObj},model:{value:n.msgContent,callback:function(e){t.$set(n,"msgContent",e)},expression:"item.msgContent"}})],1):t._e(),2===n.msgType?e("div",[e("AddLinkWrap",{attrs:{editData:n.msgContent.form,isNeedSelectRadar:t.isNeedSelectRadar,source:t.source,isNeedRader:t.isNeedRader},model:{value:n.msgContent,callback:function(e){t.$set(n,"msgContent",e)},expression:"item.msgContent"}})],1):t._e(),3===n.msgType?e("div",{staticClass:"flex-pdf"},[n.pdfArr[0]?e("AccessoryList",{attrs:{item:n}}):t._e(),e("div",{staticClass:"flex-pdf"},[e("a-upload",{attrs:{"file-list":n.pdfArr,showUploadList:!1,accept:t.acceptPdf,customRequest:t.customRequest},on:{change:t.handleChange}},[n.pdfArr[0]?e("a-button",{attrs:{type:"link"}},[t._v("重新上传")]):e("div",{staticClass:"ant-upload"},[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(" 添加pdf ")])],1)],1),e("span",{staticClass:"font-color-black-25",staticStyle:{"margin-left":"10px"}},[t._v("请在20M以内")])],1)],1):t._e(),4===n.msgType?e("div",{staticClass:"flex-box"},[n.formObj.name?e("AccessoryList",{attrs:{item:n}}):t._e(),e("div",[n.formObj.name?e("a-button",{attrs:{type:"link"},on:{click:function(e){t.visibileForm=!0}}},[t._v("重新选择")]):e("div",{staticClass:"ant-upload",on:{click:function(e){t.visibileForm=!0}}},[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(" 选择素材 ")])],1)],1)],1):t._e(),5===n.msgType?e("div",{staticClass:"flex-pdf"},[n.videoArr[0]?e("AccessoryList",{attrs:{item:n}}):t._e(),e("div",{staticClass:"flex-pdf"},[e("a-upload",{attrs:{showUploadList:!1,accept:t.acceptVideo,customRequest:t.customRequest},on:{change:t.handleChangeVideo,preview:t.handlePreview}},[n.videoArr[0]?e("a-button",{attrs:{type:"link"}},[t._v("重新上传")]):e("div",{staticClass:"ant-upload"},[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(" 上传视频 ")])],1)],1),e("span",{staticClass:"font-color-black-25",staticStyle:{"margin-left":"10px"}},[t._v("请在10M以内")])],1)],1):t._e()])])})),0),e("a-modal",{attrs:{footer:null,destroyOnClose:"",width:"880px",centered:""},model:{value:t.visibileForm,callback:function(e){t.visibileForm=e},expression:"visibileForm"}},[e("AddForm",{attrs:{editData:t.editData,source:t.source},on:{cancle:function(e){t.visibileForm=!1},serviceOk:t.serviceOk}})],1)],1)},i=[],s=n("5530"),r=n("c7eb"),o=n("1da1"),c=(n("7db0"),n("d3b7"),n("fb6a"),n("d81d"),n("26f2")),l=n("7807"),u=n("7581"),d=n("6536"),m={name:"TypeAccessory",components:{FormList:c["a"],AddLinkWrap:l["a"],AddForm:u["a"],AccessoryList:d["a"]},props:{sendContentList:{type:Array,default:function(){return[]}},needTitle:{type:Boolean,default:function(){return!0}},msgTypeList:{type:Array,default:function(){return[]}},source:{type:String,default:""},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0}},data:function(){return{acceptPdf:".pdf",acceptVideo:".MP4",visibileForm:!1,editData:{},formObj:{}}},watch:{sendContentList:function(){}},created:function(){},methods:{changeType:function(t){this.sendContentList[t].msgContent=""},handlePreview:function(t){var e=this;return Object(o["a"])(Object(r["a"])().mark((function n(){var a;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.url||t.preview){n.next=4;break}return n.next=3,e.getBase64(t.originFileObj);case 3:t.preview=n.sent;case 4:a=e.sendContentList.find((function(t){return 5===t.msgType})),a.videoArr[0].pdfFile=t.url||t.preview;case 6:case"end":return n.stop()}}),n)})))()},getBase64:function(t){return new Promise((function(e,n){var a=new FileReader;a.readAsDataURL(t),a.onload=function(){return e(a.result)},a.onerror=function(t){return n(t)}}))},handleChange:function(t){var e,n=this,a=t.fileList,i=a.slice(-1);(null===i||void 0===i||null===(e=i[0])||void 0===e?void 0:e.size)>2048e4?this.$message.warning("pdf不能大于20M"):setTimeout((function(){var t=n.sendContentList.find((function(t){return 3===t.msgType}));t.pdfArr=i.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{status:"done",msgType:3})}))}),0)},handleChangeVideo:function(t){var e,n=this,a=t.fileList,i=a.slice(-1);(null===i||void 0===i||null===(e=i[0])||void 0===e?void 0:e.size)>1024e4?this.$message.warning("视频不能大于10M"):setTimeout((function(){n.getBase64(i[0].originFileObj).then((function(t){var e=n.sendContentList.find((function(t){return 5===t.msgType}));e.videoArr=i.map((function(e){return Object(s["a"])(Object(s["a"])({},e),{},{status:"done",msgType:5,pdfFile:t})}))}))}),0)},customRequest:function(t){t.onSuccess()},serviceOk:function(t){var e=this.sendContentList.find((function(t){return 4===t.msgType}));e.formObj=Object(s["a"])(Object(s["a"])({},t),{},{msgType:4}),this.visibileForm=!1}}},f=m,p=(n("0a2c"),n("2877")),g=Object(p["a"])(f,a,i,!1,null,"4b56a150",null);e["a"]=g.exports},"13da":function(t,e,n){"use strict";n("38cf");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"rule-list"},[e("ul",[e("li",[e("div",{staticClass:"rule-head first",class:{hasList:t.sortPlanList.length>0}},[t._m(0),e("a-button",{staticClass:"aks-border-but",on:{click:function(e){t.$emit("select",t.$moment())}}},[t._v(" 添加 ")])],1)]),t.sortPlanList.length>0?t._l(t.sortPlanList,(function(n,a){return e("li",{key:n.id},[n.repeat?t._e():e("div",{staticClass:"date"},[t._v(" "+t._s(t._f("getDate")(n.timeObj.date))+" ")]),e("div",{staticClass:"rule-head"},[e("div",[e("span",[t._v(t._s(t._f("getTime")(n.timeObj.time)))]),e("a-icon",{staticClass:"clock",attrs:{type:"clock-circle"}})],1),e("span",[t._v(t._s(n.planName))])]),e("div",{staticClass:"rule-content"},[e("div",{staticClass:"rule-left"},[t._l(n.sendContentList,(function(n,a){return[t.isOpen||a<2?e("div",{key:a,staticClass:"text-content"},[e("AccessoryList",{attrs:{item:n}})],1):t._e()]})),e("div",{staticClass:"bottom-content"},[e("a-space",{attrs:{size:12}},[e("span",{staticClass:"aks-tips"},[t._v("共"+t._s(n.sendContentList.length)+"条")]),n.sendContentList.length>2?e("span",{staticClass:"aks-tips",on:{click:function(e){t.isOpen=!t.isOpen}}},[t._v(" "+t._s(t.isOpen?"收起":"展开")+" "),e("a-icon",{attrs:{type:t.isOpen?"up":"down"}})],1):t._e()])],1)],2),e("div",{staticClass:"rule-right"},[e("a-space",[e("a-icon",{attrs:{type:"delete"},on:{click:function(e){return t.deleteRule(a)}}}),e("a-icon",{attrs:{type:"edit"},on:{click:function(e){t.$emit("select",t.$moment(),n)}}})],1)],1)])])})):e("a-empty")],2)])},i=[function(){var t=this,e=t._self._c;return e("div",[e("span",{staticClass:"today"},[t._v("今天")]),e("span",{staticClass:"point"})])}],s=(n("a434"),n("6536")),r={name:"TimeLine",components:{AccessoryList:s["a"]},props:{planList:{type:Array,default:function(){return[]}}},computed:{sortPlanList:function(){for(var t=this.planList,e="",n=0;n<t.length;n++)for(var a=0;a<t.length-n-1;a++){var i,s,r=this.$moment(null===(i=t[a].timeObj)||void 0===i?void 0:i.allTime),o=this.$moment(null===(s=t[a+1].timeObj)||void 0===s?void 0:s.allTime);r>=o&&(e=t[a],t[a]=t[a+1],t[a+1]=e)}return t}},filters:{getTime:function(t){var e=t;return t&&(e=t.format("HH:mm")),e},getDate:function(t){var e=t;return t&&(e=t.format("MM[月]DD[日]")),e}},data:function(){return{isOpen:!1}},methods:{deleteRule:function(t){var e=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"确认后将会删除该条推送，是否删除",onOk:function(){e.planList.splice(t,1)}})}}},o=r,c=(n("c324"),n("2877")),l=Object(c["a"])(o,a,i,!1,null,"439e04ad",null);e["a"]=l.exports},"146f":function(t,e,n){"use strict";n("7d57")},"1bee":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return s}));n("a9e3"),n("ac1f"),n("5319"),n("4d63"),n("25f0");function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss",n=e,a=new Date(Number(t)),i={"M+":a.getMonth()+1,"D+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),"S+":a.getMilliseconds()};for(var s in/(y+)/i.test(n)&&(n=n.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+s+")").test(n)&&(n=n.replace(RegExp.$1,1===RegExp.$1.length?i[s]:("00"+i[s]).substr((""+i[s]).length)));return n}function i(t){var e=parseInt(t/3600)<10?"0"+parseInt(t/3600):parseInt(t/3600),n=parseInt(t%3600/60)<10?"0"+parseInt(t%3600/60):parseInt(t%3600/60);return e+":"+n}function s(t,e){var n=Date.parse(new Date),a=r(n,t),i=new Date(a),s=i.getTime(),o=r(n,e),c=new Date(o),l=c.getTime();return"start"?s>=l:l<=s}function r(t,e){var n=new Date(t),a=n.getFullYear()+"-",i=(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"-",s=n.getDate()+" ";n.getHours(),n.getMinutes(),n.getSeconds();return a+i+s+e+":00"}},"1f3e":function(t,e,n){"use strict";n("49c9")},2033:function(t,e,n){"use strict";n("8b11")},2314:function(t,e,n){"use strict";n("afd2")},"342f1":function(t,e,n){},"49c9":function(t,e,n){},"4d41":function(t,e,n){"use strict";var a=function(){var t=this,e=t._self._c;return e("CommonModal",{attrs:{title:"添加推送内容",okText:"设置"},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},[e("div",{staticClass:"model-main"},[t.planItem.planName?e("a-button",{staticClass:"delete-but",attrs:{slot:"bottomLeft",type:"link"},on:{click:t.deleteData},slot:"bottomLeft"},[t._v(" 删除此条提醒 ")]):t._e(),e("ul",{staticClass:"main",attrs:{id:"section"}},[t.planItem.overdue?e("p",{staticClass:"tips"},[e("a-icon",{staticClass:"primaryColor",attrs:{type:"bell",theme:"filled"}}),t._v(" 本条推送已超过推送时间，无法进行修改 ")],1):t._e(),e("li",[e("p",{staticClass:"title"},[t._v(t._s(t.overText)+"内容名称：")]),e("a-input",{attrs:{maxLength:15,disabled:t.planItem.overdue,placeholder:"设置内容名称,仅内容可见"},model:{value:t.planName,callback:function(e){t.planName=e},expression:"planName"}})],1),t.planItem.overdue?t._e():e("li",[e("p",{staticClass:"title"},[t._v(t._s(t.overText)+"发送时间:")]),e("a-space",[e("a-date-picker",{attrs:{disabledDate:t.disabledDate},model:{value:t.timeObj.date,callback:function(e){t.$set(t.timeObj,"date",e)},expression:"timeObj.date"}}),e("a-time-picker",{attrs:{format:"HH:mm"},on:{change:t.changeTime},model:{value:t.timeObj.time,callback:function(e){t.$set(t.timeObj,"time",e)},expression:"timeObj.time"}}),e("span",[t._v("提醒群主发送")])],1)],1),e("li",[e("p",{staticClass:"title"},[t._v(t._s(t.overText)+"发送内容：")]),e("TypeAccessory",{attrs:{sendContentList:t.sendContentList,msgTypeList:t.msgTypeList,source:"group_calendar"},on:{delContent:t.delContent}}),t.planItem.overdue?t._e():e("a-button",{staticClass:"send-button",attrs:{type:"primary"},on:{click:t.addContent}},[e("a-icon",{attrs:{type:"plus"}}),t._v(" 添加发送内容 ")],1)],1)])],1)])},i=[],s=(n("a434"),n("d3b7"),n("2a86")),r=n("1bee"),o=n("ca00"),c=n("1011"),l={name:"AddSendContant",components:{CommonModal:s["a"],TypeAccessory:c["a"]},props:{sendTime:{type:Object,default:function(){return this.$moment}},planItem:{type:[Object],default:function(){return{}}},status:{type:String,default:""}},computed:{overText:function(){return this.planItem.overdue?"":"设置"}},data:function(){return{msgTypeList:[{id:0,text:"文字",type:"text"},{id:1,text:"图片",type:"image"},{id:2,text:"链接",type:"link"}],sendContentList:[{msgType:0,imageObj:{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}},msgContent:""}],defaultSendContentList:function(){return{msgType:0,imageObj:{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}},msgContent:""}},planName:"",timeObj:{date:this.sendTime,time:this.sendTime}}},watch:{planItem:{handler:function(){var t;if(null!==(t=this.planItem)&&void 0!==t&&t.planName){var e=Object(o["c"])(this.planItem);this.planName=e.planName,this.sendContentList=e.sendContentList,this.timeObj.date=this.planItem.timeObj.date,this.timeObj.time=this.planItem.timeObj.time,this.timeObj.allTime=this.planItem.timeObj.allTime}},immediate:!0}},methods:{changeTime:function(t){var e;return!((null===(e=this.timeObj.date)||void 0===e?void 0:e.format("YYYY MM DD"))==this.$moment().format("YYYY MM DD")&&!Object(r["b"])(null===t||void 0===t?void 0:t.format("HH:mm"),this.$moment().format("HH:mm")))||(this.$message.warning("发送时间不能小于当期时间"),!1)},disabledDate:function(t){return t&&t<=this.$moment().subtract(1,"days")},addContent:function(){this.sendContentList.push(this.defaultSendContentList()),this.$nextTick((function(){var t=document.getElementById("section");t.scrollHeight>t.clientHeight&&setTimeout((function(){t.scrollTop=t.scrollHeight}),300)}))},delContent:function(t){this.sendContentList.splice(t,1)},serviceOk:function(){var t=this;this.verify().then((function(){t.$emit("serviceOk",{timeObj:t.timeObj,planName:t.planName,planId:t.planItem.planId,sendContentList:t.sendContentList})})).catch((function(e){t.$message.warning((null===e||void 0===e?void 0:e.message)||e)}))},verify:function(){var t=this;return new Promise((function(e,n){if(t.changeTime(t.timeObj.time)){t.planName||n("请填写内容名称"),t.timeObj.date||n("请选择发送日期"),t.timeObj.time||n("请选择发送时间");for(var a=0;a<t.sendContentList.length;a++){var i;if(0!==t.sendContentList[a].msgType||t.sendContentList[a].msgContent||n("消息".concat(a+1,"内容未填写")),1!==t.sendContentList[a].msgType||t.sendContentList[a].msgContent.compress||n("消息".concat(a+1,"内容未填写")),2===t.sendContentList[a].msgType)if(!t.sendContentList[a].msgContent||null===(i=t.sendContentList[a].msgContent)||void 0===i||!i.serviceOk())return}e()}}))},deleteData:function(){var t=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"确认删除后，将会删除这条推送",onOk:function(){t.delPage()}})},delPage:function(){this.planItem.delete=!0,this.$emit("serviceOk",this.planItem)}}},u=l,d=(n("5102"),n("2877")),m=Object(d["a"])(u,a,i,!1,null,"08abbd16",null);e["a"]=m.exports},"4f1a":function(t,e,n){"use strict";n("d3b7"),n("ddb0"),n("caad"),n("2532");var a=function(){var t=this,e=t._self._c;return e("div",[e("h6",{staticClass:"dialog-title"},[t._v("选择群聊")]),e("section",[e("a-input-search",{attrs:{allowClear:"",placeholder:"请输入群名称"},on:{search:t.onSearchName},model:{value:t.searchNmae,callback:function(e){t.searchNmae=e},expression:"searchNmae"}}),e("div",{staticClass:"tree"},[e("p",{staticClass:"tree-head"},[t._v(" 全部群聊("+t._s(t.pagination.total)+") "),e("a-checkbox",{on:{change:t.changeAllCheckbox},model:{value:t.isSelectAll,callback:function(e){t.isSelectAll=e},expression:"isSelectAll"}},[t._v(" 全选 ")])],1),e("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t._l(t.groupList,(function(n,a){return e("li",{key:n.groupId,staticClass:"title-wrap"},[e("div",{staticClass:"title-chilred"},[e("a-avatar",{attrs:{size:40,src:"/icons/groupChat.svg",shape:"square"}}),e("div",{staticClass:"info-wrap"},[e("p",[t._v(t._s(n.chatName)+" "),e("a-tag",{attrs:{color:"blue"}},[t._v("外部")])],1),t.isShowNumber?e("p",{staticClass:"aks-tips"},[t._v(t._s(n.count)+"/200")]):e("p",{staticClass:"aks-tips"},[t._v(" 群主："+t._s(n.chatOwnerName))])])],1),e("div",[0!==n[t.keys]&&t.isSetRule?e("p",{staticClass:"aks-tips"},[t._v(t._s(t.tipText))]):e("a-checkbox",{attrs:{disabled:t.selectGroupIdIdList.includes(n.groupId)},on:{change:function(e){return t.changeChilren(a,e)}},model:{value:n.isSelect,callback:function(e){t.$set(n,"isSelect",e)},expression:"item.isSelect"}})],1)])})),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e()],2)])],1),e("div",{staticClass:"foot-button"},[e("a-space",{attrs:{size:12}},[e("a-button",{on:{click:function(e){return t.$emit("cancle")}}},[t._v("取消")]),e("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$emit("serviceOk",t.addGruoupChat)}}},[t._v("确定")])],1)],1)])},i=[],s=n("2909"),r=(n("d81d"),n("4de4"),n("159b"),n("ccdf")),o=n("487a"),c=n.n(o),l={name:"SelectGroupChat",directives:{infiniteScroll:c.a},props:{selectGroupList:{type:[Array],default:function(){return[]}},selectedList:{type:[Array],default:function(){return[]}},isSetRule:{type:Boolean,default:function(){return!0}},isShowNumber:{type:Boolean,default:function(){return!1}},notifyType:{type:String,default:function(){return"groupSop"}}},data:function(){return{searchNmae:"",busy:!1,loading:!1,groupList:[],isSelectAll:!1,pagination:{current:1,pageSize:10,total:0},tipText:"",keys:"",isEnter:!1,isOtherAll:!1}},computed:{selectGroupIdIdList:function(){return this.selectedList.map((function(t){return t.groupId}))},addGruoupChat:function(){var t={};return this.isOtherAll?t.excludeIdList=this.groupList.filter((function(t){return!t.isSelect})).map((function(t){return t.groupId})):t.groupChatIdList=this.groupList.filter((function(t){return t.isSelect})).map((function(t){return t.groupId})),t.groupList=this.groupList.filter((function(t){return t.isSelect})),t}},created:function(){this.getInfo()},methods:{getInfo:function(){switch(this.notifyType){case"groupSop":this.tipText="该群聊已设置规则",this.keys="sopStatus";break;case"groupCalendar":this.tipText="该群聊已设置日历",this.keys="calendarStatus";break;default:break}},changeChilren:function(t,e){if(this.groupList[t].isSelect=e.target.checked,e.target.checked){var n=this.groupList.filter((function(t){return!t.isSelect}));n.length<1&&(this.isSelectAll=!0)}else this.isSelectAll=!1},changeAllCheckbox:function(t){this.isOtherAll=t.target.checked,t.target.checked?this.groupList.forEach((function(t){t.isSelect=!0})):this.groupList.forEach((function(t){t.isSelect=!1}))},onSearchName:function(){this.pagination.current=1,this.groupList=[],this.busy=!1,this.isEnter=!0,this.queryGroupPageByGroupSop()},queryGroupPageByGroupSop:function(){var t=this,e={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,keywords:this.searchNmae,notifyType:this.notifyType};this.loading=!0,Object(r["k"])(e).then((function(e){if(null!==e&&void 0!==e&&e.data){var n,a,i=t.selectGroupList.map((function(t){return t.groupId}));if(null===(n=e.data.list)||void 0===n||n.forEach((function(t){i.includes(t.groupId)?t.isSelect=!0:t.isSelect=!1})),(a=t.groupList).push.apply(a,Object(s["a"])(e.data.list)),t.pagination.current++,t.pagination.total=e.data.total,e.data.list.length<t.pagination.pageSize)return t.busy=!0,void(t.loading=!1);t.$nextTick((function(){t.isEnter=!1}))}})).catch((function(e){t.$message.error(e),t.loading=!1}))},handleInfiniteOnLoad:function(){!this.busy&&!this.isEnter&&this.queryGroupPageByGroupSop()}}},u=l,d=(n("1f3e"),n("2877")),m=Object(d["a"])(u,a,i,!1,null,"94e9cec6",null);e["a"]=m.exports},5102:function(t,e,n){"use strict";n("342f1")},5946:function(t,e,n){"use strict";var a=function(){var t=this,e=t._self._c;return e("a-calendar",{attrs:{"header-render":t.headerRender},on:{select:t.select},scopedSlots:t._u([{key:"dateCellRender",fn:function(n){return e("ul",{staticClass:"events"},t._l(t.getListData(n),(function(a){return e("li",{key:a.content,staticClass:"time-content",class:{overdue:a.overdue},on:{click:function(e){return e.stopPropagation(),t.$emit("select",n,a)}}},[e("p",[t._v("【"+t._s(t._f("getTime")(a.timeObj.time))+"】 "+t._s(a.planName))])])})),0)}}])})},i=[],s=n("5530"),r=(n("d3b7"),n("159b"),{name:"Calendar",props:{planList:{type:Array,default:function(){return[]}},status:{type:String,default:""}},filters:{getTime:function(t){var e=t;return t&&(e=t.format("HH:mm")),e}},methods:{getListData:function(t){var e=[];return this.planList.forEach((function(n){t.format("LL")===n.timeObj.date.format("LL")&&e.push(Object(s["a"])({},n))})),e||[]},headerRender:function(t){for(var e=t.value,n=(t.type,t.onChange),a=(t.onTypeChange,this.$createElement),i=0,s=12,r=[],o=e.clone(),c=e.localeData(),l=[],u=0;u<12;u++)o.month(u),l.push(c.monthsShort(o));for(var d=i;d<s;d++)r.push(a("a-select-option",{class:"month-item",key:"".concat(d)},[l[d]]));for(var m=e.month(),f=e.year(),p=[],g=f-10;g<f+10;g+=1)p.push(a("a-select-option",{key:g,attrs:{value:g},class:"year-item"},[g]));return a("div",{style:{padding:"10px"}},[a("a-row",{attrs:{type:"flex",justify:"center"}},[a("a-col",[a("a-select",{attrs:{dropdownMatchSelectWidth:!1,value:String(f)},class:"my-year-select",on:{change:function(t){var a=e.clone().year(t);n(a)}}},[p])]),a("a-col",[a("a-select",{attrs:{dropdownMatchSelectWidth:!1,value:String(m)},on:{change:function(t){var a=e.clone();a.month(parseInt(t,10)),n(a)}}},[r])])])])},select:function(t){if(this.$moment()<=t||t.format("YYYY MM DD")===this.$moment().format("YYYY MM DD")){var e=t.format("YYYY-MM-DD")+" "+this.$moment().format("HH:mm:ss");this.$emit("select",this.$moment(e))}else this.$message.warning("不可选择今天之前的日期")}}}),o=r,c=(n("ae8b"),n("2877")),l=Object(c["a"])(o,a,i,!1,null,"2eed26e0",null);e["a"]=l.exports},6536:function(t,e,n){"use strict";n("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",[0===t.item.msgType?e("div",[t._v(" "+t._s(t.item.msgContent)+" ")]):t._e(),1===t.item.msgType?e("div",[e("img",{staticClass:"image",attrs:{src:t.item.msgContent.compress}})]):t._e(),2===t.item.msgType?e("div",{staticClass:"card-box"},[e("img",{attrs:{src:t.item.msgContent.form.coverUrl.compress||"/imgs/default-cover.png"},on:{error:t.errorImg}}),e("div",{staticClass:"box-right"},[e("h5",[t._v(t._s(t.item.msgContent.form.linkTitle))]),e("p",[t._v(t._s(t.item.msgContent.form.desc))])])]):t._e(),3===t.item.msgType?e("div",{staticClass:"custom-pdf"},[e("a-avatar",{attrs:{size:60,src:"/icons/pdf.png",shape:"square"}}),e("div",{staticClass:"contant"},[e("p",[t._v(t._s(t.item.pdfArr[0].name))]),e("span",[t._v(t._s(t._f("getUnits")(t.item.pdfArr[0].size)))])])],1):t._e(),5===t.item.msgType?e("div",[e("video",{staticClass:"cover-img",attrs:{src:t.item.videoArr[0].pdfFile,controls:"",height:"100%"}})]):t._e(),4===t.item.msgType?e("div",{staticClass:"custom-form"},[e("h4",[t._v(t._s(t.item.formObj.name))]),e("div",{staticClass:"flex-box"},[e("p",{staticClass:"font-color-black-25"},[t._v(t._s(t.item.formObj.desc))]),e("a-avatar",{attrs:{size:40,src:t.item.formObj.cover,shape:"square"}})],1)]):t._e()])},i=[],s=n("ca00"),r={name:"AccessoryList",components:{},props:{item:{type:Object,default:function(){return{}}}},watch:{item:{handler:function(){},deep:!0,immediate:!0}},data:function(){return{}},filters:{getUnits:function(t){return Object(s["b"])(t)}},methods:{errorImg:function(t){t.target.src="/imgs/default-cover.png"}}},o=r,c=(n("146f"),n("2877")),l=Object(c["a"])(o,a,i,!1,null,"7b304a5e",null);e["a"]=l.exports},6942:function(t,e,n){},7581:function(t,e,n){"use strict";n("b0c0");var a=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.pageList.length>0?e("ul",{staticClass:"randar-list-wrap"},t._l(t.pageList,(function(n){return e("li",{key:n.formId,staticClass:"randar-list",on:{click:function(e){t.selectRandarId=n.formId}}},[e("header",{staticClass:"randar-head"},[e("div"),e("a-checkbox",{attrs:{checked:t.selectRandarId===n.formId}})],1),e("section",{staticClass:"randar-main"},[e("div",{staticClass:"randar-main-content"},[e("p",[t._v(t._s(n.name))]),e("p",{staticClass:"aks-tips"},[t._v(t._s(n.describe))])]),e("a-avatar",{attrs:{size:40,src:n.cover,shape:"square"}})],1)])})),0):e("a-empty"),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e(),!t.loading&&t.pageList.length>0?e("div",{staticClass:"loading-container"},[t._v("没有更多数据了")]):t._e()],1)])},i=[],s=n("2909"),r=(n("7db0"),n("d3b7"),n("2a86")),o=n("487a"),c=n.n(o),l=n("8f19"),u={name:"AddForm",directives:{infiniteScroll:c.a},components:{CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""}},data:function(){return{sourceModal:{title:"自定义表单"},pagination:{current:1,pageSize:10,total:0},form:{typeText:"自定义表单",type:"link",linkTitle:"",desc:"",coverUrl:{compress:""}},type:"",typeText:{1:"链接",2:"PDF",3:"文章",4:"文章"},typeImg:{1:"/imgs/default-cover.png",2:"/icons/pdf.png",3:"/imgs/default-cover.png",4:"/imgs/default-cover.png"},radarName:"",loading:!1,busy:!1,pageList:[],selectRandarId:""}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{serviceOk:function(){var t=this;if(this.selectRandarId){var e=this.pageList.find((function(e){return e.formId===t.selectRandarId}));e.typeText="自定义表单",e.linkTitle=e.name,e.desc=e.describe,e.type="link",e.key="visibileForm",e.linktype="form_link",e.coverUrl={compress:e.cover},this.$emit("serviceOk",e)}else this.$message.warning("请选择一个自定义表单")},init:function(){var t=this,e={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,source:this.source,status:1};this.loading=!0,Object(l["f"])(e).then((function(e){var n;e.data.list.length>0&&(n=t.pageList).push.apply(n,Object(s["a"])(e.data.list));if(t.pagination.current++,e.data.list.length<t.pagination.pageSize)return t.busy=!0,void(t.loading=!1);t.pagination.total=e.data.total})).catch((function(e){t.$message.error(e||e.message)}))},selectTab:function(t){this.type=t,this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},search:function(){this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},handleInfiniteOnLoad:function(){!this.busy&&this.init()}}},d=u,m=(n("2314"),n("2877")),f=Object(m["a"])(d,a,i,!1,null,"66fbf478",null);e["a"]=f.exports},"7d57":function(t,e,n){},"7ff4":function(t,e,n){},"842b":function(t,e,n){"use strict";var a=n("5530"),i=(n("d3b7"),n("d81d"),n("3ca3"),n("ddb0"),n("a15b"),n("a9e3"),n("b0c0"),n("9911"),n("d885")),s=n("cf5f");e["a"]={methods:{interactiveRadarUploadFile:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.uploadFilePath;return new Promise((function(n,a){var i=new FormData;i.append("file",t),i.append("dir",e),Object(s["m"])(i).then((function(t){n(t.data)})).catch((function(t){a(t)}))}))},uploadMedia:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attachments;return new Promise((function(n,a){var i=(null===e||void 0===e?void 0:e.map((function(e){return new Promise((function(n,a){if("link"===e.type&&e.isRadar&&!e.isMaterial)t.interactiveRadarAdd(e).then((function(t){n(t)})).catch((function(t){a(t)}));else if("img"===e.type){var i=new FormData;i.append("file",e.pic_url.file),i.append("dir","clientTransformation"),i.append("type","image"),Object(s["y"])(i).then((function(t){e.pic_url.fileUrl=t.data.fileUrl,e.pic_url.mediaId=t.data.mediaId,n(t.data)}))}else n()}))})))||[];Promise.all(i).then((function(t){n()})).catch((function(e){t.$message.error(e||e.message),t.loading=!1,a(e)}))}))},interactiveRadarAdd:function(t){var e=this;return new Promise((function(n,a){e.getParamsLink(t).then((function(e){Object(i["f"])(e).then((function(e){t.radarId=e.data.radarId,t.url=e.data.radarLink+t.source,n(e)})).catch((function(t){a(t)}))}))}))},getParamsLink:function(t){return new Promise((function(e,n){var a=new FormData,i=t.isCustomerTag?[{autoMarkTagBitmaps:t.selectCustomerTagList.map((function(t){return t.bitmap})).join(",")}]:[];if(a.append("type",1),a.append("radarName",t.linkTitle),a.append("link",t.url),a.append("activityNotify",Number(t.activityNotify)),a.append("behaviorNotify",Number(t.behaviorNotify)),a.append("tagRule",JSON.stringify(i)),a.append("title",t.radarTitle),a.append("desc",t.desc),a.append("hasCustomerTag",Number(t.isCustomerTag)),t.isScoreRule){var r=JSON.stringify(t.ruleDetails.map((function(t){var e,n;return{autoMarkTagBitmaps:null===(e=t.selectTagList)||void 0===e||null===(n=e.map((function(t){return t.bitmap})))||void 0===n?void 0:n.join(","),hasTag:Number(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count||0}})));a.append("scoreRule",r)}if(t.coverUrl.file){var o=new FormData;o.append("file",t.coverUrl.file),o.append("dir","clientTransformation"),Object(s["m"])(o).then((function(n){a.append("coverUrl",n.data),t.picurl=n.data,e(a)})).catch((function(t){n(t)}))}else e(a)}))},getMessageList:function(t){return t.map((function(t){var e="";if(0===t.msgType&&(e=t.msgContent,t.formObj={},t.pdfArr=[],t.videoArr=[]),1===t.msgType&&(e={compress:t.msgContent},t.imageObj={title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{compress:t.msgContent}},t.formObj={},t.pdfArr=[],t.videoArr=[]),2===t.msgType){t.pdfArr=[],t.videoArr=[];var n,i,s,r,o=JSON.parse(t.msgContent);if(e={form:{linkTitle:o.title,desc:o.desc,coverUrl:{compress:o.picUrl},type:"link",url:o.url}},t.interactRadar)e.form.isRadar=!0,e.form.behaviorNotify=Boolean(t.interactRadar.behaviorNotify),e.form.activityNotify=Boolean(t.interactRadar.activityNotify),e.form.isCustomerTag=(null===(n=t.interactRadar.tagRules)||void 0===n?void 0:n.length)>0,e.form.radarTitle=t.interactRadar.radarName,e.form.radarId=t.interactRadar.radarId,e.form.selectCustomerTagList=null===(i=t.interactRadar.tagRules[0])||void 0===i||null===(s=i.customerTags)||void 0===s?void 0:s.map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{key:t.tagId})})),e.form.isScoreRule=(null===(r=t.interactRadar.scoreRules)||void 0===r?void 0:r.length)>0,e.form.ruleDetails=t.interactRadar.scoreRules.map((function(t){var e;return Object(a["a"])(Object(a["a"])({},t),{},{autoMarkTagBitmaps:t.autoMarkTagBitmaps,selectTagList:null===(e=t.customerTags)||void 0===e?void 0:e.map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{key:t.tagId})})),hasTag:Boolean(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count})}))}if(3===t.msgType){var c=JSON.parse(t.msgContent);t.pdfArr=[Object(a["a"])(Object(a["a"])({},c),{},{uid:"1",status:"done"})],t.formObj={},t.videoArr=[]}if(4===t.msgType){var l=JSON.parse(t.msgContent);t.formObj=Object(a["a"])(Object(a["a"])({},l),{},{name:l.title}),t.pdfArr=[]}if(5===t.msgType){var u=JSON.parse(t.msgContent);t.videoArr=[Object(a["a"])({},u)],t.formObj={},t.pdfArr=[]}return Object(a["a"])(Object(a["a"])({},t),{},{msgContent:e})}))},getPlanList:function(t){var e=this;return t.map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{messageList:e.getAddMessageList(t.messageList)})}))},getAddMessageList:function(t){return t.map((function(t){var e="";if(0===t.msgType&&(e=t.msgContent),1===t.msgType&&(e=t.fileUrl||t.msgContent.compress),2===t.msgType){var n,a,i="";t.fileUrl?i=t.fileUrl:t.msgContent.form.picurl?i=t.msgContent.form.picurl:t.msgContent.form.coverUrl.compress&&(i=t.msgContent.form.coverUrl.compress);var s=t.msgContent.form.radarId||(null===(n=t.msgContent.form.interactRadar)||void 0===n?void 0:n.radarId);s&&(s=String(s)),e=JSON.stringify({desc:t.msgContent.form.desc,picUrl:i,url:t.msgContent.form.url,title:t.msgContent.form.linkTitle,radarId:s,type:t.msgContent.form.radarId||null!==(a=t.msgContent.form.interactRadar)&&void 0!==a&&a.radarId?"radar_link":"normal_link"})}return 3===t.msgType&&(e=JSON.stringify({pdfFile:t.pdfArr[0].fileUrl||t.pdfArr[0].pdfFile,name:t.pdfArr[0].name,size:t.pdfArr[0].size,cover:"https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/h5/img/pdf.png"})),4===t.msgType&&(e=JSON.stringify({cover:t.formObj.cover,desc:t.formObj.desc,title:t.formObj.name,url:t.formObj.link})),{messageId:t.messageId,msgType:t.msgType,msgContent:e}}))},getPlanFileList:function(t){var e=this,n=[];return t.length>0&&(n=t.map((function(t){return new Promise((function(n,a){var i,s,r,o;2===t.msgType?t.msgContent.form.isRadar&&t.msgContent.form.randerIsEdit?e.interactiveRadarAdd(t.msgContent.form).then((function(e){t.radarId=e.data,n(e)})).catch((function(t){a(t)})):t.msgContent.form.coverUrl.file?e.interactiveRadarUploadFile(t.msgContent.form.coverUrl.file).then((function(e){t.fileUrl=e,n(e)})).catch((function(t){a(t)})):n():1===t.msgType&&t.msgContent.file?e.interactiveRadarUploadFile(t.msgContent.file).then((function(e){t.fileUrl=e,n(e)})).catch((function(t){a(t)})):3===t.msgType&&null!==(i=t.pdfArr)&&void 0!==i&&null!==(s=i[0])&&void 0!==s&&s.originFileObj?e.interactiveRadarUploadFile(t.pdfArr[0].originFileObj).then((function(e){t.pdfArr[0].fileUrl=e,n(e)})).catch((function(t){a(t)})):5===t.msgType&&null!==(r=t.videoArr)&&void 0!==r&&null!==(o=r[0])&&void 0!==o&&o.originFileObj?e.interactiveRadarUploadFile(t.videoArr[0].originFileObj).then((function(e){t.videoArr[0].fileUrl=e,n(e)})).catch((function(t){a(t)})):n()}))}))),n}}}},"8b11":function(t,e,n){},"8e51":function(t,e,n){"use strict";n("ac1f"),n("841c");var a=function(){var t=this,e=t._self._c;return e("div",[e("div",[e("div",[e("h2",{staticClass:"dialog-title"},[t._v("执行群聊")]),e("div",{staticClass:"inner"},[e("div",{staticClass:"head-wrap"},[e("div",{staticClass:"intro"},[t._v("共"+t._s(t.groupOwners.length)+"个群主的"+t._s(t.rule.group_chats.length)+"个群聊执行该规则")]),e("TreeSelect",{attrs:{treeData:t.groupOwners},on:{search:t.search}})],1),e("ul",{staticClass:"group-list"},t._l(t.rule.group_chats,(function(n,a){return e("li",{directives:[{name:"show",rawName:"v-show",value:n.chatOwnerId===t.chatOwnerId||!t.chatOwnerId,expression:"(item.chatOwnerId === chatOwnerId) || !chatOwnerId"}],key:a},[e("div",{staticClass:"group-info"},[e("a-avatar",{staticStyle:{"margin-right":"10px"},attrs:{size:46,src:"/icons/groupChat.png",shape:"square"}}),e("div",{staticClass:"group-info-inner"},[e("p",{staticClass:"name"},[t._v(t._s(n.groupChatName))]),e("p",{staticClass:"owner"},[t._v(" 群主："),e("span",{staticClass:"owner-name"},[t._v(t._s(n.chatOwnerName))]),0!==n.joinDays?e("span",{staticClass:"join-time"},[t._v("加入规则第"+t._s(n.joinDays)+"天")]):e("span",{staticClass:"join-time"},[t._v("加入规则小于1天")])])])],1),e("div",{staticClass:"remove-btn clickable",on:{click:function(e){return t.showConfirm(n)}}},[t._v("将群聊移除规则")])])})),0)])])])])},i=[],s=(n("d81d"),n("d3b7"),n("159b"),n("7db0"),n("b0c0"),function(){var t=this,e=t._self._c;return e("div",[e("a-col",[e("a-tree-select",{staticStyle:{width:"192px"},attrs:{"dropdown-style":{maxHeight:"150px",overflow:"auto"},"tree-data":t.treeData,"tree-default-expand-all":"",allowClear:t.allowClear},on:{change:t.search},scopedSlots:t._u([{key:"title",fn:function(n){return e("span",{staticStyle:{color:"#08c"}},[t._v(" "+t._s(n.name)+" ")])}}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1)}),r=[],o={props:{treeData:{type:Array,default:function(){return[]}}},data:function(){return{value:"全部群主",allowClear:!1}},methods:{search:function(t){this.$emit("search",t)}},watch:{value:function(t){void 0===t?this.value="全部群主":this.allowClear="全部群主"!==t}}},c=o,l=n("2877"),u=Object(l["a"])(c,s,r,!1,null,null,null),d=u.exports,m={components:{TreeSelect:d},props:["rule"],data:function(){return{chatOwnerId:""}},computed:{groupOwners:function(){var t=this,e=this.rule.group_chats.map((function(t){return t.chatOwnerId})),n=[],a={};return e.forEach((function(e){var i,s;a[e]||(a[e]=1,n.push({title:null===(i=t.rule.group_chats)||void 0===i||null===(s=i.find((function(t){return t.chatOwnerId===e})))||void 0===s?void 0:s.chatOwnerName,value:e,key:e}))})),n}},methods:{search:function(t){this.chatOwnerId=t},showConfirm:function(t){this.$createElement;var e=this;this.$confirm({cancelText:"取消",okText:"确认",title:"提醒",content:function(t){return t("div",["移出后群聊将不会收到推送，是否确认移出？"])},onOk:function(){e.delGroupChat(t)}})},delGroupChat:function(t){this.$emit("deleteGroupChat",t)}}},f=m,p=(n("b0ce"),Object(l["a"])(f,a,i,!1,null,"671f8eb4",null));e["a"]=p.exports},"8f19":function(t,e,n){"use strict";n.d(e,"n",(function(){return s})),n.d(e,"q",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"j",(function(){return c})),n.d(e,"h",(function(){return l})),n.d(e,"f",(function(){return u})),n.d(e,"l",(function(){return d})),n.d(e,"d",(function(){return m})),n.d(e,"e",(function(){return f})),n.d(e,"i",(function(){return p})),n.d(e,"g",(function(){return g})),n.d(e,"b",(function(){return h})),n.d(e,"k",(function(){return v})),n.d(e,"m",(function(){return b})),n.d(e,"c",(function(){return C})),n.d(e,"p",(function(){return y})),n.d(e,"o",(function(){return O}));var a=n("b775"),i={customerFormSave:"/client_transformation/customerForm/save",dateInfoList:"/client_transformation/customerFormData/dateInfoList",customerFormList:"/client_transformation/customerForm/list",customerFormInfo:"/client_transformation/customerForm/info",customerFormUpdate:"/client_transformation/customerForm/update",customerFormPublish:"/client_transformation/customerForm/publish",customerFormDelete:"/client_transformation/customerForm/delete",dataInfo:"/client_transformation/customerFormData/dataInfo",analysis:"/client_transformation/customerFormData/analysis",staffList:"/client_transformation/customerFormData/staffList",infoList:"/client_transformation/customerFormData/infoList",analysisExport:"/client_transformation/customerFormData/analysisExport",dataInfoExport:"/client_transformation/customerFormData/dataInfoExport",infoCityList:"/client_transformation/customerFormData/infoCityList",batchTags:"/client_transformation/customerFormData/batchTags",selectList:"/client_transformation/customerForm/userData/selectList",queryDataList:"/client_transformation/customerFormData/queryDataList"};function s(t){return Object(a["b"])({url:i.infoList,method:"post",data:t})}function r(t){return Object(a["b"])({url:i.staffList,method:"get",params:t})}function o(t){return Object(a["b"])({url:i.analysis,method:"get",params:t})}function c(t){return Object(a["b"])({url:i.dataInfo,method:"get",params:t})}function l(t){return Object(a["b"])({url:i.customerFormSave,method:"post",data:t})}function u(t){return Object(a["b"])({url:i.customerFormList,method:"get",params:t})}function d(t){return Object(a["b"])({url:i.dateInfoList,method:"get",params:t})}function m(t){return Object(a["b"])({url:i.customerFormDelete,method:"post",data:t})}function f(t){return Object(a["b"])({url:i.customerFormInfo,method:"get",params:t})}function p(t){return Object(a["b"])({url:i.customerFormUpdate,method:"post",data:t})}function g(t){return Object(a["b"])({url:i.customerFormPublish,method:"post",data:t})}function h(t){return Object(a["b"])({url:i.analysisExport,method:"get",params:t,responseType:"blob"})}function v(t){return Object(a["b"])({url:i.dataInfoExport,method:"get",params:t,responseType:"blob"})}function b(t){return Object(a["b"])({url:i.infoCityList,method:"get",params:t})}function C(t){return Object(a["b"])({url:i.batchTags,method:"post",data:t})}function y(t){return Object(a["b"])({url:i.selectList,method:"get",params:t})}function O(t){return Object(a["b"])({url:i.queryDataList,method:"post",data:t})}},"953d":function(t,e,n){},a768:function(t,e,n){"use strict";n("6942")},ae8b:function(t,e,n){"use strict";n("7ff4")},afd2:function(t,e,n){},b0ce:function(t,e,n){"use strict";n("f4ce")},b28d:function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"f",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return c})),n.d(e,"k",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return d})),n.d(e,"i",(function(){return m})),n.d(e,"h",(function(){return f})),n.d(e,"j",(function(){return p})),n.d(e,"e",(function(){return g}));var a=n("b775"),i={pageList:"/client_group/groupCalendar/page",addPage:"/client_group/groupCalendar/save",detailPage:"/client_group/groupCalendar/detail",delPage:"/client_group/groupCalendar/delete",updateStatus:"/client_group/groupCalendar/updateStatus",addGroupChat:"/client_group/groupCalendar/addGroupChat",delGroupChat:"/client_group/groupCalendar/delGroupChat",update:"/client_group/groupCalendar/update",savePlan:"/client_group/groupCalendar/savePlan",updatePlan:"/client_group/groupCalendar/updatePlan",deletePlan:"/client_group/groupCalendar/deletePlan"};function s(t){return Object(a["b"])({url:i.pageList,method:"get",params:t})}function r(t){return Object(a["b"])({url:i.detailPage,method:"get",params:t})}function o(t){return Object(a["b"])({url:i.addPage,method:"post",data:t})}function c(t){return Object(a["b"])({url:i.delPage,method:"post",data:t})}function l(t){return Object(a["b"])({url:i.updateStatus,method:"get",params:t})}function u(t){return Object(a["b"])({url:i.addGroupChat,method:"post",data:t})}function d(t){return Object(a["b"])({url:i.delGroupChat,method:"post",data:t})}function m(t){return Object(a["b"])({url:i.update,method:"post",data:t})}function f(t){return Object(a["b"])({url:i.savePlan,method:"post",data:t})}function p(t){return Object(a["b"])({url:i.updatePlan,method:"post",data:t})}function g(t){return Object(a["b"])({url:i.deletePlan,method:"post",data:t})}},c0e2:function(t,e,n){},c324:function(t,e,n){"use strict";n("953d")},d8bc:function(t,e,n){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"switch",class:{active:"left"===t.isActive}},[e("span",{class:{active:"left"===t.isActive},on:{click:function(e){return t.changeSwitch("left")}}},[t._v(" "+t._s(t.leftText)+" ")]),e("span",{class:{active:"right"===t.isActive},on:{click:function(e){return t.changeSwitch("right")}}},[t._v(" "+t._s(t.rightText)+" ")])])},i=[],s={name:"AksSwitch",props:{leftText:{type:String,default:function(){return"日历"}},rightText:{type:String,default:function(){return"时间轴"}}},data:function(){return{isActive:"left"}},methods:{changeSwitch:function(t){this.isActive!==t&&(this.isActive=t,this.$emit("changeSwitch",t))}}},r=s,o=(n("a768"),n("2877")),c=Object(o["a"])(r,a,i,!1,null,"a69f9f30",null);e["a"]=c.exports},f4ce:function(t,e,n){},fa35:function(t,e,n){"use strict";n.r(e);n("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",[e("a-page-header",{staticClass:"page-header background-white",attrs:{title:"群日历详情"},on:{back:function(e){return t.$router.go(-1)}}}),e("a-spin",{attrs:{spinning:t.loading}},[e("section",{staticClass:"background-white main page-box"},[e("div",{staticClass:"edit"},[e("span",{directives:[{name:"show",rawName:"v-show",value:!t.isEdit,expression:"!isEdit"}],on:{click:t.inEdit}},[t._v(" "+t._s(t.form.name)),e("a-icon",{attrs:{type:"form"}})],1),e("span",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}]},[e("a-input",{ref:"input",staticStyle:{width:"200px"},attrs:{maxLength:30,placeholder:"请填写日历名称"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),e("span",{staticClass:"cancle",on:{click:function(e){t.isEdit=!1}}},[t._v("取消")]),e("a-button",{attrs:{type:"link"},on:{click:t.submitName}},[t._v("确定")])],1)]),e("div",[e("div",{staticClass:"tops"},[e("div",{staticClass:"flex-box"},[e("aks-switch",{on:{changeSwitch:t.changeSwitch}}),e("span",{staticClass:"all-group"},[t._v(" 该日历下共"+t._s(t.chatList.length)+"个群聊 "),e("a-button",{attrs:{type:"link"},on:{click:function(e){t.visible=!0}}},[t._v("查看全部")])],1)],1),e("a-button",{attrs:{type:"primary"},on:{click:function(e){t.visibleGroup=!0}}},[e("a-icon",{attrs:{type:"plus"}}),t._v(" 添加群聊至日历 ")],1)],1),e("Calendar",{directives:[{name:"show",rawName:"v-show",value:"left"===t.direction,expression:"direction === 'left'"}],attrs:{status:"detail",planList:t.filterPlanList},on:{select:t.select}}),e("TimeLine",{directives:[{name:"show",rawName:"v-show",value:"right"===t.direction,expression:"direction === 'right'"}],attrs:{planList:t.filterPlanList},on:{select:t.select}})],1)])]),e("a-modal",{attrs:{footer:null,destroyOnClose:""},model:{value:t.visibleSendContant,callback:function(e){t.visibleSendContant=e},expression:"visibleSendContant"}},[e("AddSendContant",{attrs:{sendTime:t.sendTime,planItem:t.editData,status:"detail"},on:{cancle:function(e){t.visibleSendContant=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,centered:"",width:"600px",destroyOnClose:""},model:{value:t.visibleGroup,callback:function(e){t.visibleGroup=e},expression:"visibleGroup"}},[e("SelectGroupChat",{attrs:{isSetRule:!0,notifyType:"groupCalendar"},on:{serviceOk:t.serviceGroup,cancle:function(e){t.visibleGroup=!1}}})],1),e("a-modal",{attrs:{width:"653px",bodyStyle:t.bodyStyle,footer:"",destroyOnClose:""},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("GroupExecute",{attrs:{rule:t.rule},on:{deleteGroupChat:t.deleteGroupChat}})],1)],1)},i=[],s=n("c7eb"),r=n("1da1"),o=n("5530"),c=(n("38cf"),n("d3b7"),n("d81d"),n("c740"),n("a434"),n("159b"),n("caad"),n("3ca3"),n("ddb0"),n("d8bc")),l=n("4f1a"),u=n("4d41"),d=n("8e51"),m=n("13da"),f=n("5946"),p=n("b28d"),g=n("842b"),h={name:"CalendarDetail",components:{AksSwitch:c["a"],AddSendContant:u["a"],TimeLine:m["a"],Calendar:f["a"],SelectGroupChat:l["a"],GroupExecute:d["a"]},mixins:[g["a"]],data:function(){return{uploadFilePath:"clientGroup",form:{name:""},rules:{name:[{required:!0,message:"请填写日历名称"}]},direction:"left",visibleSendContant:!1,bodyStyle:{height:"599px"},visible:!1,sendTime:"",rule:{},planList:[],loading:!1,editData:{},isEdit:!1,visibleGroup:!1,chatList:[]}},computed:{filterPlanList:function(){for(var t={},e=0;e<this.planList.length;e++){var n=this.planList[e],a=n.timeObj.date.format("MM[月]DD[日]");t[a]?n.repeat=!0:t[a]=!0,n.timeObj.allTime=n.timeObj.date.format("YYYY-MM-DD")+" "+n.timeObj.time.format("HH:mm")+":00"}return this.planList},calendarId:function(){return this.$route.query.id}},activated:function(){this.getDetailPage()},methods:{deleteGroupChat:function(t){var e=this,n=t.calendarId,a=t.groupChatId,i={groupChatIdList:[a],calendarId:n};Object(p["c"])(i).then((function(t){e.$message.success("删除成功"),e.getDetailPage()})).catch((function(t){e.$message.error(t)}))},serviceGroup:function(t){var e=this,n=Object(o["a"])({calendarId:this.calendarId},t);Object(p["a"])(n).then((function(t){e.visibleGroup=!1,e.getDetailPage(),e.$message.success("添加群聊成功")})).catch((function(t){e.$message.error(t)}))},submitName:function(){var t=this,e={calendarId:this.calendarId,name:this.form.name};Object(p["i"])(e).then((function(e){t.isEdit=!1,t.$message.success("名字更改成功")})).catch((function(e){t.$message.error(e)}))},inEdit:function(){var t=this;this.isEdit=!0,this.$nextTick((function(){t.$refs.input.focus()}))},getDetailPage:function(){var t=this;this.loading=!0;var e={calendarId:this.calendarId};Object(p["f"])(e).then((function(e){if(e.data){var n;t.form.name=e.data.name;var a=e.data;t.rule={staff:{alias:a.creatorName},groupChatCount:a.groupChatCount,created_at:a.createTime,todayNotifyChatCount:a.todayNotifyChatCount,todayNotifyOwnerCount:a.todayNotifyOwnerCount,name:a.name,group_chats:a.chatList,plans:a.planList},t.chatList=e.data.chatList,t.planList=null===(n=e.data.planList)||void 0===n?void 0:n.map((function(e){return{planName:e.planName,planId:e.planId,overdue:1===e.sendStatus,timeObj:{date:t.$moment(e.sendTime),time:t.$moment(e.sendTime)},sendContentList:t.getMessageList(e.messageList)}}))}})).catch((function(e){t.$message.error(e)})).finally((function(){t.loading=!1}))},clearData:function(){this.form.name="",this.planList=[]},verify:function(){var t=this;return new Promise((function(e,n){var a;t.form.name||n("请填写日历名称"),(null===(a=t.planList)||void 0===a?void 0:a.length)<=0&&n("请添加日历推送内容"),e()}))},changeSwitch:function(t){this.direction=t},serviceOk:function(t){var e=this,n=this.planList.findIndex((function(e){return e.timeObj.allTime===t.timeObj.allTime}));n>=0?t.delete?this.deletePlan(t).then((function(){e.planList.splice(n,1)})):this.updatePlan(t).then((function(){e.$set(e.planList,n,t)})):this.savePlan(t).then((function(){e.getDetailPage()})),this.visibleSendContant=!1},select:function(t,e){this.editData=e||{},this.sendTime=t,this.visibleSendContant=!0},deletePlan:function(t){var e=this;return new Promise((function(n,a){e.loading=!0,Object(p["e"])([t.planId]).then((function(t){n(),e.$message.success("修改成功")})).catch((function(t){a(),e.$message.error(t)})).finally((function(){e.loading=!1}))}))},getParams:function(t){var e=this;return new Promise((function(n,a){var i=[];t.sendContentList.forEach((function(t,e){t.step=e+1,[1,2].includes(t.msgType)&&i.push(t)}));var s=[];i.length>0&&(s=i.map((function(t){return new Promise((function(n,a){2===t.msgType?t.msgContent.form.isRadar&&t.msgContent.form.randerIsEdit?e.interactiveRadarAdd(t.msgContent.form).then((function(e){t.radarId=e.data,n(e)})).catch((function(t){a(t)})):t.msgContent.form.coverUrl.file?e.interactiveRadarUploadFile(t.msgContent.form.coverUrl.file,"clientGroup").then((function(e){t.fileUrl=e,n(e)})).catch((function(t){a(t)})):n():1===t.msgType&&t.msgContent.file?e.interactiveRadarUploadFile(t.msgContent.file,"clientGroup").then((function(e){t.fileUrl=e,n(e)})).catch((function(t){a(t)})):n()}))}))),Promise.all(s).then((function(e){var a={planId:t.planId,sendTime:t.timeObj.date.format("YYYY-MM-DD")+" "+t.timeObj.time.format("HH:mm")+":00",planName:t.planName,messageList:t.sendContentList.map((function(t){if(0===t.msgType)return{messageId:t.messageId,msgType:t.msgType,msgContent:t.msgContent};if(1===t.msgType)return{messageId:t.messageId,msgType:t.msgType,msgContent:t.fileUrl||t.msgContent.compress};if(2===t.msgType){var e,n=t.msgContent.form.radarId||(null===(e=t.msgContent.form.interactRadar)||void 0===e?void 0:e.radarId);return n&&(n=String(n)),{messageId:t.messageId,msgType:t.msgType,msgContent:JSON.stringify({desc:t.msgContent.form.desc,picUrl:t.fileUrl||t.msgContent.form.picurl||t.msgContent.form.coverUrl.compress,url:t.msgContent.form.url,title:t.msgContent.form.linkTitle,radarId:n,type:n?"radar_link":"normal_link"})}}}))};n(a)})).catch((function(t){a(t)}))}))},updatePlan:function(t){var e=this;return new Promise(function(){var n=Object(r["a"])(Object(s["a"])().mark((function n(a,i){var r;return Object(s["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.loading=!0,n.next=3,e.getParams(t);case 3:r=n.sent,Object(p["j"])(r).then((function(t){a(),e.$message.success("修改成功")})).catch((function(t){i(),e.$message.error(t)})).finally((function(){e.loading=!1}));case 5:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())},savePlan:function(t){var e=this;return new Promise(function(){var n=Object(r["a"])(Object(s["a"])().mark((function n(a,i){var r;return Object(s["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.loading=!0,n.next=3,e.getParams(t);case 3:r=n.sent,Object(p["h"])(r).then((function(t){a(),e.$message.success("添加成功")})).catch((function(t){i(),e.$message.error(t)})).finally((function(){e.loading=!1}));case 5:case"end":return n.stop()}}),n)})));return function(t,e){return n.apply(this,arguments)}}())}}},v=h,b=(n("2033"),n("2877")),C=Object(b["a"])(v,a,i,!1,null,"719390ca",null);e["default"]=C.exports}}]);