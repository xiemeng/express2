(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03bf9c72"],{"02ff":function(t,e,n){"use strict";var i=function(){var t=this,e=t._self._c;return e("a-modal",{attrs:{title:"权限设置",destroyOnClose:""},on:{ok:t.ok,cancel:t.cancel},model:{value:t.visiblePurviewSetting,callback:function(e){t.visiblePurviewSetting=e},expression:"visiblePurviewSetting"}},[e("a-form",{attrs:{layout:"inline"}},[e("a-form-item",{attrs:{label:"设置角色:"}},[e("a-select",{staticStyle:{width:"200px"},model:{value:t.selectRole,callback:function(e){t.selectRole=e},expression:"selectRole"}},t._l(t.roles,(function(n){return e("a-select-option",{key:n.roleId,attrs:{value:n.roleId}},[t._v(" "+t._s(n.roleName)+" ")])})),1)],1)],1),e("div",[t.findSelectRoles&&t.findSelectRoles.desc?e("div",{staticClass:"font-color-black-25"},[t._v(t._s(t.findSelectRoles.desc))]):t._e(),t.findSelectRoles&&t.findSelectRoles.children?e("div",{staticClass:"department-box"},[e("a-tree",{attrs:{checkable:"","auto-expand-parent":t.autoExpandParent,"tree-data":t.treeData},model:{value:t.checkedKeys,callback:function(e){t.checkedKeys=e},expression:"checkedKeys"}},[e("a-icon",{staticClass:"primaryColor",attrs:{slot:"switcherIcon",type:"caret-down"},slot:"switcherIcon"})],1)],1):t._e()])],1)},a=[],r=(n("7db0"),n("d3b7"),n("d81d"),n("a15b"),n("1c9c")),s={name:"PurviewSetting",props:["value","roles","selectRoleId","staffId","roleName"],data:function(){return{visiblePurviewSetting:!1,selectRole:"",autoExpandParent:!0,checkedKeys:[]}},computed:{findSelectRoles:function(){var t,e=this;return null===(t=this.roles)||void 0===t?void 0:t.find((function(t){return t.roleId===e.selectRole}))},treeData:function(){var t,e,n=[];return(null===(t=this.findSelectRoles)||void 0===t||null===(e=t.children)||void 0===e?void 0:e.length)>0&&(n=this.getTreeData(this.findSelectRoles.children)),n}},watch:{value:function(){this.visiblePurviewSetting=this.value},selectRoleId:{handler:function(){this.selectRole=this.selectRoleId},immediate:!0},roleName:{handler:function(){var t,e,n=this;this.selectRole=null===(t=this.roles)||void 0===t||null===(e=t.find((function(t){return t.roleName===n.roleName})))||void 0===e?void 0:e.roleId},immediate:!0}},created:function(){},methods:{getTreeData:function(t){var e=this;if((null===t||void 0===t?void 0:t.length)>0){var n=t.map((function(t){var n={title:t.roleName,key:t.roleId,slots:{icon:"smile"},children:void 0};return t.children&&(n.children=e.getTreeData(t.children)),n}));return n}},cancel:function(){this.visiblePurviewSetting=!1,this.$emit("input",this.visiblePurviewSetting)},ok:function(){var t=this;this.visiblePurviewSetting=!1,this.$emit("input",this.visiblePurviewSetting);var e=this.getParams();Object(r["c"])(e).then((function(e){t.$message.success("切换角色成功"),t.$emit("changeRoleId",t.selectRole)})).catch((function(e){t.$message.error(e||e.message)}))},getParams:function(){var t=this.selectRole;return this.findSelectRoles.children&&(t=this.checkedKeys.join(",")),{staffId:this.staffId,roleIds:t}}}},o=s,l=(n("631c"),n("2877")),c=Object(l["a"])(o,i,a,!1,null,"13883349",null);e["a"]=c.exports},"04e8":function(t,e,n){"use strict";n("4fd8")},"0cd2":function(t,e,n){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[e("h6",[t._v("如何添加成员")]),e("div",{staticClass:"add-role-modal"},[e("p",{staticClass:"top-hint-box"},[t._v("此处显示的成员均为授权给"+t._s(t.ENTERPRICE_NAME)+"的成员，如需添加成员请去企业微信授权，如有疑问可以 "),e("a",[t._v("联系客服")])]),e("h4",[e("a-icon",{attrs:{type:"info-circle"}}),t._v(" 进入"),e("a",{attrs:{href:"https://work.weixin.qq.com/wework_admin/frame#apps",target:"_blank"}},[t._v("企业微信")]),t._v(" ，找到【应用管理】-【应用】-【自建应用】下的"),e("span",{staticClass:"text-black"},[e("b",[t._v("【"+t._s(t.ENTERPRICE_NAME)+"提醒】")])])],1),e("img",{attrs:{alt:"如何添加成员",src:"/imgs/addRole1.png"}}),e("h4",[e("a-icon",{attrs:{type:"info-circle"}}),t._v(" 打开"+t._s(t.ENTERPRICE_NAME)+"提醒，点击【编辑】，在【使用范围】内修改或添加成员 ")],1),e("img",{attrs:{alt:"如何添加成员",src:"/imgs/addRole2.png"}})])])},a=[],r={name:"AddRoleModal"},s=r,o=(n("e1b8"),n("2877")),l=Object(o["a"])(s,i,a,!1,null,"63db7446",null);e["a"]=l.exports},"1c9c":function(t,e,n){"use strict";n.d(e,"s",(function(){return r})),n.d(e,"e",(function(){return s})),n.d(e,"t",(function(){return o})),n.d(e,"j",(function(){return l})),n.d(e,"n",(function(){return c})),n.d(e,"y",(function(){return d})),n.d(e,"w",(function(){return u})),n.d(e,"g",(function(){return f})),n.d(e,"B",(function(){return p})),n.d(e,"c",(function(){return m})),n.d(e,"h",(function(){return h})),n.d(e,"a",(function(){return g})),n.d(e,"q",(function(){return v})),n.d(e,"i",(function(){return b})),n.d(e,"v",(function(){return R})),n.d(e,"p",(function(){return y})),n.d(e,"b",(function(){return S})),n.d(e,"l",(function(){return _})),n.d(e,"m",(function(){return O})),n.d(e,"z",(function(){return I})),n.d(e,"C",(function(){return k})),n.d(e,"k",(function(){return w})),n.d(e,"A",(function(){return C})),n.d(e,"x",(function(){return x})),n.d(e,"r",(function(){return j})),n.d(e,"o",(function(){return N})),n.d(e,"d",(function(){return L})),n.d(e,"f",(function(){return T})),n.d(e,"u",(function(){return E}));var i=n("b775"),a={staff:"/enterprise/role/staff",roleList:"/enterprise/role",roleResource:"/enterprise/role/getRoleResource",syncAll:"/enterprise/staff/syncAll",getCustGrpList:"/client_group/customerGroup/getCustGrpList",changeRole:"/enterprise/role/change",departmentStaff:"/enterprise/department/staff",addStaffRole:"/enterprise/role/addStaffRole",getQuitStaff:"/client_manager/transfer/getQuitStaff",getStaff:"/enterprise/staff/get",department:"/enterprise/department",getDepartmentStaff:"/enterprise/department/getStaff",loginAdmin:"/enterprise/staff/loginAdmin",getRoleRes:"/enterprise/role/getRoleRes",changeRes:"/enterprise/role/change/res",getPermissionLog:"/enterprise/permissionLog/query",staffInfo:"/enterprise/staff/statistics/get/staffInfo",yesterdayData:"/enterprise/staff/statistics/get/yesterdayData",getDate:"/enterprise/staff/statistics/get/date",editDelConfig:"/client_manager/customerdelremind/editDelConfig",queryDelConfig:"/client_manager/customerdelremind/queryDelConfig",customStage:"/enterprise/staff/statistics/get/stage",idOrUserIdGet:"/enterprise/staff/idOrUserIdGet",staffOKR:"/enterprise/staffOKR/staffOKR",saveOKR:"/enterprise/staffOKR/save",getStaffOKRList:"/enterprise/staffOKR/getStaffOKRList",getRepeatList:"/enterprise/staffOKR/getRepeatList",checkTime:"enterprise/staffOKR/checkTime",delOkr:"/enterprise/staffOKR/del",modify:"/enterprise/staffOKR/modify"};function r(t){return Object(i["b"])({url:a.idOrUserIdGet,method:"get",params:t})}function s(t){return Object(i["b"])({url:a.customStage,method:"get",params:t})}function o(t){return Object(i["b"])({url:a.loginAdmin,method:"get",params:t})}function l(t){return Object(i["b"])({url:a.getCustGrpList,method:"post",data:t})}function c(t){return Object(i["b"])({url:a.getQuitStaff,method:"get",params:t})}function d(t){return Object(i["b"])({url:a.staff,method:"get",params:t})}function u(){return Object(i["b"])({url:a.roleList,method:"get"})}function f(){return Object(i["b"])({url:a.department,method:"get"})}function p(){return Object(i["b"])({url:a.syncAll,method:"get"})}function m(t){return Object(i["b"])({url:a.changeRole,method:"get",params:t})}function h(){return Object(i["b"])({url:a.departmentStaff,method:"get"})}function g(t){return Object(i["b"])({url:a.addStaffRole,method:"post",data:t})}function v(t){return Object(i["b"])({url:a.getStaff,method:"get",params:t})}function b(t){return Object(i["b"])({url:a.editDelConfig,method:"post",data:t})}function R(t){return Object(i["b"])({url:a.queryDelConfig,method:"post",data:t})}function y(t){return Object(i["b"])({url:a.getRoleRes,method:"get",params:t})}function S(t){return Object(i["b"])({url:a.changeRes,method:"post",data:t})}function _(t){return Object(i["b"])({url:a.getDepartmentStaff,method:"get",params:t})}function O(t){return Object(i["b"])({url:a.getPermissionLog,method:"post",data:t})}function I(t){return Object(i["b"])({url:a.staffInfo,method:"get",params:t})}function k(t){return Object(i["b"])({url:a.yesterdayData,method:"get",params:t})}function w(t){return Object(i["b"])({url:a.getDate,method:"get",params:t})}function C(t){return Object(i["b"])({url:a.staffOKR,method:"get",params:t})}function x(t){return Object(i["b"])({url:a.saveOKR,method:"post",data:t})}function j(t){return Object(i["b"])({url:a.getStaffOKRList,method:"get",params:t})}function N(t){return Object(i["b"])({url:a.getRepeatList,method:"get",params:t})}function L(t){return Object(i["b"])({url:a.checkTime,method:"get",params:t})}function T(t){return Object(i["b"])({url:a.delOkr,method:"post",data:t})}function E(t){return Object(i["b"])({url:a.modify,method:"post",data:t})}},"4fd8":function(t,e,n){},6167:function(t,e,n){},"631c":function(t,e,n){"use strict";n("6167")},c036:function(t,e,n){},c88a:function(t,e,n){"use strict";n.r(e);n("b0c0");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"height100 page-box"},[e("header",{staticClass:"header"},[t._v(" "+t._s(t.ENTERPRICE_NAME)+"部门数据与企业微信同步，若需要修改员工部门请前往企业微信设置， "),e("a",{attrs:{href:"https://work.weixin.qq.com/wework_admin/frame#contacts"}},[t._v("去设置")])]),e("section",{staticClass:"section height100"},[e("a-row",{attrs:{type:"flex",justify:"space-between"}},[e("a-col",[e("a-button",{staticClass:"add-member",attrs:{type:"primary"},on:{click:function(e){t.addRoleModal=!0}}},[t._v("添加成员")]),e("a-tooltip",{model:{value:t.visibleSyncTip,callback:function(e){t.visibleSyncTip=e},expression:"visibleSyncTip"}},[e("template",{slot:"title"},[e("span",[t._v(t._s(t.syncTipText))])]),e("a-button",{staticClass:"sync",staticStyle:{width:"88px"},attrs:{loading:t.loading},on:{click:t.syncMember}},[t._v("同步")])],2),e("span",[t._v("共"+t._s(t.pagination.total)+"个成员")])],1),e("a-col",[e("a-form",{attrs:{layout:"inline"}},[e("a-form-item",{attrs:{label:"角色:"}},[e("a-select",{staticStyle:{width:"200px"},on:{change:t.handleChange},model:{value:t.selectRoleId,callback:function(e){t.selectRoleId=e},expression:"selectRoleId"}},[e("a-select-option",{key:t.allAuth.id,attrs:{value:t.allAuth.id}},[t._v(" "+t._s(t.allAuth.text)+" ")]),t._l(t.roleList,(function(n){return e("a-select-option",{key:n.roleId,attrs:{value:n.roleId}},[t._v(" "+t._s(n.roleName)+" ")])}))],2)],1),e("a-form-item",[e("a-input-search",{attrs:{allowClear:"",placeholder:"请输入成员名称"},on:{search:t.onSearchName},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1)],1)],1)],1),e("div",{staticClass:"role-table"},[e("aside",{staticClass:"aside"},[e("header",[e("h4",[t._v("部门信息")]),t.showDeptInfo?e("div",[e("p",[e("a-icon",{staticStyle:{color:"#1890ff"},attrs:{type:"bell",theme:"filled"}}),t._v(" 若部门数据与企业微信不一致，请检查是否在企业微信将全部部门授权给"+t._s(t.ENTERPRICE_NAME)+" ")],1),e("div",{staticClass:"tips-button"},[e("span",{staticClass:"not-show",on:{click:t.notTips}},[t._v("不再显示")])])]):t._e()]),t.defaultExpandedKeys?e("footer",[e("a-tree",{attrs:{"tree-data":t.departmentList,"show-icon":"",expandedKeys:t.defaultExpandedKeys},on:{expand:t.expand,select:t.selectDepartment},scopedSlots:t._u([{key:"custom",fn:function(t){t.selected;return[e("a-icon",{staticClass:"primaryColor",attrs:{type:"profile"}})]}}],null,!1,2261104438)},[e("a-icon",{staticClass:"primaryColor",attrs:{slot:"switcherIcon",type:"caret-down"},slot:"switcherIcon"}),e("a-icon",{staticClass:"primaryColor",attrs:{slot:"smile",type:"profile"},slot:"smile"}),e("a-icon",{staticClass:"primaryColor",attrs:{slot:"meh",type:"profile"},slot:"meh"})],1)],1):t._e()]),e("a-table",{staticClass:"role-table-list",attrs:{columns:t.columns,"data-source":t.tableList,loading:t.tableLoading,pagination:t.pagination},on:{change:t.change},scopedSlots:t._u([{key:"info",fn:function(n){return e("div",{staticClass:"name-list"},[e("a-avatar",{staticClass:"portrait",attrs:{shape:"square",size:"default",src:n.thumbAvatar}}),e("div",[e("p",[t._v(t._s(n.name))]),e("p",{staticClass:"font-color-black-25"},[t._v("别名："+t._s(n.alias))]),e("p",{staticClass:"font-color-black-25"},[t._v("共"+t._s(n.customerNum)+"个客户")])])],1)}},{key:"status",fn:function(n){return e("div",{},[e("a-icon",{staticStyle:{color:"#52c41a"},attrs:{slot:"smile",type:"smile-o"},slot:"smile"}),t._v(" "+t._s(n)+" ")],1)}},{key:"operation",fn:function(n){return e("div",{},["0"==n.sessionFileType?e("a-tooltip",{attrs:{title:"该成员未开通消息存档"}},[e("a-button",{staticClass:"chat",attrs:{type:"link",disabled:""}},[t._v(" 聊天记录 ")])],1):e("a-button",{staticClass:"chat",attrs:{type:"link"},on:{click:function(e){return t.jump(n.userid,n)}}},[t._v("聊天记录")]),e("a-divider",{attrs:{type:"vertical"}}),e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.setRole(n)}}},[t._v(" 管理权限 ")]),e("a-divider",{attrs:{type:"vertical"}}),e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.$router.push({name:"MemberDetail",query:{id:n.userid}})}}},[t._v(" 成员详情 ")])],1)}}])})],1)],1),e("PurviewSetting",{attrs:{roles:t.roleList,staffId:t.staffId,roleName:t.roleName,selectRoleId:t.selectRoleId},on:{changeRoleId:t.changeRoleId},model:{value:t.visiblePurviewSetting,callback:function(e){t.visiblePurviewSetting=e},expression:"visiblePurviewSetting"}}),e("a-modal",{attrs:{width:"700px",footer:null},model:{value:t.addRoleModal,callback:function(e){t.addRoleModal=e},expression:"addRoleModal"}},[e("AddRoleModal")],1)],1)},a=[],r=n("5530"),s=(n("d3b7"),n("498a"),n("d81d"),n("a15b"),n("02ff")),o=n("0cd2"),l=n("1c9c"),c={name:"Member",components:{PurviewSetting:s["a"],AddRoleModal:o["a"]},data:function(){return{loading:!1,addRoleModal:!1,visiblePurviewSetting:!1,visibleSyncTip:!1,deptId:"",deptOrRole:"role",defaultExpandedKeys:"",selectRoleId:"",staffId:"",roleName:"",syncTipText:"".concat(this.ENTERPRICE_NAME,"会自动同步你在企业微信添加或删除的员工，你也可以点击“同步”按钮手动同步员工，如果同步未成功请联系客服"),roleList:[],searchName:"",pagination:{current:1,pageSize:10,total:0},tableLoading:!1,showDeptInfo:!0,departmentList:[],tableList:[],allAuth:{id:"",text:"全部账号"},columns:[{title:"成员列表",dataIndex:"info",key:"info",scopedSlots:{customRender:"info"}},{title:"所在部门",dataIndex:"department",key:"department"},{title:"角色",dataIndex:"roleName",key:"roleName",ellipsis:!0},{title:"操作",dataIndex:"operation",align:"right",key:"operation",ellipsis:!0,scopedSlots:{customRender:"operation"}}]}},created:function(){this.getRoleList(),this.getDepartment(),this.getTipSession()},methods:{jump:function(t,e){var n={avatar:e.thumbAvatar,name:e.name},i=JSON.stringify(n);sessionStorage.setItem("newsObj",i),this.$router.push({name:"news",query:{staffExtId:t}})},expand:function(t){this.defaultExpandedKeys=t},setRole:function(t){this.visiblePurviewSetting=!0,this.staffId=t.staffId,this.roleName=t.roleName},changeRoleId:function(){this.getStaffList()},getTipSession:function(){this.showDeptInfo="hide"!==sessionStorage.getItem("hideTips")},notTips:function(){this.showDeptInfo=!1,sessionStorage.setItem("hideTips","hide")},getRoleList:function(){var t=this;Object(l["w"])().then((function(e){t.roleList=(null===e||void 0===e?void 0:e.data)||[],t.deptOrRole="role",t.getStaffList()}))},getDepartment:function(){var t=this;Object(l["g"])().then((function(e){var n;(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.length)>0&&(t.departmentList=t.getTreeData(e.data),t.defaultExpandedKeys=[t.departmentList[0].key])})).catch((function(e){t.$message.error(e)}))},selectDepartment:function(t){this.pagination.current=1,this.deptOrRole="dept",this.deptId=t[0],this.getStaffList()},handleChange:function(){this.pagination.current=1,this.deptOrRole="role",this.getStaffList()},syncMember:function(){var t=this;this.syncTipText="正在同步中，可能需要较长时间，请耐心等待，若长时间未同步可",this.visibleSyncTip=!0,this.loading=!0,Object(l["B"])().then((function(e){t.$message.success("同步成功")})).catch((function(e){t.$message.error(e)})).finally((function(){t.syncTipText="".concat(t.ENTERPRICE_NAME,"会自动同步你在企业微信添加或删除的员工，你也可以点击“同步”按钮手动同步员工，如果同步未成功请联系客服"),t.loading=!1,t.visibleSyncTip=!1}))},getStaffList:function(){var t,e=this;this.tableLoading=!0;var n={roleId:this.selectRoleId,deptId:this.deptId,pageNum:this.pagination.current,pageSize:this.pagination.pageSize,name:null===(t=this.searchName)||void 0===t?void 0:t.trim()};Object(l["y"])(n).then((function(t){var n,i;e.disposeTableList(null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.list),e.pagination.total=null===t||void 0===t||null===(i=t.data)||void 0===i?void 0:i.total})).catch((function(t){e.$message.error(t)})).finally((function(){e.tableLoading=!1}))},disposeTableList:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.tableList=t?t.map((function(t,e){var n;return t.info={thumbAvatar:t.thumbAvatar,name:t.name,alias:t.alias,customerNum:t.customerNum},t.department=null===t||void 0===t||null===(n=t.deptName)||void 0===n?void 0:n.join("、"),t.key=t.userid,Object(r["a"])(Object(r["a"])({},t),{},{operation:t})})):[]},onSearchName:function(){var t;this.pagination.current=1,this.searchName=null===(t=this.searchName)||void 0===t?void 0:t.trim(),this.getStaffList()},change:function(t){var e=t.current;this.pagination.current=e,this.getStaffList()},getTreeData:function(t){var e=this;if((null===t||void 0===t?void 0:t.length)>0){var n=t.map((function(t){var n={title:t.name,key:t.wxDepartmentId,slots:{icon:"smile"},children:void 0};return t.children&&(n.children=e.getTreeData(t.children)),n}));return n}}}},d=c,u=(n("04e8"),n("2877")),f=Object(u["a"])(d,i,a,!1,null,"4b1f58f0",null);e["default"]=f.exports},e1b8:function(t,e,n){"use strict";n("c036")}}]);