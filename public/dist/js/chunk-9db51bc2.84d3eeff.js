(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9db51bc2"],{"0fbe":function(t,e,i){"use strict";i("2758")},"1bee":function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"b",(function(){return n}));i("a9e3"),i("ac1f"),i("5319"),i("4d63"),i("25f0");function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss",i=e,a=new Date(Number(t)),s={"M+":a.getMonth()+1,"D+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),"S+":a.getMilliseconds()};for(var n in/(y+)/i.test(i)&&(i=i.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),s)new RegExp("("+n+")").test(i)&&(i=i.replace(RegExp.$1,1===RegExp.$1.length?s[n]:("00"+s[n]).substr((""+s[n]).length)));return i}function s(t){var e=parseInt(t/3600)<10?"0"+parseInt(t/3600):parseInt(t/3600),i=parseInt(t%3600/60)<10?"0"+parseInt(t%3600/60):parseInt(t%3600/60);return e+":"+i}function n(t,e){var i=Date.parse(new Date),a=r(i,t),s=new Date(a),n=s.getTime(),o=r(i,e),l=new Date(o),c=l.getTime();return"start"?n>=c:c<=n}function r(t,e){var i=new Date(t),a=i.getFullYear()+"-",s=(i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1)+"-",n=i.getDate()+" ";i.getHours(),i.getMinutes(),i.getSeconds();return a+s+n+e+":00"}},2758:function(t,e,i){},"342c":function(t,e,i){},"407b":function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return r})),i.d(e,"d",(function(){return o})),i.d(e,"b",(function(){return l})),i.d(e,"e",(function(){return c}));var a=i("b775"),s={memberList:"/risk/messageStorage/showSession",recordList:"/risk/risk/msgmessagerecord/list",groupList:"/risk/risk/msgmessagerecord/groupList",getStaff:"/risk/messageStorage/getStaff",showSessionCustomer:"/risk/messageStorage/showSessionCustomer"};function n(t){return Object(a["b"])({url:s.getStaff,method:"get",params:t})}function r(t){return Object(a["b"])({url:s.memberList,method:"get",params:t})}function o(t){return Object(a["b"])({url:s.recordList,method:"get",params:t})}function l(t){return Object(a["b"])({url:s.groupList,method:"get",params:t})}function c(t){return Object(a["b"])({url:s.showSessionCustomer,method:"get",params:t})}},4535:function(t,e,i){},"487a":function(t,e,i){(function(e,i){t.exports=i()})(0,(function(){"use strict";var t="@@InfiniteScroll",e=function(t,e){var i,a,s,n,r,o=function(){t.apply(n,r),a=i};return function(){if(n=this,r=arguments,i=Date.now(),s&&(clearTimeout(s),s=null),a){var t=e-(i-a);t<0?o():s=setTimeout((function(){o()}),t)}else o()}},i=function(t){return t===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):t.scrollTop},a=document.defaultView.getComputedStyle,s=function(t){var e=t;while(e&&"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType){var i=a(e).overflowY;if("scroll"===i||"auto"===i)return e;e=e.parentNode}return window},n=function(t){return t===window?document.documentElement.clientHeight:t.clientHeight},r=function(t){return t===window?i(window):t.getBoundingClientRect().top+i(window)},o=function(t){var e=t.parentNode;while(e){if("HTML"===e.tagName)return!0;if(11===e.nodeType)return!1;e=e.parentNode}return!1},l=function(){if(!this.binded){this.binded=!0;var t=this,i=t.el,a=i.getAttribute("infinite-scroll-throttle-delay"),n=200;a&&(n=Number(t.vm[a]||a),(isNaN(n)||n<0)&&(n=200)),t.throttleDelay=n,t.scrollEventTarget=s(i),t.scrollListener=e(c.bind(t),t.throttleDelay),t.scrollEventTarget.addEventListener("scroll",t.scrollListener),this.vm.$on("hook:beforeDestroy",(function(){t.scrollEventTarget.removeEventListener("scroll",t.scrollListener)}));var r=i.getAttribute("infinite-scroll-disabled"),o=!1;r&&(this.vm.$watch(r,(function(e){t.disabled=e,!e&&t.immediateCheck&&c.call(t)})),o=Boolean(t.vm[r])),t.disabled=o;var l=i.getAttribute("infinite-scroll-distance"),u=0;l&&(u=Number(t.vm[l]||l),isNaN(u)&&(u=0)),t.distance=u;var d=i.getAttribute("infinite-scroll-immediate-check"),h=!0;d&&(h=Boolean(t.vm[d])),t.immediateCheck=h,h&&c.call(t);var f=i.getAttribute("infinite-scroll-listen-for-event");f&&t.vm.$on(f,(function(){c.call(t)}))}},c=function(t){var e=this.scrollEventTarget,a=this.el,s=this.distance;if(!0===t||!this.disabled){var o=i(e),l=o+n(e),c=!1;if(e===a)c=e.scrollHeight-l<=s;else{var u=r(a)-r(e)+a.offsetHeight+o;c=l+s>=u}c&&this.expression&&this.expression()}},u={bind:function(e,i,a){e[t]={el:e,vm:a.context,expression:i.value};var s=arguments;e[t].vm.$on("hook:mounted",(function(){e[t].vm.$nextTick((function(){o(e)&&l.call(e[t],s),e[t].bindTryCount=0;var i=function i(){e[t].bindTryCount>10||(e[t].bindTryCount++,o(e)?l.call(e[t],s):setTimeout(i,50))};i()}))}))},unbind:function(e){e&&e[t]&&e[t].scrollEventTarget&&e[t].scrollEventTarget.removeEventListener("scroll",e[t].scrollListener)}},d=function(t){t.directive("InfiniteScroll",u)};return window.Vue&&(window.infiniteScroll=u,Vue.use(d)),u.install=d,u}))},"618a":function(t,e,i){"use strict";i("4535")},"625e5":function(t,e,i){"use strict";i("342c")},"66ca":function(t,e,i){"use strict";i("99c6")},7183:function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"d",(function(){return r})),i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return l}));var a=i("b775"),s={getTagGroup:"/client_manager/CustomerTag/getTagGroup",syncTagGroup:"/client_manager/CustomerTag/syncTagGroup",addOrEditTagGroup:"/client_manager/CustomerTag/addOrEditTagGroup",delTagGroup:"/client_manager/CustomerTag/delTagGroup"};function n(t){return Object(a["b"])({url:s.getTagGroup,method:"post",data:t})}function r(t){return Object(a["b"])({url:s.syncTagGroup,method:"post",data:t})}function o(t){return Object(a["b"])({url:s.addOrEditTagGroup,method:"post",data:t})}function l(t){return Object(a["b"])({url:s.delTagGroup,method:"post",data:t})}},"8d04":function(t,e,i){},"99c6":function(t,e,i){},a228:function(t,e,i){},a729:function(t,e,i){"use strict";i("8d04")},b105:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-wrapper"},[e("div",{attrs:{id:"page-content"}},[e("section",{staticClass:"keyword-top"},[e("div",{staticClass:"top-box"},[e("span",{staticClass:"tips"},[t._v("全部关键词")]),e("ul",{staticClass:"keyword-list"},[e("TagComponents",{attrs:{clear:t.a},on:{calBtnCallback:t.calBtnCallback}})],1),e("span",{staticClass:"clickable",on:{click:function(e){return t.edit(t.a)}}},[e("span",[e("a-icon",{attrs:{type:"edit"}})],1),t._v(" 编辑 ")])])]),e("section",{staticClass:"remind-content ant-card page-box"},[e("a-tabs",{style:{background:"#fff",padding:"0 24px"},on:{change:t.callback},model:{value:t.keyValue,callback:function(e){t.keyValue=e},expression:"keyValue"}},[e("a-tab-pane",{key:"1",attrs:{tab:"私聊"}},[e("PrivateChat",{attrs:{keyValue:t.keyValue}})],1),e("a-tab-pane",{key:"2",attrs:{tab:"群聊","force-render":""}},[e("groupChat",{attrs:{keyValue:t.keyValue}})],1)],1)],1)])])},s=[],n=function(){var t=this,e=t._self._c;return e("div",[e("a-button",{staticClass:"add-tag-button",attrs:{size:"small"},on:{click:t.showInput}},[e("a-icon",{attrs:{type:"plus"}}),t._v("添加关键词")],1),t.inputVisible?e("a-input",{ref:"input",style:{width:"120px"},attrs:{type:"text",size:"small",inputVisible:"false"},on:{blur:t.handleInputConfirm,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm.apply(null,arguments)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):t._e(),e("a-tag",{class:["全部"==t.activefun?"active":"tagkeyword"],on:{click:function(e){return t.selected("全部")}}},[t._v("全部")]),t._l(t.tagslist,(function(i,a){return[e("a-tag",{key:a,class:[t.activefun==i.keyName?"active":"tagkeyword"],attrs:{closable:t.clear},on:{click:function(e){return t.selected(i.keyName)},close:function(e){return t.closelog(i.id)}}},[t._v(" "+t._s(i.keyName)+" ")])]})),e("div",{directives:[{name:"show",rawName:"v-show",value:t.clear,expression:"clear"}],staticClass:"setting-btn-box"},[e("a-button",{on:{click:t.calBtn}},[t._v("取消")]),e("a-button",{attrs:{type:"primary"},on:{click:t.okBtn}},[t._v("确认")])],1)],2)},r=[],o=(i("498a"),i("a15b"),i("7183"),i("b775")),l={privateList:"/risk/risk/msgrecordviolation/list",grouplist:"/risk/risk/msgrecordviolation/grouplist",cruxList:"/risk/risk/msgviolationkey/list",save:"/risk/risk/msgviolationkey/save",deleteCux:"/risk/risk/msgviolationkey/delete",customList:"/enterprise/staff/get"};function c(t){return Object(o["b"])({url:l.customList,method:"get",params:t})}function u(t){return Object(o["b"])({url:l.save,method:"post",data:t})}function d(t){return Object(o["b"])({url:l.privateList,method:"post",params:t})}function h(t){return Object(o["b"])({url:l.grouplist,method:"post",params:t})}function f(t){return Object(o["b"])({url:l.cruxList,method:"post",params:t})}function p(t){return Object(o["b"])({url:l.deleteCux,method:"post",params:t})}var m={data:function(){return{inputVisible:!1,inputValue:"",index:"",activefun:"全部",tagslist:[],deleteId:[]}},props:{clear:{type:Boolean,default:!1}},created:function(){this.getCruxList()},methods:{showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},cancle:function(){this.inputValue="",this.inputVisible=!1},handleInputConfirm:function(){var t=this,e=this.inputValue.trim();if(!e)return this.inputValue="",void(this.inputVisible=!1);u({keyName:this.inputValue}).then((function(e){t.inputValue="",t.inputVisible=!1,t.getCruxList()})).catch((function(e){t.$message.error(e)}))},getCruxList:function(){var t=this;this.tagslist=[],f().then((function(e){t.tagslist=e.data})).catch((function(e){t.$message.error(e)}))},selected:function(t){if(!this.clear){this.activefun=t;var e=t;"全部"==t&&(e=""),this.$store.commit("SET_KEYNAME",e)}},closelog:function(t){this.deleteId.push(t)},calBtn:function(){this.getCruxList(),this.$emit("calBtnCallback")},okBtn:function(){var t=this;if(this.deleteId.length<=0)this.$message.warning("请先删除关键词");else{var e=this.deleteId.join(",");p({ids:e}).then((function(e){t.getCruxList(),t.$emit("calBtnCallback")})).catch((function(e){t.$message.error(e)}))}}}},g=m,v=(i("625e5"),i("2877")),b=Object(v["a"])(g,n,r,!1,null,"ad6645c8",null),w=b.exports,y=function(){var t=this,e=t._self._c;return e("div",[e("section",{attrs:{id:"supervision-header"},on:{click:t.hidebox}},[e("div",{staticClass:"justify"},[e("div",{staticClass:"left flex-row"},[e("span",{staticClass:"flex-row"},[e("span",[t._v("部门：")]),e("TreeSelect",{attrs:{nameVal:t.nameVal,treeData:t.treeData},on:{selectDepartment:t.selectDepartment}}),e("span",{staticStyle:{"margin-right":"24px"}}),e("span",[t._v("账号：")]),e("a-select",{staticStyle:{width:"220px"},attrs:{open:t.isOpen},on:{focus:function(e){t.isOpen=!0},blur:t.groupBlur,change:t.serviceChange},model:{value:t.serviceList,callback:function(e){t.serviceList=e},expression:"serviceList"}},[e("div",{staticClass:"transfer",attrs:{slot:"dropdownRender"},slot:"dropdownRender"},[e("StaffList",{attrs:{title:"账号",depId:t.depId,type:"Staff"},on:{isNoHide:t.isNoHide,closeopencustomer:t.closeopencustomer,changeshow:t.changeshow,allopencustomer:t.allopencustomer}})],1)])],1),e("span",{staticStyle:{"margin-right":"24px"}}),e("span",[t._v("选择时间：")]),e("a-range-picker",{staticStyle:{width:"230px"},attrs:{"disabled-date":t.disabledDate,value:t.showAddDateTime},on:{change:t.changeAddDate}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1)],1),e("div",{staticClass:"reset-btn"},[e("a-button",{on:{click:t.reset}},[t._v("重置")])],1)])]),e("section",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"remind-scroll",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.msg_list.length>0?e("ul",{staticClass:"message-list"},t._l(t.msg_list,(function(i,a){return e("li",{key:a},[e("p",{staticClass:"message-top"},[e("span",[e("a-avatar",{staticStyle:{"margin-right":"4px"},attrs:{size:16,src:i.toUrl,shape:"square"}}),t._v(" "+t._s(i.toName)+" 与【"+t._s(i.fromName)+"】的聊天")],1),e("span",[t._v(t._s(t.timedateformat(i.msgTime)))])]),e("div",{staticClass:"message-content"},[e("span",{staticClass:"message-span"},[e("a-avatar",{staticStyle:{"margin-right":"13px"},attrs:{size:42,src:i.fromUrl,shape:"square"}}),e("span",{staticClass:"msg-content"},[e("p",{staticStyle:{height:"21px"}},[t._v(t._s(i.fromName))]),e("p",{staticClass:"keyword-content",domProps:{innerHTML:t._s(t.brightenKeyword(i.context,t.keyName))}})])],1),e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.seeView(i)}}},[t._v("查看")])],1)])})),0):e("a-empty",{staticClass:"empty"})],1),e("a-modal",{attrs:{footer:null,centered:"",width:"709px"},model:{value:t.visibleTree,callback:function(e){t.visibleTree=e},expression:"visibleTree"}},[e("GroupViewChatDetaied",{attrs:{obj:t.obj}})],1)],1)},_=[],C=i("2909"),x=i("5530"),k=(i("b0c0"),i("99af"),i("d3b7"),i("159b"),i("ac1f"),i("5319"),i("4d63"),i("25f0"),i("d81d"),i("1eb1")),T=i("487a"),S=i.n(T),I=(i("a4d3"),i("e01a"),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"dialog-chat-record-list"},[e("div",{staticClass:"group-chat-title"},[e("div",{staticClass:"group-chat-name"},[t._v(t._s(t.infoobj.name))]),e("div",{staticStyle:{color:"rgba(0, 0, 0, 0.45)","font-size":"12px"}},[t._v("对方已同意存档会话内容")])]),e("div",{staticClass:"chat-message-box search-msg-list"},[e("ul",{staticClass:"msg-list"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.loadingTop,expression:"loadingTop"}],staticClass:"loading loading-top"},[e("a-spin")],1),"0"==t.infoobj.isGroup?e("div",[t.msg_list.length>0?e("div",t._l(t.msg_list,(function(i,a){return e("li",{key:a,class:[i.TOLIST==t.staffId?"send":"receive","msg-li"]},[i.content?e("div",[e("span",{directives:[{name:"show",rawName:"v-show",value:i.time,expression:"item.time"}],staticClass:"time-mark"},[t._v(t._s(i.time))]),e("div",{staticClass:"inner flex-row"},[i.TOLIST==t.staffId?e("a-avatar",{attrs:{size:36,src:t.user.avatar||t.defaultThumbAvatar,shape:"square"}}):e("a-avatar",{attrs:{size:36,src:t.avatar,shape:"square"}}),e("div",{staticClass:"content-wrap flex-col"},[e("div",{staticClass:"content flex-row"},[i.content.content?e("span",{staticClass:"text bubble"},[t._v(t._s(i.content.content))]):t._e(),"image"==i.MSGTYPE?e("img",{staticClass:"img",attrs:{src:"https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/".concat(i.MEDIA_PATH),alt:""},on:{click:function(e){return t.bgImgShow("https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/".concat(i.MEDIA_PATH))}}}):t._e(),i.content.displayname?e("div",{staticClass:"weapp bubble flex-col align-left",on:{click:t.tipwarining}},[e("span",{staticClass:"weapp-name"},[t._v(t._s(i.content.displayname))]),e("span",{staticClass:"title"},[t._v(t._s(i.content.title))]),e("span",{staticClass:"desc"},[t._v(t._s(i.content.description))]),e("footer",[e("span",{staticClass:"icon-wrap"},[e("a-icon",{attrs:{type:"link"}})],1),t._v(" 小程序 ")])]):t._e()])])],1)]):t._e()])})),0):e("div",{staticClass:"empty"},[e("a-empty")],1)]):e("div",[t.msg_list.length>0?e("div",t._l(t.msg_list,(function(i,a){return e("li",{key:a,class:[i.user?"receive":"send","msg-li"]},[i.content?e("div",[e("span",{directives:[{name:"show",rawName:"v-show",value:i.time,expression:"item.time"}],staticClass:"time-mark"},[t._v(t._s(i.time))]),e("div",{staticClass:"inner flex-row"},[i.user?e("a-avatar",{attrs:{size:36,src:i.user.avatar,shape:"square"}}):e("a-avatar",{attrs:{size:36,src:t.avatar,shape:"square"}}),e("div",{staticClass:"content-wrap flex-col"},[e("div",{staticClass:"content flex-row"},[i.content.content?e("span",{staticClass:"text bubble"},[t._v(t._s(i.content.content))]):t._e(),"image"==i.MSGTYPE?e("img",{staticClass:"img",attrs:{src:"https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/".concat(i.MEDIA_PATH),alt:""},on:{click:function(e){return t.bgImgShow("https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/".concat(i.MEDIA_PATH))}}}):t._e(),i.content.displayname?e("div",{staticClass:"weapp bubble flex-col align-left",on:{click:t.tipwarining}},[e("span",{staticClass:"weapp-name"},[t._v(t._s(i.content.displayname))]),e("span",{staticClass:"title"},[t._v(t._s(i.content.title))]),e("span",{staticClass:"desc"},[t._v(t._s(i.content.description))]),e("footer",[e("span",{staticClass:"icon-wrap"},[e("a-icon",{attrs:{type:"link"}})],1),t._v(" 小程序 ")])]):t._e()])])],1)]):t._e()])})),0):e("div",{staticClass:"empty"},[e("a-empty")],1)])])])])])}),L=[],O=i("407b"),D=i("1bee"),j=i("2f62"),N={props:{obj:{type:Object,default:function(){}}},data:function(){return{defaultThumbAvatar:i("b5c3"),msg_list:[],user:{},infoobj:this.obj,loadingTop:!1,timeList:[],staffId:this.obj.staffId}},created:function(){this.obj.staffId&&this.getRecordList(),this.avatar=this.info.avatar||""},methods:{bgImgShow:function(t){this.bgImg=t,this.visible=!0},tipwarining:function(){this.$message.warning("由于企业微信的限制，暂时不支持打开小程序消息")},getRecordList:function(){var t,e=this;this.loadingTop=!0,"0"==this.infoobj.isGroup?(t={staffId:this.infoobj.staffId,userId:this.infoobj.userId,seq:this.infoobj.seq+1,limit:"40"},Object(O["d"])(t).then((function(t){var i,a=[];t.data.list&&(a=t.data.list.reverse()),e.disposeClientList(a);var s=Object(x["a"])({avatar:(null===(i=t.data.user)||void 0===i?void 0:i.avatar)||""},t.data.user);e.user=s})).finally((function(){e.loadingTop=!1}))):(t={roomid:this.infoobj.roomid,seq:this.infoobj.seq+1,context:this.context,limit:"40"},Object(O["b"])(t).then((function(t){var i=[];t.data&&(i=t.data.reverse()),e.disposeClientList(i),e.user=t.data.user})).finally((function(){e.loadingTop=!1})))},disposeClientList:function(t){this.msg_list=t.map((function(t){var e=t.MSGDATA,i=Object(D["a"])(t.MSGTIME,"MM-DD"),a=/^['|"](.*)['|"]$/;try{var s=t.MSGDATA.replace(a,"$1");e=JSON.parse(s)}catch(n){e=""}return t.content=e,t.time=i,Object.assign({},t)}));var e=this.removalRepeat(this.msg_list);this.msg_list=e.map((function(t){return Object.assign({},t)}))},removalRepeat:function(t){for(var e=[],i={},a=0;a<t.length;a++)i[t[a].time]?(t[a].time="",e.push(t[a])):(e.push(t[a]),i[t[a].time]=!0);return e}},computed:Object(x["a"])({},Object(j["c"])({info:function(t){return t.user.info}})),watch:{obj:{handler:function(t,e){this.infoobj=t,this.getRecordList()}}}},G=N,V=(i("618a"),Object(v["a"])(G,I,L,!1,null,"66584434",null)),A=V.exports,z=function(){var t=this,e=t._self._c;return e("div",[e("a-col",[e("a-tree-select",{staticStyle:{width:"182px"},attrs:{"show-search":"","dropdown-style":{maxHeight:"400px",overflow:"auto"},"tree-data":t.treeData,"tree-default-expand-all":"",allowClear:t.allowClear,"search-placeholder":"请输入账号后回车",multiple:t.multiple},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1)},$=[],E={data:function(){return{value:this.device,allowClear:!1,multiple:this.multiplevalue}},watch:{value:function(t){this.$emit("selectDepartment",t),void 0===t?this.value=this.device:t===this.device?this.allowClear=!1:this.allowClear=!0}},props:{treeData:{typeof:Array,default:[]},multiplevalue:{typeof:Boolean,default:!1},device:{typeof:String,default:"全部部门"}}},P=E,M=Object(v["a"])(P,z,$,!1,null,null,null),B=M.exports,H=function(){var t=this,e=t._self._c;return e("div",[e("a-col",[e("a-tree-select",{staticStyle:{width:"182px"},attrs:{a:t.nameVal,"dropdown-style":{maxHeight:"300px",overflow:"auto"},"tree-data":t.treeData,"tree-default-expand-all":"",allowClear:t.allowClear},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)],1)},Y=[],q={props:{nameVal:{type:String,default:"全部部门"},treeData:{type:Array,default:function(){return[]}}},data:function(){return{value:this.nameVal,allowClear:!1}},watch:{value:function(t){this.$emit("selectDepartment",t),void 0===t?this.value="全部部门":this.allowClear="全部部门"!==t},nameVal:{handler:function(t,e){this.value=t}}}},R=q,K=Object(v["a"])(R,H,Y,!1,null,null,null),J=K.exports,U=i("1c9c"),F=function(){var t=this,e=t._self._c;return e("div",{staticClass:"groupbox"},[e("div",{staticClass:"title"},[t._v(" 全部"+t._s(t.title)+" ("+t._s(t.staffdata.length)+") ")]),e("div",{staticClass:"search-box"},[e("a-input-search",{attrs:{allowClear:"",placeholder:"请输入".concat(t.title,"名称")},on:{blur:t.blursearch,focus:t.searchClick,search:t.onSearchGroupleader,pressEnter:t.onSearchGroupleader},model:{value:t.searchGroupleader,callback:function(e){t.searchGroupleader=e},expression:"searchGroupleader"}})],1),e("div",{staticClass:"list-wrap"},[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.allemployees,expression:"allemployees"}],staticClass:"demo-infinite-container",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[e("a-list",[e("div",{staticClass:"list-item"},[e("div",{staticClass:"item-content",on:{click:function(e){return t.allGroup(t.staffdata)}}},[e("img",{staticClass:"avatar",attrs:{src:i("b5c3")}}),e("span",{staticClass:"name"},[t._v("全部"+t._s(t.title))])])])]),t.staffdata.length>0?e("a-list",{attrs:{"data-source":t.staffdata},scopedSlots:t._u([{key:"renderItem",fn:function(i,a){return e("div",{key:a,staticClass:"list-item",on:{click:function(e){return t.choiceGroup(i)}}},[e("div",{staticClass:"item-content"},[e("img",{staticClass:"avatar",attrs:{src:i.thumbAvatar||t.defaultThumbAvatar,alt:""}}),e("span",{staticClass:"name"},[t._v(t._s(i.name||i.groupName))])])])}}],null,!1,4278074467)}):e("div",{staticClass:"cter"},[t._v("没有更多相关"+t._s(t.title)+"哦~~")])],1)])])},Q=[],W=(i("a9e3"),i("ccdf")),X={directives:{infiniteScroll:S.a},props:{type:{type:String,default:"Staff"},depId:{type:Number,default:void 0},title:{type:String,default:"员工"}},data:function(){return{defaultThumbAvatar:i("b5c3"),staffdata:[],defalytStaffIndex:"",deptId:this.depId||void 0,searchGroupleader:"",loading:!1,busy:!1,page:1,limit:10}},created:function(){},methods:{searchClick:function(){this.$emit("isNoHide","1")},blursearch:function(){this.$emit("isNoHide","2")},allemployees:function(){var t=this;switch(this.type){case"Staff":var e={currentPage:this.page,pageSize:this.limit,name:this.searchGroupleader||""};if(this.loading=!0,"0"!=this.total&&this.staffdata.length>=this.total)return void(this.busy=!0);c(e).then((function(e){e.data.list.map((function(t){t.flag=!1}));var i=e.data.list;t.total=e.data.total,t.staffdata.length>=t.total?t.busy=!0:(t.page>1?t.staffdata=[].concat(Object(C["a"])(t.staffdata),Object(C["a"])(i)):t.staffdata=Object(C["a"])(i),t.page=t.page+1,t.loading=!1)}));break;case"group":Object(W["h"])({ownerName:this.searchGroupleader||""}).then((function(e){t.staffdata=e.data||[]}));break}},onSearchGroupleader:function(){this.$emit("isNoHide","6"),this.page=1,this.staffdata=[],this.allemployees()},choiceGroup:function(t){this.defalytStaffIndex=t.userid||t.groupId,"Staff"==this.type?this.$emit("closeopencustomer",t):this.$emit("closeopenGroup",t)},allGroup:function(t){"Staff"==this.type?this.$emit("allopencustomer",t):this.$emit("allopengroup",t)}},watch:{depId:{handler:function(t,e){this.deptId=t,this.allemployees()}}}},Z=X,tt=(i("0fbe"),Object(v["a"])(Z,F,Q,!1,null,"78806b7f",null)),et=tt.exports,it={directives:{infiniteScroll:S.a},data:function(){return{flagBox:"0",obj:{},depId:void 0,flag:!1,isOpen:!1,treeData:[],serviceList:"全部账号",nameVal:"全部部门",wxDepId:"",showAddDateTime:null,visibleTree:!1,pageSize:1,totalPage:0,loading:!1,busy:!1,keyword:"",msg_list:[]}},created:function(){this.staffId="",this.getPrivateList(),this.getDepartment()},computed:Object(x["a"])({},Object(j["c"])({keyName:function(t){return t.customer.keyName},info:function(t){return t.user.info}})),methods:{hidebox:function(){"0"==this.flagBox&&this.flag&&(this.isOpen=!1)},isNoHide:function(t){"1"==t?this.flagBox="1":"2"==t||"0"==t?this.flagBox="0":(t="6")&&(this.flagBox="0",this.flag=!0)},groupBlur:function(){"0"==this.flagBox&&(this.isOpen=!1,this.flag=!1)},seeView:function(t){var e=t.toId,i=t.fromId,a=0,s=t.seq,n=t.fromName;this.obj={staffId:e,userId:i,seq:s,isGroup:a,name:n},this.visibleTree=!0},changeshow:function(){this.flag=!0},closeopencustomer:function(t){this.isOpen=!1,this.staffId=t.userid,this.flag=!1,this.serviceList=t.name,this.pageSize=1,this.msg_list=[],this.getPrivateList()},allopencustomer:function(){this.isOpen=!1,this.staffId=void 0,this.serviceList="全部账号",this.pageSize=1,this.msg_list=[],this.getPrivateList()},serviceChange:function(t){t.length<=0&&(this.staffId=void 0)},selectDepartment:function(t){"全部部门"!=t&&"全部部门 "!=t||(t=void 0),this.depId=t,this.pageSize=1,this.msg_list=[],this.getPrivateList()},reset:function(){this.isOpen=!1,this.staffId=void 0,this.serviceList="全部账号",this.showAddDateTime=null,this.nameVal="全部部门 ",this.depId=void 0,this.startTime=void 0,this.endTime=void 0,this.pageSize=1,this.msg_list=[],this.getPrivateList()},changeAddDate:function(t,e){if(this.showAddDateTime=t,e[0]){var i=e[0]+" 00:00:00",a=e[1]+" 23:59:59.999";this.startTime=this.$moment(i).format("x"),this.endTime=this.$moment(a).format("x"),this.pageSize=1}else this.startTime=void 0,this.endTime=void 0,this.pageSize=1;this.msg_list=[],this.getPrivateList()},timedateformat:function(t){return Object(D["a"])(t,"YYYY-MM-DD hh:mm:ss")},handleInfiniteOnLoad:function(){if(this.loading=!0,this.msg_list.length>=this.totalPage)return this.busy=!0,void(this.loading=!1);this.getPrivateList()},getPrivateList:function(){var t=this,e={offset:this.pageSize,limit:10,start_time:this.startTime,end_time:this.endTime,keyName:this.keyName,dep_id:this.depId,staff_id:this.staffId};d(e).then((function(e){t.loading=!1;var i=e.data.list;t.pageSize>1?t.msg_list=[].concat(Object(C["a"])(t.msg_list),Object(C["a"])(i)):t.msg_list=Object(C["a"])(i),t.totalPage=e.data.totalCount,t.pageSize=t.pageSize+1})).catch((function(e){t.$message.error(e)}))},onSearch:function(t){},disabledDate:function(t){return t&&t>Date.now()},brightenKeyword:function(t,e){var i=t;if(e){if(e.length>0){var a=e.split("");i+="",a.forEach((function(t){-1!==i.indexOf(t)&&""!==t&&(i=i.replace(new RegExp(t,"g"),"<em>"+t+"</em>"))}))}return i}return i},getDepartment:function(){var t=this;Object(U["g"])().then((function(e){var i;(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.length)>0&&(t.treeData=t.getTreeData(e.data))})).catch((function(e){t.$message.error(e)}))},getTreeData:function(t){var e=this;if((null===t||void 0===t?void 0:t.length)>0){var i=t.map((function(t){var i={title:t.name,key:t.wxDepartmentId,value:t.wxDepartmentId,slots:{icon:"smile"},children:void 0};return t.children&&(i.children=e.getTreeData(t.children)),i}));return i}}},components:{TreeSelect:J,GroupViewChatDetaied:A,SelectSearch:B,AddTransfer:k["a"],StaffList:et},props:{keyValue:{type:String,default:"1"}},watch:{keyName:function(){"1"==this.keyValue&&(this.pageSize=1,this.msg_list=[],setTimeout(this.getPrivateList,0))}}},at=it,st=(i("f79f"),Object(v["a"])(at,y,_,!1,null,"50624960",null)),nt=st.exports,rt=function(){var t=this,e=t._self._c;return e("div",[e("section",{attrs:{id:"supervision-header"},on:{click:t.hidebox}},[e("div",{staticClass:"justify"},[e("div",{staticClass:"left flex-row"},[e("span",{staticClass:"flex-row"},[e("span",[t._v("群名称：")]),e("a-input-search",{staticStyle:{width:"200px"},attrs:{allowClear:"",placeholder:"请输入要搜索的群名称"},on:{search:t.onSearchName,pressEnter:t.onSearchName},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}}),e("span",{staticStyle:{"margin-right":"24px"}}),e("span",[t._v("群主：")]),e("a-select",{staticStyle:{width:"220px"},attrs:{open:t.isOpen},on:{focus:function(e){t.isOpen=!0},change:t.serviceChange,blur:t.groupBlur},model:{value:t.serviceList,callback:function(e){t.serviceList=e},expression:"serviceList"}},[e("div",{staticClass:"transfer",attrs:{slot:"dropdownRender"},slot:"dropdownRender"},[e("StaffList",{attrs:{title:"群主",type:"group"},on:{isNoHide:t.isNoHide,closeopenGroup:t.closeopenGroup,changeshow:t.changeshow,allopengroup:t.allopengroup}})],1)])],1),e("span",{staticStyle:{"margin-right":"24px"}}),e("span",[t._v("选择时间：")]),e("a-range-picker",{staticStyle:{width:"230px"},attrs:{"disabled-date":t.disabledDate,value:t.showAddDateTime},on:{change:t.changeAddDate}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1)],1),e("div",{staticClass:"reset-btn"},[e("a-button",{on:{click:t.reset}},[t._v("重置")])],1)])]),e("section",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"remind-scroll",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.msg_list.length>0?e("ul",{staticClass:"message-list"},t._l(t.msg_list,(function(i,a){return e("li",{key:a},[e("p",{staticClass:"message-top"},[e("span",[e("a-avatar",{staticStyle:{"margin-right":"4px"},attrs:{size:16,src:t.defaultThumbAvatar,shape:"square"}}),t._v(" 【"+t._s(i.groupName)+"】"),e("span",{staticClass:"part-line"},[t._v(" | ")]),t._v(" 群主： "),e("a-avatar",{staticStyle:{"margin-right":"4px"},attrs:{size:16,src:t.defaultThumbAvatar,shape:"square"}}),t._v(t._s("null"!=i.ownerName?"".concat(i.ownerName):"外部群群主"))],1),e("span",[t._v(t._s(t.timedateformat(i.msgTime)))])]),e("div",{staticClass:"message-content"},[e("span",{staticClass:"message-span"},[e("a-avatar",{staticStyle:{"margin-right":"13px"},attrs:{size:42,src:i.fromUrl||t.defaultThumbAvatar,shape:"square"}}),e("span",{staticClass:"msg-content"},[e("p",{staticStyle:{height:"21px"}},[t._v(t._s(i.fromName))]),e("p",{staticClass:"keyword-content",domProps:{innerHTML:t._s(t.brightenKeyword(i.context,t.keyName))}})])],1),e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.seeView(i)}}},[t._v("查看")])],1)])})),0):e("a-empty",{staticClass:"empty"})],1),e("a-modal",{attrs:{footer:null,centered:"",width:"709px"},model:{value:t.visibleTree,callback:function(e){t.visibleTree=e},expression:"visibleTree"}},[e("GroupViewChatDetaied",{attrs:{obj:t.obj}})],1)],1)},ot=[],lt={directives:{infiniteScroll:S.a},data:function(){return{flagBox:"0",defaultThumbAvatar:i("b5c3"),isOpen:!1,obj:{},searchName:"",depId:void 0,flag:!1,treeData:[],serviceList:"全部群主",nameVal:"全部部门",wxDepId:"",showAddDateTime:null,visibleTree:!1,pageSize:1,totalPage:0,loading:!1,busy:!1,keyword:"",msg_list:[]}},created:function(){this.staffId=this.info.userid||"wangwei",this.getPrivateGroupList()},computed:Object(x["a"])({},Object(j["c"])({keyName:function(t){return t.customer.keyName},info:function(t){return t.user.info}})),methods:{hidebox:function(){"0"==this.flagBox&&this.flag&&(this.isOpen=!1)},isNoHide:function(t){"1"==t?this.flagBox="1":"2"==t||"0"==t?this.flagBox="0":(t="6")&&(this.flagBox="0",this.flag=!0)},groupBlur:function(){"0"==this.flagBox&&(this.isOpen=!1,this.flag=!1)},tipwarining:function(){this.$message.warning("由于企业微信的限制，暂时不支持打开小程序消息")},serviceChange:function(){},closeopenGroup:function(t){this.isOpen=!1,this.groupLeader=t.userid,this.serviceList=t.name,this.pageSize=1,this.msg_list=[],this.getPrivateGroupList()},allopengroup:function(){this.isOpen=!1,this.groupLeader=void 0,this.serviceList="全部群主",this.flag=!1,this.pageSize=1,this.msg_list=[],this.getPrivateGroupList()},onSearchName:function(){this.pageSize=1,this.msg_list=[],this.getPrivateGroupList()},seeView:function(t){var e=t.toId,i=t.fromId,a=t.seq,s=t.roomId,n=1,r=t.groupName;this.obj={staffId:e,userId:i,seq:a,isGroup:n,roomid:s,name:r},this.visibleTree=!0},changeshow:function(){this.flag=!0},selectDepartment:function(t){"全部部门"!=t&&"全部部门 "!=t||(t=void 0),this.depId=t,this.pageSize=1,this.msg_list=[],this.getPrivateGroupList()},reset:function(){this.searchName="",this.staffId=void 0,this.showAddDateTime=null,this.groupLeader=void 0,this.serviceList="全部账号",this.nameVal="全部部门 ",this.depId=void 0,this.startTime=void 0,this.endTime=void 0,this.pageSize=1,this.msg_list=[],this.getPrivateGroupList()},changeAddDate:function(t,e){if(this.showAddDateTime=t,e[0]){var i=e[0]+" 00:00:00",a=e[1]+" 23:59:59.999";this.startTime=this.$moment(i).format("x"),this.endTime=this.$moment(a).format("x")}else this.startTime=void 0,this.endTime=void 0;this.pageSize=1,this.msg_list=[],this.getPrivateGroupList()},timedateformat:function(t){return Object(D["a"])(t,"YYYY-MM-DD hh:mm:ss")},handleInfiniteOnLoad:function(){if(this.loading=!0,this.msg_list.length>=this.totalPage)return this.busy=!0,void(this.loading=!1);this.getPrivateGroupList()},getPrivateGroupList:function(){var t=this,e={offset:this.pageSize,limit:10,keyName:this.keyName,start_time:this.startTime,end_time:this.endTime,groupName:this.searchName,groupLeader:this.groupLeader};h(e).then((function(e){t.loading=!1;var i=e.data.list;t.pageSize>1?t.msg_list=[].concat(Object(C["a"])(t.msg_list),Object(C["a"])(i)):t.msg_list=Object(C["a"])(i),t.totalPage=e.data.totalCount,t.pageSize=t.pageSize+1})).catch((function(e){t.$message.error(e)}))},onSearch:function(t){},disabledDate:function(t){return t&&t>Date.now()},brightenKeyword:function(t,e){var i=t;if(e){if(e.length>0){var a=e.split("");i+="",a.forEach((function(t){-1!==i.indexOf(t)&&""!==t&&(i=i.replace(new RegExp(t,"g"),"<em>"+t+"</em>"))}))}return i}return i},getDepartment:function(){var t=this;Object(U["g"])().then((function(e){var i;(null===e||void 0===e||null===(i=e.data)||void 0===i?void 0:i.length)>0&&(t.treeData=t.getTreeData(e.data))})).catch((function(e){t.$message.error(e)}))},getTreeData:function(t){var e=this;if((null===t||void 0===t?void 0:t.length)>0){var i=t.map((function(t){var i={title:t.name,key:t.wxDepartmentId,value:t.wxDepartmentId,slots:{icon:"smile"},children:void 0};return t.children&&(i.children=e.getTreeData(t.children)),i}));return i}}},watch:{keyName:function(){"2"==this.keyValue&&(this.pageSize=1,this.msg_list=[],setTimeout(this.getPrivateGroupList,0))}},components:{TreeSelect:J,GroupViewChatDetaied:A,SelectSearch:B,AddTransfer:k["a"],StaffList:et},props:{keyValue:{type:String,default:"1"}}},ct=lt,ut=(i("66ca"),Object(v["a"])(ct,rt,ot,!1,null,"6b0c62d1",null)),dt=ut.exports,ht={data:function(){return{a:!1,keyValue:"1",tagslist:[]}},created:function(){},methods:{callback:function(t){},calBtnCallback:function(){this.a=!1},edit:function(t){this.a=1!=t}},components:{TagComponents:w,PrivateChat:nt,groupChat:dt}},ft=ht,pt=(i("a729"),Object(v["a"])(ft,a,s,!1,null,"0e302080",null));e["default"]=pt.exports},b5c3:function(t,e,i){t.exports=i.p+"assets/default.c42b7ede.svg"},f79f:function(t,e,i){"use strict";i("a228")}}]);