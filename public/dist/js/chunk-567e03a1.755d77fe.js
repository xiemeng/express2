(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-567e03a1"],{"0917":function(t,e,a){"use strict";a("4c9b")},"0b8e":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"aks-person",on:{click:function(e){return t.$emit("open")}}},[e("div",{staticClass:"flex-row"},[t._l(t.usePersionList,(function(a,i){return e("a-tag",{key:a.key},[t._v(t._s(a.tagName)+" "),e("a-icon",{attrs:{type:"close"},on:{click:function(e){return e.stopPropagation(),function(){return t.closeTag(i)}.apply(null,arguments)}}})],1)})),t.usePersionList.length<1?e("p",[t._v(t._s(t.placeHolder))]):t._e()],2),e("a-icon",{attrs:{type:"caret-down"}})],1)},n=[],s=(a("a434"),{name:"SelectInput",model:{prop:"usePersionList",event:"change"},props:{usePersionList:{type:[Array],default:function(){return[]}},placeHolder:{type:[String],default:""}},methods:{closeTag:function(t){this.usePersionList.splice(t,1),this.$emit("change",this.usePersionList)}}}),r=s,c=(a("90aa"),a("2877")),o=Object(c["a"])(r,i,n,!1,null,"2242a2f7",null);e["a"]=o.exports},"0bf5":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"radar"},[e("h3",{staticClass:"title"},[t._v("同步至雷达链接")]),e("div",{staticClass:"radar-container"},[e("div",{staticStyle:{display:"flex","align-items":"center","margin-bottom":"15px"}},[e("span",{staticStyle:{display:"flex","margin-right":"5px"}},[t._v(" 链接标题： ")]),e("a-input",{staticStyle:{flex:"1"},attrs:{placeholder:"必填，输入标题后即可保存该条链接为雷达链接",maxLength:15},model:{value:t.radarName,callback:function(e){t.radarName=e},expression:"radarName"}})],1),e("h2",{staticStyle:{"font-size":"15px","margin-bottom":"15px"}},[t._v("链接追踪设置")]),e("div",{staticStyle:{"margin-bottom":"15px"}},[e("a-checkbox",{model:{value:t.actionNotice,callback:function(e){t.actionNotice=e},expression:"actionNotice"}},[t._v(" 行为通知 "),e("span",{staticStyle:{color:"#909090"}},[t._v(" （当客户点击雷达链接时，发送雷达链接的员工将会收到消息提醒） ")])])],1),e("div",{staticStyle:{"margin-bottom":"15px"}},[e("a-checkbox",{model:{value:t.dynamicNotification,callback:function(e){t.dynamicNotification=e},expression:"dynamicNotification"}},[t._v(" 动态通知 "),e("span",{staticStyle:{color:"#909090"}},[t._v(" （当客户点击雷达链接时，会将客户的打开行为记录在客户动态里） ")])])],1),e("div",{staticStyle:{"margin-bottom":"15px"}},[e("a-checkbox",{model:{value:t.customerLabel,callback:function(e){t.customerLabel=e},expression:"customerLabel"}},[t._v(" 客户标签 "),e("span",{staticStyle:{color:"#909090"}},[t._v(" （给点击雷达链接的客户打上选中的标签） ")])])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.customerLabel,expression:"customerLabel"}],staticStyle:{"margin-bottom":"15px"}},[e("a-button",{staticClass:"tagbox",attrs:{type:""},on:{click:function(e){t.visibleTag=!0}}},[e("a-icon",{attrs:{type:"plus"}}),t._v("添加标签 ")],1),t._l(t.form.selectTagList,(function(a,i){return e("a-tag",{key:a.tagId,staticClass:"tagList",attrs:{closable:""},on:{close:function(e){return t.closeTag(i)}}},[t._v(" "+t._s(a.tagName)+" ")])}))],2),e("div",{staticStyle:{"margin-bottom":"15px"}},[e("a-checkbox",{model:{value:t.setCustomerRatings,callback:function(e){t.setCustomerRatings=e},expression:"setCustomerRatings"}},[t._v(" 客户评分 "),e("span",{staticStyle:{color:"#909090"}},[t._v(" （开启后给满足规则的客户打上对应标签） ")])])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.setCustomerRatings,expression:"setCustomerRatings"}],staticStyle:{"margin-bottom":"15px"}},[e("TableAddlink",{attrs:{dataSourceList:t.formDataDataSource},on:{funcData:t.dataSourceListData}})],1)]),e("div",{staticClass:"radar-footer"},[e("a-button",{on:{click:function(e){return t.cancleModal()}}},[t._v("取消")]),e("a-button",{attrs:{type:"primary",loading:t.activityLoading},on:{click:t.addData}},[t._v("确认")])],1),e("a-modal",{attrs:{footer:null,centered:""},model:{value:t.visibleTag,callback:function(e){t.visibleTag=e},expression:"visibleTag"}},[e("SelectTags",{attrs:{selectTagList:t.form.selectTagList},on:{cancle:function(e){t.visibleTag=!1},serviceOk:t.serviceOk}})],1)],1)},n=[],s=a("c7eb"),r=a("53ca"),c=a("1da1"),o=(a("a434"),a("0481"),a("4069"),a("d81d"),a("4de4"),a("d3b7"),a("a15b"),a("b64b"),a("c844")),l=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"rule-list"},[t._l(t.dataSource,(function(a,i){return e("div",{key:i,staticClass:"rule-list-item"},[e("a-row",{staticStyle:{"align-items":"center",cursor:"pointer"},attrs:{type:"flex"}},[e("a-button",{attrs:{type:"link",disabled:0===i},on:{click:function(e){return t.onDelete(i)}}},[e("a-icon",{staticStyle:{"margin-right":"9px"},attrs:{type:"minus-circle"}})],1),e("span",[t._v(" 规则"+t._s(i+1)+" :")]),t._v(" 用户 "),e("a-select",{staticStyle:{width:"150px",margin:"0 8px"},model:{value:a.defaultValue,callback:function(e){t.$set(a,"defaultValue",e)},expression:"item.defaultValue"}},[e("a-select-option",{attrs:{value:"1",disabled:a.disabledData}},[t._v(" 每打开一次 ")]),e("a-select-option",{attrs:{value:"2"}},[t._v(" 累计打开次数 ")])],1),"2"===a.defaultValue?e("div",[t._v(" 达到 "),e("a-input-number",{staticStyle:{width:"60px","margin-left":"8px"},attrs:{max:9999999,min:0},model:{value:a.grade,callback:function(e){t.$set(a,"grade",e)},expression:"item.grade"}}),e("a-button",{staticStyle:{"margin-right":"8px"},attrs:{type:""}},[t._v("次")])],1):t._e(),t._v(" 时，可评 "),e("a-input-number",{staticStyle:{width:"60px","margin-left":"8px"},attrs:{max:9999999,min:0},model:{value:a.fraction,callback:function(e){t.$set(a,"fraction",e)},expression:"item.fraction"}}),e("a-button",{staticStyle:{"margin-right":"8px"},attrs:{type:""}},[t._v("分")]),t._v(" 并打上标签： "),e("a-switch",{staticStyle:{margin:"0 8px"},attrs:{size:"small"},model:{value:a.switchData,callback:function(e){t.$set(a,"switchData",e)},expression:"item.switchData"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:a.switchData,expression:"item.switchData"}]},[e("SelectInputTag",{attrs:{placeHolder:"请选择标签"},on:{open:function(e){return t.openSelectTags(a,i)}},model:{value:a.selectTagList,callback:function(e){t.$set(a,"selectTagList",e)},expression:"item.selectTagList"}})],1)],1)],1)})),e("a-divider",{staticStyle:{margin:"0"}}),e("a-button",{staticStyle:{color:"#1990ff"},attrs:{type:"link",disabled:t.stateType},on:{click:t.handleAdd}},[e("a-icon",{attrs:{type:"plus-circle"}}),t._v("添加规则"),e("span",{staticStyle:{"font-size":"12px",color:"rgba(0,0,0,.45)"}},[t._v("（添加的多条规则，可同时生效 ）")])],1)],2),e("a-modal",{attrs:{footer:null,centered:"",destroyOnClose:""},model:{value:t.visibleTag,callback:function(e){t.visibleTag=e},expression:"visibleTag"}},[e("SelectTags",{attrs:{selectTagList:t.form.selectTagList},on:{cancle:function(e){t.visibleTag=!1},serviceOk:t.serviceOk}})],1)],1)},d=[],u=a("2909"),p=(a("7db0"),a("99af"),a("0b8e")),f={data:function(){return{visibleTag:!1,switchData:!1,tagDetail:{},visible:!1,index:0,form:{selectTagList:[]},newDataSource:[],dataSource:[{id:void 0,defaultValue:"1",grade:"",fraction:"",switchData:!1,selectTagList:[],disabledData:!1}]}},props:{dataSourceList:{type:Array,default:function(){return[]}},stateType:{type:Boolean,default:!1}},components:{SelectInputTag:p["a"],SelectTags:o["a"]},watch:{dataSourceList:{handler:function(t,e){this.dataSource=this.dataSourceList.length<1?this.dataSource:this.dataSourceList},deep:!0},dataSource:{handler:function(t,e){this.$emit("funcData",this.dataSource)},deep:!0}},methods:{openSelectTags:function(t,e){this.index=e,this.newDataSource=t,this.form.selectTagList=t.selectTagList,this.visibleTag=!0},serviceOk:function(t){this.form.selectTagList=t.filter((function(t){return t.selectTagList.length>0})).map((function(t){return t.selectTagList})).flat(),this.newDataSource.selectTagList=this.form.selectTagList,this.dataSource.splice(this.index,1,this.newDataSource),this.visibleTag=!1},onDelete:function(t){this.dataSource.splice(t,1)},handleAdd:function(){var t=this.dataSource,e=null===t||void 0===t?void 0:t.find((function(t){return"1"===t.defaultValue})),a={defaultValue:e?"2":"1",grade:"",fraction:"",switchData:!1,selectTagList:[],disabledData:!!e};this.dataSource=[].concat(Object(u["a"])(t),[a])}}},g=f,m=(a("5c99"),a("2877")),v=Object(m["a"])(g,l,d,!1,null,"c4a85aee",null),h=v.exports,b=a("b775"),T={interactiveRadarAdd:"/client_transformation/interactradar/add",updateMaterial:"/client_transformation/oss/update"};function y(t){return Object(b["b"])({url:T.interactiveRadarAdd,method:"post",data:t})}function L(t){return Object(b["b"])({url:T.updateMaterial,method:"post",data:t})}var k={name:"syncRadar",props:{activeArticle:{type:Object,default:function(){return{}}}},data:function(){return{formDataDataSource:[],activityLoading:!1,formData:{},form:{selectTagList:[]},visibleTag:!1,actionNotice:!0,dynamicNotification:!0,customerLabel:!1,setCustomerRatings:!1,activityUrl:"",radarName:""}},components:{SelectTags:o["a"],TableAddlink:h},methods:{cancleModal:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===t&&this.$emit("refresh"),this.$emit("cancle")},closeTag:function(t){this.form.selectTagList.splice(t,1)},serviceOk:function(t){this.form.selectTagList=t.filter((function(t){return t.selectTagList.length>0})).map((function(t){return t.selectTagList})).flat(),this.visibleTag=!1},dataSourceListData:function(t){this.formData.dataSource=t},addData:function(){var t=this;return Object(c["a"])(Object(s["a"])().mark((function e(){var a,i,n,c,o,l,d,u,p,f,g,m,v,h,b,T,k,x;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.radarName){e.next=3;break}return t.$message.warning("请填写雷达链接标题"),e.abrupt("return");case 3:if(!t.customerLabel){e.next=8;break}if(0!==t.form.selectTagList.length){e.next=7;break}return t.$message.warning("请选择客户标签"),e.abrupt("return");case 7:o=null===(c=t.form.selectTagList)||void 0===c?void 0:c.map((function(t){return t.bitmap||t.tagBitmap})).join(",");case 8:if(l=null===(a=t.formData)||void 0===a?void 0:a.dataSource,!t.setCustomerRatings){e.next=19;break}if(l&&!((null===l||void 0===l?void 0:l.length)<1)){e.next=13;break}return t.$message.warning("请填写评分"),e.abrupt("return",!1);case 13:if(d=[],u=null===l||void 0===l?void 0:l.every((function(e,a){if("1"===e.defaultValue){if(!e.fraction)return t.$message.warning("请填写评分"),!1}else if("2"===e.defaultValue){if(!e.fraction)return t.$message.warning("请填写评分"),!1;if(!e.grade)return t.$message.warning("次数不可小于0"),!1;if(0===d.indexOf(e.grade))return t.$message.warning("次数不能相同"),!1;var i;if(d.push(e.grade),e.switchData)if((null===(i=e.selectTagList)||void 0===i?void 0:i.length)<1)return t.$message.warning("请选择标签"),!1}return!0})),u){e.next=17;break}return e.abrupt("return");case 17:e.next=20;break;case 19:t.formData.dataSource=[];case 20:return p=null===(i=t.formData)||void 0===i||null===(n=i.dataSource)||void 0===n?void 0:n.map((function(e){var a,i=null===e||void 0===e||null===(a=e.selectTagList)||void 0===a?void 0:a.map((function(t){return t.bitmap||t.tagBitmap})).join(",");return{id:e.id,type:2,count:e.grade||void 0,ruleKind:"1"===e.defaultValue?0:1,score:e.fraction,hasTag:e.switchData?1:0,autoMarkTagBitmaps:t.setCustomerRatings?i:""}})),f={radarName:t.radarName,type:t.activeArticle.articleType,businessCard:0,isRadar:1,channelId:"",author:t.activeArticle.articleAuthor,content:t.activeArticle.articleContent,title:t.activeArticle.title,desc:t.activeArticle.desc,coverUrl:t.activeArticle.coverUrl.compress,link:t.activeArticle.url,behaviorNotify:void 0===t.actionNotice||t.actionNotice?1:0,activityNotify:void 0===t.dynamicNotification||t.dynamicNotification?1:0,hasCustomerTag:t.customerLabel?1:0,tagRule:t.customerLabel?[{autoMarkTagBitmaps:o,type:1}]:[],scoreRule:t.setCustomerRatings?p:[]},t.activityLoading=!0,g=new FormData,m=Object.keys(f),null===m||void 0===m||m.map((function(t){"object"===Object(r["a"])(f[t])?g.append(t,JSON.stringify(f[t])):g.append(t,f[t])})),e.prev=26,e.next=29,y(g);case 29:if(h=e.sent,0!==(null===(v=h)||void 0===v?void 0:v.statusCode)){e.next=41;break}return T=new FormData,T.append("id",t.activeArticle.id),T.append("mtype",0),T.append("isRadar",1),e.next=37,L(T);case 37:h=e.sent,0===(null===(b=h)||void 0===b?void 0:b.statusCode)?(t.$message.success("同步雷达成功"),t.cancleModal(!0)):t.$message.warning(null===(k=h)||void 0===k?void 0:k.msg),e.next=42;break;case 41:t.$message.warning(null===(x=h)||void 0===x?void 0:x.msg);case 42:e.next=47;break;case 44:e.prev=44,e.t0=e["catch"](26),t.$message.warning(e.t0);case 47:return e.prev=47,t.activityLoading=!1,e.finish(47);case 50:case"end":return e.stop()}}),e,null,[[26,44,47,50]])})))()}}},x=k,_=(a("d0d5"),Object(m["a"])(x,i,n,!1,null,"82af417e",null));e["a"]=_.exports},"260e":function(t,e,a){},"32ef":function(t,e,a){t.exports=a.p+"assets/upload-file.a5a8ceeb.svg"},"4c9b":function(t,e,a){},"4e28":function(t,e,a){},"5c99":function(t,e,a){"use strict";a("ecc3")},"5e1d":function(t,e,a){},"6e71":function(t,e,a){"use strict";a("7791")},7791:function(t,e,a){},"7cf3":function(t,e,a){"use strict";a("b602")},"842b":function(t,e,a){"use strict";var i=a("5530"),n=(a("d3b7"),a("d81d"),a("3ca3"),a("ddb0"),a("a15b"),a("a9e3"),a("b0c0"),a("9911"),a("d885")),s=a("cf5f");e["a"]={methods:{interactiveRadarUploadFile:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.uploadFilePath;return new Promise((function(a,i){var n=new FormData;n.append("file",t),n.append("dir",e),Object(s["m"])(n).then((function(t){a(t.data)})).catch((function(t){i(t)}))}))},uploadMedia:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attachments;return new Promise((function(a,i){var n=(null===e||void 0===e?void 0:e.map((function(e){return new Promise((function(a,i){if("link"===e.type&&e.isRadar&&!e.isMaterial)t.interactiveRadarAdd(e).then((function(t){a(t)})).catch((function(t){i(t)}));else if("img"===e.type){var n=new FormData;n.append("file",e.pic_url.file),n.append("dir","clientTransformation"),n.append("type","image"),Object(s["y"])(n).then((function(t){e.pic_url.fileUrl=t.data.fileUrl,e.pic_url.mediaId=t.data.mediaId,a(t.data)}))}else a()}))})))||[];Promise.all(n).then((function(t){a()})).catch((function(e){t.$message.error(e||e.message),t.loading=!1,i(e)}))}))},interactiveRadarAdd:function(t){var e=this;return new Promise((function(a,i){e.getParamsLink(t).then((function(e){Object(n["f"])(e).then((function(e){t.radarId=e.data.radarId,t.url=e.data.radarLink+t.source,a(e)})).catch((function(t){i(t)}))}))}))},getParamsLink:function(t){return new Promise((function(e,a){var i=new FormData,n=t.isCustomerTag?[{autoMarkTagBitmaps:t.selectCustomerTagList.map((function(t){return t.bitmap})).join(",")}]:[];if(i.append("type",1),i.append("radarName",t.linkTitle),i.append("link",t.url),i.append("activityNotify",Number(t.activityNotify)),i.append("behaviorNotify",Number(t.behaviorNotify)),i.append("tagRule",JSON.stringify(n)),i.append("title",t.radarTitle),i.append("desc",t.desc),i.append("hasCustomerTag",Number(t.isCustomerTag)),t.isScoreRule){var r=JSON.stringify(t.ruleDetails.map((function(t){var e,a;return{autoMarkTagBitmaps:null===(e=t.selectTagList)||void 0===e||null===(a=e.map((function(t){return t.bitmap})))||void 0===a?void 0:a.join(","),hasTag:Number(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count||0}})));i.append("scoreRule",r)}if(t.coverUrl.file){var c=new FormData;c.append("file",t.coverUrl.file),c.append("dir","clientTransformation"),Object(s["m"])(c).then((function(a){i.append("coverUrl",a.data),t.picurl=a.data,e(i)})).catch((function(t){a(t)}))}else e(i)}))},getMessageList:function(t){return t.map((function(t){var e="";if(0===t.msgType&&(e=t.msgContent,t.formObj={},t.pdfArr=[],t.videoArr=[]),1===t.msgType&&(e={compress:t.msgContent},t.imageObj={title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{compress:t.msgContent}},t.formObj={},t.pdfArr=[],t.videoArr=[]),2===t.msgType){t.pdfArr=[],t.videoArr=[];var a,n,s,r,c=JSON.parse(t.msgContent);if(e={form:{linkTitle:c.title,desc:c.desc,coverUrl:{compress:c.picUrl},type:"link",url:c.url}},t.interactRadar)e.form.isRadar=!0,e.form.behaviorNotify=Boolean(t.interactRadar.behaviorNotify),e.form.activityNotify=Boolean(t.interactRadar.activityNotify),e.form.isCustomerTag=(null===(a=t.interactRadar.tagRules)||void 0===a?void 0:a.length)>0,e.form.radarTitle=t.interactRadar.radarName,e.form.radarId=t.interactRadar.radarId,e.form.selectCustomerTagList=null===(n=t.interactRadar.tagRules[0])||void 0===n||null===(s=n.customerTags)||void 0===s?void 0:s.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{key:t.tagId})})),e.form.isScoreRule=(null===(r=t.interactRadar.scoreRules)||void 0===r?void 0:r.length)>0,e.form.ruleDetails=t.interactRadar.scoreRules.map((function(t){var e;return Object(i["a"])(Object(i["a"])({},t),{},{autoMarkTagBitmaps:t.autoMarkTagBitmaps,selectTagList:null===(e=t.customerTags)||void 0===e?void 0:e.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{key:t.tagId})})),hasTag:Boolean(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count})}))}if(3===t.msgType){var o=JSON.parse(t.msgContent);t.pdfArr=[Object(i["a"])(Object(i["a"])({},o),{},{uid:"1",status:"done"})],t.formObj={},t.videoArr=[]}if(4===t.msgType){var l=JSON.parse(t.msgContent);t.formObj=Object(i["a"])(Object(i["a"])({},l),{},{name:l.title}),t.pdfArr=[]}if(5===t.msgType){var d=JSON.parse(t.msgContent);t.videoArr=[Object(i["a"])({},d)],t.formObj={},t.pdfArr=[]}return Object(i["a"])(Object(i["a"])({},t),{},{msgContent:e})}))},getPlanList:function(t){var e=this;return t.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{messageList:e.getAddMessageList(t.messageList)})}))},getAddMessageList:function(t){return t.map((function(t){var e="";if(0===t.msgType&&(e=t.msgContent),1===t.msgType&&(e=t.fileUrl||t.msgContent.compress),2===t.msgType){var a,i,n="";t.fileUrl?n=t.fileUrl:t.msgContent.form.picurl?n=t.msgContent.form.picurl:t.msgContent.form.coverUrl.compress&&(n=t.msgContent.form.coverUrl.compress);var s=t.msgContent.form.radarId||(null===(a=t.msgContent.form.interactRadar)||void 0===a?void 0:a.radarId);s&&(s=String(s)),e=JSON.stringify({desc:t.msgContent.form.desc,picUrl:n,url:t.msgContent.form.url,title:t.msgContent.form.linkTitle,radarId:s,type:t.msgContent.form.radarId||null!==(i=t.msgContent.form.interactRadar)&&void 0!==i&&i.radarId?"radar_link":"normal_link"})}return 3===t.msgType&&(e=JSON.stringify({pdfFile:t.pdfArr[0].fileUrl||t.pdfArr[0].pdfFile,name:t.pdfArr[0].name,size:t.pdfArr[0].size,cover:"https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/h5/img/pdf.png"})),4===t.msgType&&(e=JSON.stringify({cover:t.formObj.cover,desc:t.formObj.desc,title:t.formObj.name,url:t.formObj.link})),{messageId:t.messageId,msgType:t.msgType,msgContent:e}}))},getPlanFileList:function(t){var e=this,a=[];return t.length>0&&(a=t.map((function(t){return new Promise((function(a,i){var n,s,r,c;2===t.msgType?t.msgContent.form.isRadar&&t.msgContent.form.randerIsEdit?e.interactiveRadarAdd(t.msgContent.form).then((function(e){t.radarId=e.data,a(e)})).catch((function(t){i(t)})):t.msgContent.form.coverUrl.file?e.interactiveRadarUploadFile(t.msgContent.form.coverUrl.file).then((function(e){t.fileUrl=e,a(e)})).catch((function(t){i(t)})):a():1===t.msgType&&t.msgContent.file?e.interactiveRadarUploadFile(t.msgContent.file).then((function(e){t.fileUrl=e,a(e)})).catch((function(t){i(t)})):3===t.msgType&&null!==(n=t.pdfArr)&&void 0!==n&&null!==(s=n[0])&&void 0!==s&&s.originFileObj?e.interactiveRadarUploadFile(t.pdfArr[0].originFileObj).then((function(e){t.pdfArr[0].fileUrl=e,a(e)})).catch((function(t){i(t)})):5===t.msgType&&null!==(r=t.videoArr)&&void 0!==r&&null!==(c=r[0])&&void 0!==c&&c.originFileObj?e.interactiveRadarUploadFile(t.videoArr[0].originFileObj).then((function(e){t.videoArr[0].fileUrl=e,a(e)})).catch((function(t){i(t)})):a()}))}))),a}}}},"8f7f":function(t,e,a){"use strict";a.r(e);a("caad"),a("2532");var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-box",attrs:{loading:"true"}},[e("span",{staticClass:"screen"},[t._v("筛选:")]),e("a-radio-group",{on:{change:t.changeMaterial},model:{value:t.selectMaterial,callback:function(e){t.selectMaterial=e},expression:"selectMaterial"}},t._l(t.pageList,(function(a){return e("a-radio",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.title)+" ")])})),1),e("a-spin",{attrs:{spinning:t.spinning}},[e("ul",{staticClass:"conent-wrap"},t._l(t.pageList,(function(a){return t.selectMaterial===a.id?e("li",{key:a.id},[e("header",{staticClass:"header"},[a.isArticle?e("div",{staticClass:"article-header"},[e("div",{staticClass:"article-tab"},[e("span",{class:["tab",1===t.articleTab?"active":""],on:{click:function(e){return t.changeArticleTab(1)}}},[t._v("公众号文章素材")]),e("span",{class:["tab",2===t.articleTab?"active":""],on:{click:function(e){return t.changeArticleTab(2)}}},[t._v("微信助手文章素材")])]),1===t.articleTab?e("p",{staticClass:"tips"},[e("a-icon",{staticStyle:{color:"#1890ff"},attrs:{type:"bell"}}),t._v(" 可同步公众号素材库文章素材（已发送的素材无法同步阅读数、评论等数据） ")],1):t._e()]):t._e(),a.isArticle&&1===t.articleTab?e("div",{staticClass:"official-header"},[e("div",{staticClass:"flex-row"},[e("div",{staticClass:"flex-left"},[e("span",[t._v("公众号筛选:")]),e("a-select",{staticStyle:{width:"200px","margin-left":"10px",height:"35px"},on:{change:t.officialChange},scopedSlots:t._u([{key:"dropdownRender",fn:function(a){return e("div",{},[e("v-nodes",{attrs:{vnodes:a}}),e("a-divider",{staticStyle:{margin:"4px 0"}}),e("div",{staticStyle:{padding:"4px 8px 8px",cursor:"pointer",color:"#1990ff"},on:{mousedown:function(t){return t.preventDefault()},click:t.addItem}},[e("a-icon",{attrs:{type:"plus"}}),t._v("添加公众号 ")],1)],1)}}],null,!0),model:{value:t.officialValue,callback:function(e){t.officialValue=e},expression:"officialValue"}},t._l(t.publicAccountList,(function(a){return e("a-select-option",{key:a.appid,attrs:{value:a.appid}},[e("a-avatar",{attrs:{icon:"user",shape:"square",src:a.qrcodeUrl}}),t._v(" "+t._s(a.nickName)+" ")],1)})),1)],1),e("div",{staticClass:"flex-right"},[e("span",[t._v("上次同步时间："+t._s(t.syncTime)+" ")]),e("a-button",{staticClass:"refresh",on:{click:function(e){return t.refresh()}}},[t._v("同步")])],1)])]):t._e(),e("a-row",{attrs:{type:"flex",align:"middle",justify:"space-between"}},[e("a-col",[t._v(" "+t._s(a.title)+"素材(共"+t._s(t.pagination.total)+"篇) ")]),e("a-col",{staticClass:"search-button"},[e("a-input-search",{staticStyle:{width:"200px"},attrs:{allowClear:"",placeholder:"搜索".concat(a.title,"标题")},on:{search:t.onSearchName},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}}),a.isScreen?e("a-popover",{staticClass:"screen-tags",attrs:{placement:"bottom",trigger:"click"},model:{value:t.visiblePopover,callback:function(e){t.visiblePopover=e},expression:"visiblePopover"}},[e("div",{staticClass:"tag-title",attrs:{slot:"title"},slot:"title"},[e("span",[t._v("素材标签("+t._s(t.tagList.length)+")")]),e("span",{staticClass:"edit",on:{click:t.editTags}},[e("a-icon",{staticClass:"edit-icon",attrs:{type:"edit"}}),t._v("编辑")],1)]),e("div",{staticClass:"tag-content",attrs:{slot:"content"},slot:"content"},[e("a-input-search",{attrs:{allowClear:"",placeholder:"请输入要搜索的标签"},model:{value:t.searchTag,callback:function(e){t.searchTag=e},expression:"searchTag"}}),e("div",{staticClass:"tag-checkable"},t._l(t.tagList,(function(a){return e("a-tag",{key:a.tagId,attrs:{color:t.tagIdList.includes(a.tagId)?"blue":""},on:{click:function(e){return t.checkedTag(a)}}},[t._v(" "+t._s(a.tagName)+" ")])})),1),e("div",{staticClass:"foot-button"},[e("a-space",{attrs:{size:"middle"}},[e("a-button",{on:{click:function(e){t.visiblePopover=!1}}},[t._v("取消")]),e("a-button",{attrs:{type:"primary"},on:{click:t.finishSelectTag}},[t._v("完成")])],1)],1)],1),e("a-button",{attrs:{icon:"select"}},[t._v("筛选")])],1):t._e(),!a.isArticle||a.isArticle&&2===t.articleTab?e("a-button",{staticClass:"add-material",attrs:{type:"primary"},on:{click:function(e){return t.addMaterial(a.id)}}},[t._v(" 添加"+t._s(a.title)+" ")]):t._e()],1)],1),e("div",{staticClass:"select-tag-list"},t._l(t.selectedTagList,(function(a,i){return e("a-tag",{key:a.tagId,attrs:{closable:""},on:{close:function(e){return t.closeSelectTag(i)}}},[t._v(" "+t._s(a.tagName)+" ")])})),1)],1),e("a-row",{attrs:{gutter:[16,16],type:"flex"}},t._l(a.list,(function(i){return e("a-col",{key:i.id,staticClass:"card-wrap",attrs:{span:4}},[e("a-card",{staticStyle:{width:"240px"},attrs:{hoverable:""}},[e("div",{staticClass:"cover",attrs:{slot:"cover"},slot:"cover"},["2"===a.id?e("div",{staticClass:"cover-img"},[e("img",{staticClass:"posters",attrs:{alt:a.title,src:i.url}})]):t._e(),"7"===a.id?e("div",{staticClass:"cover-img"},[e("video",{staticClass:"cover-img",attrs:{controls:"controls",width:"100%"}},[e("source",{attrs:{src:i.url,type:"video/mp4"}})])]):e("div",{staticClass:"document"},[a.isArticle?e("p",{class:["sync-radar-box",i.isRadar?"disable":""],on:{click:function(e){return e.stopPropagation(),t.syncRadarLink(i)}}},[e("a-icon",{attrs:{type:"radar-chart"}}),t._v(" 同步雷达链接 ")],1):t._e(),e("div",{staticClass:"document-left"},[e("p",[t._v(t._s(i.title))]),i.desc||a.isArticle?e("a-tooltip",{attrs:{title:i.desc}},[e("span",{staticClass:"document-desc"},[t._v(t._s(i.desc))])]):e("span",[t._v(t._s(t._f("getUnits")(i.fileSize)))])],1),e("img",{attrs:{src:a.icon||i.coverUrl.compress||"/imgs/default-cover.png",referrerpolicy:"no-referrer"}})]),e("p",{staticClass:"createName"},[t._v("创建人:"+t._s(i.creatorName))]),i.tags?e("div",t._l(i.tags,(function(a,i){return e("a-tag",{key:i},[t._v(t._s(a.tagName))])})),1):t._e()]),e("div",{attrs:{slot:"actions"},slot:"actions"},["7"===a.id?e("a-tooltip",{attrs:{title:i.title}},[e("h3",{staticClass:"radio-title"},[t._v(t._s(i.title))])]):t._e(),e("div",{staticClass:"action-button"},["2"===a.id?e("a-tooltip",{attrs:{title:i.title}},[e("p",[t._v(" "+t._s(i.title)+" ")])]):e("a-tooltip",{attrs:{title:a.isArticle&&1===t.articleTab?i.articleSyncTime:i.createTime}},[a.isArticle&&1===t.articleTab?e("p",[t._v("最后同步时间: "+t._s(i.articleSyncTime))]):e("p",[t._v("创建时间: "+t._s(i.createTime))])]),a.isEdit&&(!a.isArticle||a.isArticle&&2===t.articleTab)?e("a-icon",{staticClass:"edit",attrs:{type:"edit"},on:{click:function(e){return t.editMaterial(i)}}}):t._e(),a.isArticle&&1===t.articleTab?e("a-icon",{attrs:{type:"sync"},on:{click:function(e){return t.refresh(i.articleMediaId)}}}):e("a-icon",{attrs:{type:"delete"},on:{click:function(e){return t.deleteMaterial(i.id)}}})],1)],1)])],1)})),1),e("a-pagination",{attrs:{pageSize:t.pagination.pageSize,total:t.pagination.total,"show-less-items":""},on:{change:t.changePage},model:{value:t.pagination.current,callback:function(e){t.$set(t.pagination,"current",e)},expression:"pagination.current"}}),e("a-modal",{attrs:{destroyOnClose:"",centered:"",footer:null},model:{value:t.visibleUpload,callback:function(e){t.visibleUpload=e},expression:"visibleUpload"}},[e("Upload",{attrs:{editData:t.editData,selectMaterial:t.selectMaterial,title:a.title,loading:t.loading},on:{cancle:function(e){t.visibleUpload=!1},ok:t.uploadFile}})],1)],1):t._e()})),0)]),e("a-modal",{attrs:{okText:"完成"},on:{ok:t.delTag},model:{value:t.visibleTag,callback:function(e){t.visibleTag=e},expression:"visibleTag"}},[e("EditTag",{on:{closeTag:t.closeTag}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",width:"580px",centered:""},model:{value:t.visibleLink,callback:function(e){t.visibleLink=e},expression:"visibleLink"}},[e("AddLink",{attrs:{editData:t.editData,isNeedSelectRadar:!1,isNeedTag:!0,source:"material",loading:t.loading},on:{cancle:function(e){t.visibleLink=!1},serviceOk:t.uploadFileLink}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",width:"580px",centered:""},model:{value:t.visibleSyncRadar,callback:function(e){t.visibleSyncRadar=e},expression:"visibleSyncRadar"}},[e("SyncRadar",{attrs:{activeArticle:t.activeArticle},on:{cancle:function(e){t.visibleSyncRadar=!1},refresh:function(e){return t.getMaterialList()}}})],1)],1)},n=[],s=a("5530"),r=a("c7eb"),c=a("1da1"),o=(a("d81d"),a("a434"),a("a15b"),a("c740"),a("d3b7"),a("7db0"),a("99af"),a("b0c0"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"upload-wrap"},[e("h4",[t._v(t._s(t.editData.id?"修改":"添加")+" "+t._s(t.title))]),t.fileList.length<1?e("div",{staticClass:"upload-file"},[e("div",[e("img",{staticClass:"upload-icon",attrs:{src:a("32ef"),alt:"上传"}}),e("p",{staticClass:"tips"},[t._v(t._s(t.formatType.tips))]),e("a-upload",{attrs:{"list-type":"picture",accept:t.accept,fileList:t.fileList,showUploadList:!1,"before-upload":t.beforeUpload,customRequest:t.customRequest},on:{change:t.handleChange}},[e("a-button",{attrs:{type:"primary"}},[t._v("选择文件")])],1)],1)]):e("div",{staticClass:"preview"},[e("div",{staticClass:"preview-detail"},["2"===t.selectMaterial?e("div",{staticClass:"uploadImg-wrap"},[e("img",{staticClass:"uploadImg",attrs:{src:t.uploadImg}})]):e("div",{staticClass:"document"},[e("div",{staticClass:"document-left"},[e("a-tooltip",{attrs:{title:t.uploadFile.name}},[e("p",[t._v(t._s(t.uploadFile.name))])]),e("span",[t._v(t._s(t._f("getUnits")(t.uploadFile.size)))])],1),e("img",{staticClass:"icon-img",attrs:{src:t.formatType.icon}})]),e("a-upload",{attrs:{"list-type":"picture",accept:t.accept,fileList:t.fileList,showUploadList:!1,"before-upload":t.beforeUpload,customRequest:t.customRequest},on:{change:t.handleChange}},[e("a-button",{attrs:{type:"link",icon:"sync"}},[t._v(" 重新上传 ")])],1)],1),e("div",{staticClass:"upload-tag"},[e("a-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v(" 选择素材标签 ")]),t.checked?e("div",{staticClass:"select-tag"},[e("a-button",{attrs:{icon:"plus",size:"small"},on:{click:function(e){t.visibleTags=!0}}},[t._v("选择标签")]),t._l(t.selectTagList,(function(a,i){return e("a-tag",{key:a.tagId,attrs:{closable:""},on:{close:function(e){return t.deleteTag(i)}}},[t._v(" "+t._s(a.tagName)+" ")])}))],2):t._e()],1)]),e("a-modal",{attrs:{centered:""},on:{ok:t.selectTag},model:{value:t.visibleTags,callback:function(e){t.visibleTags=e},expression:"visibleTags"}},[e("SelectMaterialTags",{ref:"SelectMaterialTags",attrs:{selectTagWrap:t.selectTagList}})],1),e("div",{staticClass:"foot-button"},[e("a-space",{attrs:{size:12}},[e("a-button",{on:{click:function(e){return t.$emit("cancle")}}},[t._v("取消")]),e("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.ok}},[t._v("确定")])],1)],1)],1)}),l=[],d=a("ca00"),u=function(){var t=this,e=t._self._c;return e("div",[e("h4",{staticClass:"title"},[t._v("选择素材标签")]),e("a-input-search",{attrs:{allowClear:"",placeholder:"请输入要搜索的标签"},on:{search:t.searchTag},model:{value:t.searchNmae,callback:function(e){t.searchNmae=e},expression:"searchNmae"}}),e("div",{staticClass:"add-tags-wrap"},t._l(t.tagList,(function(a){return e("a-tag",{key:a.tagId,attrs:{color:t.tagIdList.includes(a.tagId)?"blue":""},on:{click:function(e){return t.checkedTag(a)}}},[t._v(" "+t._s(a.tagName)+" ")])})),1)],1)},p=[],f=a("cf5f"),g={name:"SelectMaterialTags",data:function(){return{searchNmae:"",tagList:[],selectTagList:[]}},props:{selectTagWrap:{type:[Array],default:function(){return[]}}},watch:{selectTagWrap:{handler:function(){this.selectTagList=this.selectTagWrap},immediate:!0}},computed:{tagIdList:function(){return this.selectTagList.map((function(t){return t.tagId}))}},created:function(){this.getTagList()},methods:{searchTag:function(){this.getTagList()},checkedTag:function(t){var e=this.selectTagList.findIndex((function(e){if(e.tagId===t.tagId)return e}));e>=0?this.selectTagList.splice(e,1):this.selectTagList.push(t)},getTagList:function(){var t=this,e={tagName:this.searchNmae||null};Object(f["s"])(e).then((function(e){t.tagList=e.data})).catch((function(e){t.$message.error(e)}))}}},m=g,v=(a("6e71"),a("2877")),h=Object(v["a"])(m,u,p,!1,null,"095dcd9c",null),b=h.exports,T=a("b9cd"),y={name:"Upload",props:["value","selectMaterial","title","editData","loading"],components:{SelectMaterialTags:b},data:function(){return{visibleUpload:!1,accept:"",visibleTags:!1,uploadImg:"",checked:!1,uploadFile:"",selectTagList:[],fileList:[]}},filters:{getUnits:function(t){return Object(d["b"])(t)}},computed:{formatType:function(){var t=this;return T["m"].find((function(e){return e.id==t.selectMaterial}))}},created:function(){this.accept=this.formatType.format},watch:{value:function(){this.visibleUpload=this.value},editData:{handler:function(){var t,e;null!==(t=this.editData)&&void 0!==t&&t.id&&(this.fileList[0]={uid:"-1",name:"name",status:"done",url:this.editData.url},null!==(e=this.editData)&&void 0!==e&&e.tags&&(this.selectTagList=this.editData.tags.map((function(t){return t})),this.checked=!0),this.uploadFile={name:this.editData.title,size:this.editData.fileSize})},immediate:!0}},methods:{customRequest:function(t){this.uploadFile=t.file,t.onSuccess()},beforeUpload:function(t){var e=t.size/1024/1024<this.formatType.max;return e||this.$message.error("文件不能大于".concat(this.formatType.max,"MB!")),e},handleChange:function(t){var e,a=this;2==this.selectMaterial&&Object(d["g"])(null===t||void 0===t||null===(e=t.file)||void 0===e?void 0:e.originFileObj).then((function(t){a.uploadImg=t[1]})),"uploading"===t.file.status&&(this.fileList=[t.fileList[t.fileList.length-1]],this.fileList[0].status="done")},deleteTag:function(t){this.selectTagList.splice(t,1)},cancel:function(){this.visibleUpload=!1,this.$emit("input",this.visibleUpload)},selectTag:function(){this.selectTagList=this.$refs.SelectMaterialTags.selectTagList,this.visibleTags=!1},ok:function(){var t;this.uploadFile?this.$emit("ok",{selectTagList:this.selectTagList,id:null===(t=this.editData)||void 0===t?void 0:t.id,uploadFile:this.uploadFile}):this.$message.warning("请上传文件")}}},L=y,k=(a("b4a4"),Object(v["a"])(L,o,l,!1,null,"1b688545",null)),x=k.exports,_=function(){var t=this,e=t._self._c;return e("div",[e("h4",{staticClass:"title"},[t._v("编辑素材标签")]),e("a-input-search",{attrs:{allowClear:"",placeholder:"请输入要搜索的标签"}}),e("div",{staticClass:"add-tags-wrap"},[e("a-button",{directives:[{name:"show",rawName:"v-show",value:!t.visibleInput,expression:"!visibleInput"}],staticClass:"add",attrs:{icon:"plus",size:"small"},on:{click:t.addTagClick}},[t._v("添加标签")]),e("a-input",{directives:[{name:"show",rawName:"v-show",value:t.visibleInput,expression:"visibleInput"}],ref:"tagsInput",staticClass:"tags-input add",attrs:{allowClear:"",size:"small",maxLength:6,placeholder:"输入后回车"},on:{blur:t.pressEnter,pressEnter:t.pressEnter},model:{value:t.inputTag,callback:function(e){t.inputTag=e},expression:"inputTag"}}),t._l(t.tagList,(function(a){return e("a-tag",{key:a.tagId,attrs:{closable:""},on:{close:function(e){return t.closeTag(a.tagId)}}},[t._v(" "+t._s(a.tagName)+" ")])}))],2)],1)},C=[],S={name:"EditTag",data:function(){return{visibleInput:!1,tagList:[],closeTagList:[],inputTag:""}},created:function(){this.getTagList()},methods:{getTagList:function(){var t=this,e={tagName:this.searchTag||null};Object(f["s"])(e).then((function(e){t.tagList=e.data})).catch((function(e){t.$message.error(e)}))},pressEnter:function(t){var e=this;this.inputTag&&Object(f["b"])({tagName:this.inputTag}).then((function(t){e.visibleInput=!1,e.getTagList(),e.$message.success("新增标签成功"),e.inputTag=""})).catch((function(t){e.$message.error(t)}))},closeTag:function(t){this.closeTagList.push(t),this.$emit("closeTag",this.closeTagList)},addTagClick:function(){var t=this;this.visibleInput=!0,this.$nextTick((function(){t.$refs.tagsInput.focus()}))}}},w=S,O=(a("0917"),Object(v["a"])(w,_,C,!1,null,"20c9bd6a",null)),j=O.exports,N=a("a2ba"),A=a("0bf5"),M=a("842b"),D=0,R={public:3,selfArticl:4},I={name:"PersonalMaterial",components:{SyncRadar:A["a"],Upload:x,EditTag:j,AddLink:N["a"],VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}}},mixins:[M["a"]],data:function(){return{activeArticle:null,visibleSyncRadar:!1,syncTime:"",publicAccountList:[],officialValue:"",articleTab:1,spinning:!1,loading:!1,visibleUpload:!1,visiblePopover:!1,visibleTag:!1,checked:!1,closeTagList:[],selectMaterial:"0",searchName:"",tagList:"",searchTag:"",selectTagList:[],selectedTagList:[],editData:{},visibleLink:!1,pagination:{current:1,pageSize:12,total:0},pageList:[{id:"0",title:"文章",nums:"9",isEdit:!0,isScreen:!1,list:[],isArticle:!0},{id:"1",title:"链接",nums:"9",isEdit:!0,isScreen:!0,list:[]},{id:"2",title:"海报",nums:"9",isEdit:!1,isScreen:!0,list:[]},{id:"7",title:"视频",nums:"9",isEdit:!0,isScreen:!0,list:[]},{id:"3",title:"PDF",nums:"9",isEdit:!0,isScreen:!0,icon:"/icons/pdf.png",list:[]},{id:"4",title:"PPT",nums:"9",isEdit:!0,isScreen:!0,icon:"/icons/ppt.svg",list:[]},{id:"5",title:"表格",nums:"9",isEdit:!0,isScreen:!0,icon:"/icons/excel.svg",list:[]},{id:"6",title:"文档",nums:"9",isEdit:!0,isScreen:!0,icon:"/icons/word.svg",list:[]}]}},filters:{getUnits:function(t){return Object(d["b"])(t)}},computed:{tagIdList:function(){return this.selectTagList.map((function(t){return t.tagId}))}},created:function(){var t=this;return Object(c["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getOfficialAccount();case 2:t.getLastSyncTime(),t.$route.params.articleTab&&(t.articleTab=t.$route.params.articleTab),t.getMaterialList();case 5:case"end":return e.stop()}}),e)})))()},mounted:function(){this.getTagList()},methods:{syncRadarLink:function(t){t.isRadar||(this.activeArticle=Object(s["a"])({},t),this.visibleSyncRadar=!0)},getLastSyncTime:function(){var t=this;return Object(c["a"])(Object(r["a"])().mark((function e(){var a,i,n,s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.spinning=!0,e.next=4,Object(f["k"])();case 4:a=e.sent,i=a.statusCode,n=a.msg,s=a.data,i!==D?t.$message.error(n):t.syncTime=null===s||void 0===s?void 0:s.syncTime,e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),t.$message.error("错误"+e.t0.message);case 14:return e.prev=14,t.spinning=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})))()},getOfficialAccount:function(){var t=this;return Object(c["a"])(Object(r["a"])().mark((function e(){var a,i,n,s,c;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.spinning=!0,e.next=4,Object(f["l"])();case 4:a=e.sent,i=a.statusCode,n=a.msg,s=a.data,i!==D?t.$message.error(n):(t.publicAccountList=s||[],t.officialValue=(null===(c=s[0])||void 0===c?void 0:c.appid)||""),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),t.$message.error("错误"+e.t0.message);case 14:return e.prev=14,t.spinning=!1,e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[0,11,14,17]])})))()},addItem:function(){this.$router.push({name:"PublicAuth"})},officialChange:function(t){this.getMaterialList()},refresh:function(t){var e=this;return Object(c["a"])(Object(r["a"])().mark((function a(){var i,n,s,c;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={appid:e.officialValue},t&&(i.mediaId=t),a.prev=2,e.spinning=!0,a.next=6,Object(f["r"])(i);case 6:n=a.sent,s=n.statusCode,c=n.msg,s!==D?e.$message.error(c):(e.getLastSyncTime(),e.getMaterialList()),a.next=15;break;case 12:a.prev=12,a.t0=a["catch"](2),e.$message.error("错误"+a.t0.message);case 15:return a.prev=15,e.spinning=!1,a.finish(15);case 18:case"end":return a.stop()}}),a,null,[[2,12,15,18]])})))()},changeArticleTab:function(t){var e;this.articleTab=t,this.officialValue=(null===(e=this.publicAccountList[0])||void 0===e?void 0:e.appid)||"",this.selectTagList=[],this.searchName="",this.pagination.current=1,this.getMaterialList()},closeSelectTagPerson:function(t){this.selectedTagList.splice(t,1),this.getMaterialList()},addMaterial:function(t){this.editData={},"0"===t?this.$router.push({name:"ArticleEditor",query:{belongTo:2,articleTab:this.articleTab}}):"1"===t?this.visibleLink=!0:this.visibleUpload=!0},closeTag:function(t){this.closeTagList=t},delTag:function(){var t=this;if(this.closeTagList.length>0){var e="";e=this.closeTagList.join(","),Object(f["h"])({tagId:e}).then((function(e){t.$message.success("删除标签成功"),t.visibleTag=!1}))}else this.visibleTag=!1;this.getTagList()},editMaterial:function(t){this.editData=t,this.editData.type="link","0"===this.selectMaterial?this.$router.push({name:"ArticleEditor",query:{id:t.id,belongTo:2,articleTab:this.articleTab}}):"1"===this.selectMaterial?this.visibleLink=!0:this.visibleUpload=!0},changeMaterial:function(){var t;this.articleTab=1,this.officialValue=(null===(t=this.publicAccountList[0])||void 0===t?void 0:t.appid)||"",this.selectTagList=[],this.searchName="",this.pagination.current=1,this.getMaterialList()},finishSelectTag:function(){this.visiblePopover=!1,this.selectedTagList=this.selectTagList,this.getMaterialList()},checkedTag:function(t){var e=this.selectTagList.findIndex((function(e){if(e.tagId===t.tagId)return e}));e>=0?this.selectTagList.splice(e,1):this.selectTagList.push(t)},getMaterialList:function(){var t,e=this;this.spinning=!0;var a={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,mtype:this.selectMaterial,title:this.searchName,tagId:null===(t=this.tagIdList)||void 0===t?void 0:t.join(","),belongTo:2};0==this.selectMaterial&&(1==this.articleTab?(a.appid=this.officialValue,a.articleType=R.public):a.articleType=R.selfArticl),Object(f["o"])(a).then((function(t){e.pageList.find((function(t){return t.id===e.selectMaterial})).list=t.data.list.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{title:t.title?t.title:t.linkTitle,coverUrl:{compress:t.coverUrl}})})),e.pagination.total=t.data.total})).catch((function(t){e.$message.error(t)})).finally((function(){return e.spinning=!1}))},uploadFileLink:function(t){var e=this;return Object(c["a"])(Object(r["a"])().mark((function a(){return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e.loading=!0,a.next=3,e.uploadMedia([t]);case 3:e.getParamsImg(t).then((function(a){var i=t.id?e.update:e.upload,n=t.id?"修改":"上传";i(a).then((function(){e.$message.success("文件".concat(n,"成功")),e.visibleUpload=!1,e.visibleLink=!1,e.getMaterialList()})).catch((function(t){e.$message.error(t)})).finally((function(){e.loading=!1}))})).catch((function(t){e.$message.error(t)}));case 4:case"end":return a.stop()}}),a)})))()},uploadFile:function(t){var e=this,a=this.getParams(t),i=t.id?this.update:this.upload,n=t.id?"修改":"上传";this.loading=!0,i(a).then((function(){e.$message.success("文件".concat(n,"成功")),e.visibleUpload=!1,e.getMaterialList()})).catch((function(t){e.$message.error(t)})).finally((function(){e.loading=!1}))},getParamsImg:function(t){var e=this;return new Promise((function(a,i){var n=new FormData;if(t.id&&n.append("id",t.id),n.append("mtype",e.selectMaterial),n.append("tag",t.tag),n.append("desc",t.desc),n.append("linkTitle",t.linkTitle),t.radarId?(n.append("url","".concat(t.url,"?radarId=").concat(t.radarId)),n.append("type","radar_link")):(n.append("url","".concat(t.url)),n.append("type","normal_link")),t.coverUrl.file){var s=new FormData;s.append("file",t.coverUrl.file),s.append("dir","clientTransformation"),Object(f["m"])(s).then((function(t){n.append("coverUrl",t.data),a(n)})).catch((function(t){i(t)}))}else a(n)}))},getParams:function(t){var e,a,i="";(null===(e=t.selectTagList)||void 0===e?void 0:e.length)>0&&(i=t.selectTagList.map((function(t){return t.tagId})).join(","));var n=new FormData;return t.id&&n.append("id",t.id),null!==(a=t.uploadFile)&&void 0!==a&&a.uid&&n.append("file",t.uploadFile),n.append("mtype",this.selectMaterial),n.append("tag",i),n},upload:function(t){return t.append("belongTo",2),Object(f["x"])(t)},update:function(t){return Object(f["t"])(t)},getTagList:function(){var t=this,e={tagName:this.searchTag||null};Object(f["s"])(e).then((function(e){t.tagList=e.data}))},editTags:function(){this.visibleTag=!0,this.visiblePopover=!1},onSearchName:function(){this.getMaterialList()},isShowTitle:function(t){return![0,1].includes(t)},changePage:function(t,e){this.pagination.current=t,this.getMaterialList()},deleteMaterialItem:function(t){var e=this;this.spinning=!0,Object(f["g"])({id:t}).then((function(t){if(e.$message.success("删除成功"),e.pageList){var a,i=e.pageList.find((function(t){return t.id===e.selectMaterial}));1===(null===i||void 0===i||null===(a=i.list)||void 0===a?void 0:a.length)&&(e.pagination.current=e.pagination.current-1||1)}e.getMaterialList()})).catch((function(){e.$message.error("删除失败")})).finally((function(t){e.spinning=!1}))},deleteMaterial:function(t){var e=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"确定要删除此素材吗？",onOk:function(){e.deleteMaterialItem(t)}})}}},U=I,$=(a("7cf3"),Object(v["a"])(U,i,n,!1,null,"e5d6b9f2",null));e["default"]=$.exports},"90aa":function(t,e,a){"use strict";a("5e1d")},a2ba:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({attrs:{loading:t.loading},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("AddLinkWrap",{ref:"AddLinkWrap",staticClass:"add-link-wrap",attrs:{editData:t.editData,isNeedTag:t.isNeedTag,source:t.source,isNeedRader:t.isNeedRader,isNeedSelectRadar:t.isNeedSelectRadar}})],1)},n=[],s=a("7807"),r=a("2a86"),c={name:"AddLink",components:{AddLinkWrap:s["a"],CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""},loading:{type:Boolean,default:!1},isNeedTag:{type:Boolean,default:!1},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0}},watch:{editData:{handler:function(){this.sourceModal.title=this.editData.id?"修改链接":"添加链接"},immediate:!0}},data:function(){return{sourceModal:{}}},methods:{serviceOk:function(){var t=this;this.$refs.AddLinkWrap.getFormValue()&&this.$refs.AddLinkWrap.$refs.ruleForm.validate((function(e){if(!e)return!1;t.$emit("serviceOk",t.$refs.AddLinkWrap.form)}))}}},o=c,l=(a("d6b1"),a("2877")),d=Object(l["a"])(o,i,n,!1,null,"2002f84d",null);e["a"]=d.exports},b4a4:function(t,e,a){"use strict";a("4e28")},b602:function(t,e,a){},b9cd:function(t,e,a){"use strict";a.d(e,"l",(function(){return i})),a.d(e,"j",(function(){return n})),a.d(e,"o",(function(){return s})),a.d(e,"n",(function(){return r})),a.d(e,"b",(function(){return c})),a.d(e,"g",(function(){return o})),a.d(e,"d",(function(){return l})),a.d(e,"a",(function(){return d})),a.d(e,"f",(function(){return u})),a.d(e,"k",(function(){return p})),a.d(e,"i",(function(){return f})),a.d(e,"e",(function(){return g})),a.d(e,"p",(function(){return m})),a.d(e,"c",(function(){return v})),a.d(e,"h",(function(){return h})),a.d(e,"q",(function(){return b})),a.d(e,"m",(function(){return T}));var i="LOSS_STATUS",n="GROUP_STATUS",s="ORDER_WAY",r="ORDER_CONDITION",c="ADD_WAY",o="GENDER",l="CUSTOMER_STATUS",d={0:"待分配",1:"待添加",2:"待通过",3:"已添加",4:"导入中"},u={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},p=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:1},{text:"已不是好友",color:"#ffd4b6",id:2},{text:"客户接收达上限",color:"#fbe8ae",id:3},{text:"本月消息已经达到上限",color:"",id:4}],f=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:2},{text:"没有群发任务",color:"",id:4}],g={1:"微信",2:"企业微信"},m=[{id:"immediately",value:"立即发送"},{id:"timing",value:"定时发送"}],v={0:"渠道码",1:"区域扫码",2:"自动拉群",3:"一客一码",4:"加好友",5:"通过群码拉群"},h={0:{text:"拉人中",color:"green"},1:{text:"未开始",color:""},2:{text:"已达上限",color:"orange"},3:{text:"已停用",color:"red"}},b={0:{text:"创建失败",color:"green",id:0},1:{text:"待发送",color:"rgba(34,34,34,.85)",id:1},2:{text:"已发送",color:"rgba(34,34,34,.85)",id:2},3:{text:"已取消",color:"rgba(34,34,34,.85)",id:3},4:{text:"提醒发送",color:"#1890ff",id:4}},T=[{text:"文章",id:"0",format:""},{text:"链接",id:"1"},{text:"海报",id:"2",max:2,format:".bmp,.jpg,.jpeg,.png,.tif,.gif,.pcx,.tga,.exif,.fpx,.svg,.psd,.cdr,.pcd,.dxf,.ufo,.eps,.ai,.raw,.WMF,.webp",tips:"请上传png、jpg格式不超过2M的文件"},{text:"视频",id:"7",max:2e5,format:".MP4",tips:"请上传格式为MP4的视频文件"},{text:"PDF",id:"3",max:20,format:".pdf",icon:"/icons/pdf.png",tips:"请上传PDF格式不超过20M的文件"},{text:"PPT",id:"4",max:20,format:".pptx,.ppt,.pps",icon:"/icons/ppt.svg",tips:"请上传PPT格式不超过20M的文件"},{text:"表格",id:"5",max:20,format:".xlsx,.xls,.csv",icon:"/icons/excel.svg",tips:"请上传csv、xlsx格式不超过20M的文件"},{text:"文档",id:"6",max:20,format:".txt,.doc,.docx",icon:"/icons/word.svg",tips:"请上传doc、txt.docx格式不超过20M的文件"}]},d0d5:function(t,e,a){"use strict";a("fa50")},d6b1:function(t,e,a){"use strict";a("260e")},ecc3:function(t,e,a){},fa50:function(t,e,a){}}]);