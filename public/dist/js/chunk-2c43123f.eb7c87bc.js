(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c43123f"],{"11d6":function(t,a,e){"use strict";e("9400")},"161b":function(t,a,e){"use strict";e.d(a,"a",(function(){return r})),e.d(a,"b",(function(){return o})),e.d(a,"c",(function(){return s}));var i=e("b775"),n={queryGroupPageByGroupSop:"/client_group/customerGroup/queryGroupPageByGroupSop",addOrEditGroupTag:"/client_group/groupTagController/addOrEditGroupTag",delGroupTag:"/client_group/groupTagController/delGroupTag",queryGroupTag:"/client_group/groupTagController/queryGroupTag"};function r(t){return Object(i["b"])({url:n.addOrEditGroupTag,method:"post",data:t})}function o(t){return Object(i["b"])({url:n.delGroupTag,method:"post",data:t})}function s(t){return Object(i["b"])({url:n.queryGroupTag,method:"post",data:t})}},2909:function(t,a,e){"use strict";e.d(a,"a",(function(){return u}));var i=e("6b75");function n(t){if(Array.isArray(t))return Object(i["a"])(t)}e("a4d3"),e("e01a"),e("d3b7"),e("d28b"),e("3ca3"),e("ddb0"),e("a630");function r(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var o=e("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function u(t){return n(t)||r(t)||Object(o["a"])(t)||s()}},3538:function(t,a,e){"use strict";e("8eae")},"3afd":function(t,a,e){"use strict";e.r(a);var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"page-box"},[a("section",{staticClass:"group-tag-section"},[a("a-row",{staticClass:"tag-manage-header",attrs:{type:"flex",justify:"space-between"}},[a("a-col",[a("div",{staticClass:"tabBar-extra-content"},[a("a-button",{staticClass:"add-member",attrs:{type:"primary"},on:{click:t.addGroupTag}},[t._v("新建群标签组")])],1)])],1)],1),a("section",{staticClass:"user-tag-panel"},[a("a-list",{attrs:{"data-source":t.DataGroupList},scopedSlots:t._u([{key:"renderItem",fn:function(e){return a("a-list-item",{},[a("div",{staticClass:"tag-group-name"},[t._v(t._s(e.grpTagName))]),a("div",{staticClass:"center col-1"},[a("a-list-item",[a("TagComponents",{attrs:{tagslist:e}})],1)],1),a("a-button",{staticStyle:{color:"#777"},attrs:{type:"link"},on:{click:function(a){return t.EditModal(e)}}},[a("a-icon",{attrs:{type:"form"}}),t._v("修改 ")],1),a("a-button",{staticStyle:{color:"#777"},attrs:{type:"link"},on:{click:function(a){return t.deleteTag(e.grpTagId)}}},[a("a-icon",{attrs:{type:"delete"}}),t._v("删除 ")],1)],1)}}])})],1),a("a-modal",{attrs:{footer:null,"confirm-loading":t.confirmLoading,width:"599px",destroyOnClose:""},model:{value:t.visible,callback:function(a){t.visible=a},expression:"visible"}},[a("NewLabelgroup",{attrs:{tagDetail:t.tagDetail},on:{cancle:function(a){t.visible=!1},serviceOk:t.serviceOk}})],1)],1)},n=[],r=e("9c6d"),o=(e("fb6a"),function(){var t=this,a=t._self._c;return a("div",{staticClass:"tag-but"},[a("a-button",{staticClass:"add-tag-button",attrs:{size:"small"},on:{click:t.showInput}},[a("a-icon",{attrs:{type:"plus"}}),t._v("添加")],1),t.inputVisible?a("a-input",{ref:"input",style:{width:"120px"},attrs:{type:"text",size:"small",inputVisible:"false"},on:{blur:t.handleInputConfirm,keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleInputConfirm.apply(null,arguments)}},model:{value:t.inputValue,callback:function(a){t.inputValue=a},expression:"inputValue"}}):t._e(),t._l(t.tagslist.tags,(function(e,i){return[e.tagName.length>20?a("a-tooltip",{key:i},[a("a-tag",{key:e.tagName},[t._v(" "+t._s("".concat(e.tagName.slice(0,20),"..."))+" ")])],1):a("a-tag",{key:i},[t._v(" "+t._s(e.tagName)+" ")])]}))],2)}),s=[],u=e("2909"),l=(e("498a"),e("d81d"),e("caad"),e("2532"),e("99af"),e("161b")),c={data:function(){return{inputVisible:!1,inputValue:"",index:""}},props:["tagslist"],methods:{showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},cancle:function(){this.inputValue="",this.inputVisible=!1},handleInputConfirm:function(){var t=this,a=this.inputValue.trim();if(a){var e=this.tagslist.tags,i={tagName:a},n=e.map((function(t){return t.tagName}));if(n.includes(i.tagName))this.$message.warning("存在重复标签");else{var r=this.getAddParams(a);Object(l["a"])(r).then((function(){a&&(e=[].concat(Object(u["a"])(e),[i])),t.tagslist.tags=e,t.$message.success("添加标签成功"),t.cancle()})).catch((function(a){t.$message.error("标签添加失败")}))}}else this.inputValue=""},getAddParams:function(t){var a={tagGroupGrpId:this.tagslist.grpTagId,tagGrpName:this.tagslist.grpTagName,addOrEditTags:[{tagName:t}],departments:[]};return a}}},d=c,g=(e("7747"),e("2877")),p=Object(g["a"])(d,o,s,!1,null,"dd7d4124",null),m=p.exports,f={name:"GroupTages",data:function(){return{tagDetail:{},wxDepId:"",visible:!1,DataGroupList:[],confirmLoading:!1,visibleEdit:!1,loading:!1,treeData:[]}},components:{NewLabelgroup:r["a"],TagComponents:m},created:function(){this.getGroupList()},methods:{addGroupTag:function(){this.tagDetail={},this.visible=!0},deleteTag:function(t){var a=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"确认后将会删除该条客户群标签，是否删除",onOk:function(){a.delGroupTag(t)}})},delGroupTag:function(t){var a=this;Object(l["b"])({tagId:t}).then((function(){a.$message.success("删除标签组成功"),a.getGroupList()})).catch((function(t){a.$message.error(t)}))},serviceOk:function(){this.visible=!1,this.getGroupList()},EditModal:function(t){this.tagDetail=t,this.visible=!0},getGroupList:function(){var t=this,a={grpName:""};return Object(l["c"])(a).then((function(a){t.DataGroupList=(null===a||void 0===a?void 0:a.data)||[]})).catch((function(a){t.$message.error(a)}))}}},h=f,b=(e("76be"),Object(g["a"])(h,i,n,!1,null,"10688dcd",null));a["default"]=b.exports},"76be":function(t,a,e){"use strict";e("9e63")},7747:function(t,a,e){"use strict";e("bcc1")},"8eae":function(t,a,e){},9400:function(t,a,e){},"9c6d":function(t,a,e){"use strict";var i=function(){var t=this,a=t._self._c;return a("div",{staticClass:"add-tags"},[a("section",{attrs:{id:"operator-tag-group-dialog"}},[a("p",{staticClass:"dialog-title dialog-tag-title"},[t._v(" "+t._s(t.statusText)+"标签组 ")]),a("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("div",{staticClass:"blue-tips-filled"},[a("a-icon",{staticStyle:{color:"#1890ff"},attrs:{type:"bell",theme:"filled"}}),t._v(" 管理员可根据不同部门选择展示不同的标签组，部门管理员可创建部门可见的标签 ")],1),a("a-form-model-item",{attrs:{label:"标签组名称",prop:"tagGroupName"}},[a("a-input",{staticClass:"tags-name",attrs:{placeholder:"请输入标签组名称",maxLength:15},model:{value:t.form.tagGroupName,callback:function(a){t.$set(t.form,"tagGroupName",a)},expression:"form.tagGroupName"}})],1),a("FormlabelAdd",{attrs:{form:t.form}})],1)],1),a("div",{staticClass:"foot-button"},[a("a-space",{attrs:{size:12}},[a("a-button",{on:{click:function(a){return t.$emit("cancle")}}},[t._v("取消")]),a("a-button",{attrs:{type:"primary"},on:{click:function(a){return t.submitForm("ruleForm")}}},[t._v("确定")])],1)],1)])},n=[],r=(e("d81d"),e("d3b7"),e("99af"),e("159b"),e("c740"),e("a434"),function(){var t=this,a=t._self._c;return a("div",[t._l(t.form.tagList,(function(e,i){return a("a-form-model-item",t._b({key:e.key,attrs:{prop:"tagList",label:0===i?"标签名称":"",rules:{required:!0,message:"标签名称不能为空"}}},"a-form-model-item",0===i?t.formItemLayout:t.formItemLayoutWithOutLabel,!1),[a("a-input",{staticStyle:{width:"60%","margin-right":"8px"},attrs:{placeholder:"请输入标签名称",maxLength:10},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"domain.value"}}),t.form.tagList.length>1?a("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===t.form.tagList.length},on:{click:function(a){return t.removeDomain(e)}}}):t._e()],1)})),a("a-form-model-item",{attrs:{"wrapper-col":{offset:3}}},[a("a-button",{attrs:{type:"link"},on:{click:t.addDomain}},[a("a-icon",{attrs:{type:"plus-circle"}}),t._v(" 添加标签 ")],1)],1)],2)}),o=[],s={name:"FormlabelAdd",props:{form:{type:[Object],default:function(){return{}}}},data:function(){return{formItemLayout:{labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:20}}},formItemLayoutWithOutLabel:{wrapperCol:{xs:{span:24,offset:0},sm:{span:20,offset:4}}}}},methods:{removeDomain:function(t){var a=this.form.tagList.indexOf(t);-1!==a&&this.form.tagList.splice(a,1)},addDomain:function(){this.form.tagList.push({value:"",key:Date.now()})}}},u=s,l=(e("11d6"),e("2877")),c=Object(l["a"])(u,r,o,!1,null,"48498136",null),d=c.exports,g=e("161b"),p={props:{tagDetail:{type:[Object],default:function(){return{}}}},computed:{statusText:function(){return this.tagDetail.grpTagId?"修改":"新增"}},data:function(){return{formLayout:"horizontal",labelCol:{span:4},wrapperCol:{span:14},selectList:[],form:{tagGroupName:"",scope:0,tagList:[{value:"",key:Date.now()}]},rules:{tagGroupName:[{required:!0,message:"标签组名称不能为空"}],tagList:[{required:!0,message:"标签名称不能为空"}]}}},created:function(){var t;null!==(t=this.tagDetail)&&void 0!==t&&t.grpTagId&&(this.form={tagGroupName:this.tagDetail.grpTagName,tagList:this.tagDetail.tags.map((function(t){return{value:t.tagName,key:t.tagId,tagId:t.tagId}}))})},components:{FormlabelAdd:d},methods:{selectPerson:function(t){this.selectList=t},submitForm:function(t){var a=this;this.$refs[t].validate((function(t){if(!t)return!1;a.validate().then((function(){a.addOrEditGroupTag()})).catch((function(t){a.$message.warning(t.message||t)}))}))},validate:function(){var t=this;return new Promise((function(a,e){1===t.form.scope&&t.selectList.length<1&&e("请选择部门");for(var i=t.form.tagList,n=0;n<i.length;n++){var r=i[n];r.value||e("请填写标签名称");for(var o=n+1;o<i.length;o++)r.value===i[o].value&&e("第".concat(n+1,"个和第").concat(o+1,"个标签名重复"))}a()}))},getAddParams:function(){var t,a={tagGrpName:this.form.tagGroupName,addOrEditTags:null===(t=this.form.tagList)||void 0===t?void 0:t.map((function(t){return{tagName:t.value}})),departments:[]};return a},getEditParams:function(){var t,a,e=this,i=[],n=[];this.tagDetail.tags.forEach((function(t){var a=e.form.tagList.findIndex((function(a){if(t.tagId===a.tagId)return a}));a<0&&i.push({tagName:t.tagName,tagId:t.tagId})})),this.form.tagList.forEach((function(t){t.tagId?e.tagDetail.tags.forEach((function(a){a.tagId===t.tagId&&a.tagName!==t.value&&n.push({tagName:t.value,tagId:a.tagId})})):n.push({tagName:t.value})})),null===(t=this.form.tagList)||void 0===t||t.map((function(t){return{tagName:t.value,tagId:t.tagId}}));var r={tagGroupGrpId:this.tagDetail.grpTagId,tagGrpName:this.form.tagGroupName,delTags:i,addOrEditTags:n,departments:null===(a=this.selectList)||void 0===a?void 0:a.map((function(t){return{wxDepartmentId:t.source.wxDepartmentId}}))};return r},addOrEditGroupTag:function(){var t,a=this,e=null!==(t=this.tagDetail)&&void 0!==t&&t.grpTagId?this.getEditParams():this.getAddParams();Object(g["a"])(e).then((function(){a.$message.success("".concat(a.statusText,"标签成功")),a.$emit("serviceOk")})).catch((function(t){a.$message.error(t)}))},removeDomain:function(t){var a=this.form.tagList.indexOf(t);-1!==a&&this.form.tagList.splice(a,1)}}},m=p,f=(e("3538"),Object(l["a"])(m,i,n,!1,null,"c2e3eeda",null));a["a"]=f.exports},"9e63":function(t,a,e){},bcc1:function(t,a,e){}}]);