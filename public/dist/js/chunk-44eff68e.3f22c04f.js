(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-44eff68e"],{"0cd2":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[e("h6",[t._v("如何添加成员")]),e("div",{staticClass:"add-role-modal"},[e("p",{staticClass:"top-hint-box"},[t._v("此处显示的成员均为授权给"+t._s(t.ENTERPRICE_NAME)+"的成员，如需添加成员请去企业微信授权，如有疑问可以 "),e("a",[t._v("联系客服")])]),e("h4",[e("a-icon",{attrs:{type:"info-circle"}}),t._v(" 进入"),e("a",{attrs:{href:"https://work.weixin.qq.com/wework_admin/frame#apps",target:"_blank"}},[t._v("企业微信")]),t._v(" ，找到【应用管理】-【应用】-【自建应用】下的"),e("span",{staticClass:"text-black"},[e("b",[t._v("【"+t._s(t.ENTERPRICE_NAME)+"提醒】")])])],1),e("img",{attrs:{alt:"如何添加成员",src:"/imgs/addRole1.png"}}),e("h4",[e("a-icon",{attrs:{type:"info-circle"}}),t._v(" 打开"+t._s(t.ENTERPRICE_NAME)+"提醒，点击【编辑】，在【使用范围】内修改或添加成员 ")],1),e("img",{attrs:{alt:"如何添加成员",src:"/imgs/addRole2.png"}})])])},n=[],s={name:"AddRoleModal"},r=s,o=(a("e1b8"),a("2877")),c=Object(o["a"])(r,i,n,!1,null,"63db7446",null);e["a"]=c.exports},"1bee":function(t,e,a){"use strict";a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"b",(function(){return s}));a("a9e3"),a("ac1f"),a("5319"),a("4d63"),a("25f0");function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss",a=e,i=new Date(Number(t)),n={"M+":i.getMonth()+1,"D+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),"S+":i.getMilliseconds()};for(var s in/(y+)/i.test(a)&&(a=a.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+s+")").test(a)&&(a=a.replace(RegExp.$1,1===RegExp.$1.length?n[s]:("00"+n[s]).substr((""+n[s]).length)));return a}function n(t){var e=parseInt(t/3600)<10?"0"+parseInt(t/3600):parseInt(t/3600),a=parseInt(t%3600/60)<10?"0"+parseInt(t%3600/60):parseInt(t%3600/60);return e+":"+a}function s(t,e){var a=Date.parse(new Date),i=r(a,t),n=new Date(i),s=n.getTime(),o=r(a,e),c=new Date(o),l=c.getTime();return"start"?s>=l:l<=s}function r(t,e){var a=new Date(t),i=a.getFullYear()+"-",n=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",s=a.getDate()+" ";a.getHours(),a.getMinutes(),a.getSeconds();return i+n+s+e+":00"}},2314:function(t,e,a){"use strict";a("afd2")},"260e":function(t,e,a){},"281e":function(t,e,a){"use strict";a("3458")},"299d":function(t,e,a){},"2bf4":function(t,e,a){"use strict";var i=a("2909"),n=a("5530"),s=(a("d3b7"),a("d81d"),a("3ca3"),a("ddb0"),a("9911"),a("a15b"),a("a9e3"),a("d885")),r=a("cf5f");e["a"]={methods:{addAccessory:function(t){this.attachments=t},uploadMedia:function(t){var e=this,a=t||this.attachments;return new Promise((function(t,i){var n=(null===a||void 0===a?void 0:a.map((function(t){return new Promise((function(a,i){if("link"===t.type)e.interactiveRadarAdd(t).then((function(t){a(t)}));else if("img"===t.type&&t.pic_url.file){var n=new FormData;n.append("file",t.pic_url.file),n.append("dir","clientTransformation"),n.append("type","image"),Object(r["y"])(n).then((function(e){t.pic_url.fileUrl=e.data.fileUrl,t.pic_url.mediaId=e.data.mediaId,a(e.data)}))}else a()}))})))||[];Promise.all(n).then((function(e){t()})).catch((function(t){e.$message.error(t||t.message),e.loading=!1,i(t)}))}))},channelCodeUploadFileFun:function(t){var e=this,a=t||this.attachments;return new Promise((function(t,i){var n=(null===a||void 0===a?void 0:a.map((function(t){return new Promise((function(a,i){if("link"===t.type)e.interactiveRadarAdd(t).then((function(t){a(t)}));else if("img"===t.type&&t.pic_url.file){var n=new FormData;n.append("file",t.pic_url.file),Object(r["d"])(n).then((function(e){t.pic_url.fileUrl=e.data.fileUrl,t.pic_url.mediaId=e.data.mediaId,a(e.data)}))}else a()}))})))||[];Promise.all(n).then((function(e){t()})).catch((function(t){e.$message.error(t||t.message),e.loading=!1,i(t)}))}))},getAttachments:function(t){var e=t||this.attachments;return null===e||void 0===e?void 0:e.map((function(t){if("img"===t.type)return{msgtype:"image",image:{media_id:t.pic_url.mediaId,pic_url:t.pic_url.fileUrl||t.pic_url.compress,title:t.title}};if("link"===t.type){var e="normal_link";t.linktype?e=t.linktype:t.radarId&&(e="radar_link");var a=t.radarId||t.formId||t.id;return a&&(a=String(a)),{msgtype:"link",link:{title:t.linkTitle,picurl:t.picurl||t.coverUrl.compress,desc:t.desc,url:t.url||t.link||t.activityLink,radarId:a,type:e}}}}))},interactiveRadarAdd:function(t){var e=this;return new Promise((function(a,i){e.getParamsLink(t).then((function(e){t.isRadar&&t.randerIsEdit?Object(s["f"])(e).then((function(e){t.radarId=e.data.radarId,t.url=e.data.radarLink+t.source,a(e)})).catch((function(t){i(t)})):a()}))}))},getParamsLink:function(t){return new Promise((function(e,a){var i=new FormData,n=t.isCustomerTag?[{autoMarkTagBitmaps:t.selectCustomerTagList.map((function(t){return t.bitmap})).join(",")}]:[];if(i.append("type",1),i.append("radarName",t.linkTitle),i.append("link",t.url),i.append("activityNotify",Number(t.activityNotify)),i.append("behaviorNotify",Number(t.behaviorNotify)),i.append("tagRule",JSON.stringify(n)),i.append("title",t.radarTitle),i.append("desc",t.desc),i.append("hasCustomerTag",Number(t.isCustomerTag)),t.isScoreRule){var s=JSON.stringify(t.ruleDetails.map((function(t){var e,a;return{autoMarkTagBitmaps:null===(e=t.selectTagList)||void 0===e||null===(a=e.map((function(t){return t.bitmap})))||void 0===a?void 0:a.join(","),hasTag:Number(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count||0}})));i.append("scoreRule",s)}if(t.coverUrl.file){var o=new FormData;o.append("file",t.coverUrl.file),o.append("dir","clientTransformation"),Object(r["m"])(o).then((function(a){i.append("coverUrl",a.data),t.picurl=a.data,e(i)})).catch((function(t){a(t)}))}else e(i)}))},attachmentsDetail:function(t){return null===t||void 0===t?void 0:t.map((function(t){var e,a,i,s,r,o="",c="",l="",u="",d={};("image"===t.msgtype&&(o="图文",c="visibileAddImg",u="img",l={compress:t.image.pic_url}),"link"===t.msgtype)&&(u="link",t.linktype=t.link.type,"radar_link"!==t.linktype&&"normal_link"!==t.linktype||(c="visibileAddLink",o="链接"),"form_link"===t.linktype&&(c="visibileForm",o="自定义表单"),"luck_link"===t.linktype&&(c="visibileLuckDraw",o="抽奖活动"),d={compress:t.link.picurl},t.linkTitle=t.link.title,t.desc=t.link.desc,t.url=t.link.url,t.link.interactRadar&&(t.isRadar=!0,t.behaviorNotify=Boolean(t.link.interactRadar.behaviorNotify),t.activityNotify=Boolean(t.link.interactRadar.activityNotify),t.isCustomerTag=(null===(e=t.link.interactRadar.tagRules)||void 0===e?void 0:e.length)>0,t.radarId=null===(a=t.link.interactRadar)||void 0===a?void 0:a.radarId,t.radarTitle=t.link.title,t.selectCustomerTagList=null===(i=t.link.interactRadar.tagRules[0])||void 0===i||null===(s=i.customerTags)||void 0===s?void 0:s.map((function(t){return Object(n["a"])(Object(n["a"])({},t),{},{key:t.tagId})})),t.isScoreRule=(null===(r=t.link.interactRadar.scoreRules)||void 0===r?void 0:r.length)>0,t.ruleDetails=t.link.interactRadar.scoreRules.map((function(t){var e;return Object(n["a"])(Object(n["a"])({},t),{},{autoMarkTagBitmaps:t.autoMarkTagBitmaps,selectTagList:null===(e=t.customerTags)||void 0===e?void 0:e.map((function(t){return Object(n["a"])(Object(n["a"])({},t),{},{key:t.tagId})})),hasTag:Boolean(t.hasTag),score:t.score,ruleKind:t.ruleKind,count:t.count})}))));return Object(n["a"])(Object(n["a"])({},t),{},{key:c,pic_url:l,type:u,coverUrl:d,typeText:o})}))}},computed:{state:function(){return this.$route.query.state},isAddText:function(){return"add"===this.$route.query.state?"新建":"修改"},textList:function(){var t=[];return this.messageOne&&t.push(this.messageOne),this.attachments&&t.push.apply(t,Object(i["a"])(this.attachments)),t}}}},3458:function(t,e,a){},"3de3":function(t,e,a){"use strict";a("95d0")},"3fc5":function(t,e,a){},"74a4":function(t,e,a){"use strict";a("9e0d")},7581:function(t,e,a){"use strict";a("b0c0");var i=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.pageList.length>0?e("ul",{staticClass:"randar-list-wrap"},t._l(t.pageList,(function(a){return e("li",{key:a.formId,staticClass:"randar-list",on:{click:function(e){t.selectRandarId=a.formId}}},[e("header",{staticClass:"randar-head"},[e("div"),e("a-checkbox",{attrs:{checked:t.selectRandarId===a.formId}})],1),e("section",{staticClass:"randar-main"},[e("div",{staticClass:"randar-main-content"},[e("p",[t._v(t._s(a.name))]),e("p",{staticClass:"aks-tips"},[t._v(t._s(a.describe))])]),e("a-avatar",{attrs:{size:40,src:a.cover,shape:"square"}})],1)])})),0):e("a-empty"),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e(),!t.loading&&t.pageList.length>0?e("div",{staticClass:"loading-container"},[t._v("没有更多数据了")]):t._e()],1)])},n=[],s=a("2909"),r=(a("7db0"),a("d3b7"),a("2a86")),o=a("487a"),c=a.n(o),l=a("8f19"),u={name:"AddForm",directives:{infiniteScroll:c.a},components:{CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""}},data:function(){return{sourceModal:{title:"自定义表单"},pagination:{current:1,pageSize:10,total:0},form:{typeText:"自定义表单",type:"link",linkTitle:"",desc:"",coverUrl:{compress:""}},type:"",typeText:{1:"链接",2:"PDF",3:"文章",4:"文章"},typeImg:{1:"/imgs/default-cover.png",2:"/icons/pdf.png",3:"/imgs/default-cover.png",4:"/imgs/default-cover.png"},radarName:"",loading:!1,busy:!1,pageList:[],selectRandarId:""}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{serviceOk:function(){var t=this;if(this.selectRandarId){var e=this.pageList.find((function(e){return e.formId===t.selectRandarId}));e.typeText="自定义表单",e.linkTitle=e.name,e.desc=e.describe,e.type="link",e.key="visibileForm",e.linktype="form_link",e.coverUrl={compress:e.cover},this.$emit("serviceOk",e)}else this.$message.warning("请选择一个自定义表单")},init:function(){var t=this,e={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,source:this.source,status:1};this.loading=!0,Object(l["f"])(e).then((function(e){var a;e.data.list.length>0&&(a=t.pageList).push.apply(a,Object(s["a"])(e.data.list));if(t.pagination.current++,e.data.list.length<t.pagination.pageSize)return t.busy=!0,void(t.loading=!1);t.pagination.total=e.data.total})).catch((function(e){t.$message.error(e||e.message)}))},selectTab:function(t){this.type=t,this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},search:function(){this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},handleInfiniteOnLoad:function(){!this.busy&&this.init()}}},d=u,m=(a("2314"),a("2877")),f=Object(m["a"])(d,i,n,!1,null,"66fbf478",null);e["a"]=f.exports},"78fc":function(t,e,a){"use strict";a("d631")},"7a44":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",[e("ul",{staticClass:"list-wrap"},t._l(t.attachments,(function(a,i){return e("li",{key:i,staticClass:"list"},[e("div",[e("a-icon",{staticClass:"button",attrs:{type:"minus-circle"},on:{click:function(e){return t.deleteAttachments(i)}}}),t._v(" 【"+t._s(a.typeText)+"】: "+t._s(a.title||a.linkTitle)+" ")],1),e("a-icon",{staticClass:"button",attrs:{type:"form"},on:{click:function(e){return t.editAttachments(a,i)}}})],1)})),0),e("a-dropdown",{attrs:{placement:"topCenter",trigger:["click"]}},[e("a-button",{staticClass:"add-button",attrs:{type:"link",block:"",size:"large"}},[e("a-icon",{attrs:{type:"plus-circle"}}),t._v(" 添加附件 ")],1),e("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},t._l(t.menuList,(function(a){return e("a-menu-item",{key:a.id,on:{click:function(e){return t.openAccessory(a.key)}}},[t._v(" "+t._s(a.text)+" ")])})),1)],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"580px"},model:{value:t.visibileAddImg,callback:function(e){t.visibileAddImg=e},expression:"visibileAddImg"}},[e("AddImg",{attrs:{editData:t.editData},on:{cancle:function(e){t.visibileAddImg=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"580px"},model:{value:t.visibileAddLink,callback:function(e){t.visibileAddLink=e},expression:"visibileAddLink"}},[e("AddLink",{attrs:{editData:t.editData,source:t.source,isNeedSelectRadar:t.isNeedSelectRadar,isNeedRader:t.isNeedRader},on:{cancle:function(e){t.visibileAddLink=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"880px"},model:{value:t.visibileForm,callback:function(e){t.visibileForm=e},expression:"visibileForm"}},[e("AddForm",{attrs:{editData:t.editData,source:t.source},on:{cancle:function(e){t.visibileForm=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"880px"},model:{value:t.visibileLuckDraw,callback:function(e){t.visibileLuckDraw=e},expression:"visibileLuckDraw"}},[e("AddluckyDraw",{attrs:{editData:t.editData,source:t.source},on:{cancle:function(e){t.visibileLuckDraw=!1},serviceOk:t.serviceOk}})],1)],1)},n=[],s=(a("a9e3"),a("a434"),function(){var t=this,e=t._self._c;return e("CommonModal",t._b({attrs:{loading:t.loading},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.source,!1),[e("a-form-model",{ref:"ruleForm",attrs:{model:t.form,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},t._l(t.formInfoList,(function(t,a){return e("a-form-model-item",{key:a,attrs:{label:t.title,prop:t.prop}},[e("FormList",{staticClass:"input",attrs:{formInfo:t}})],1)})),1)],1)}),r=[],o=(a("d3b7"),a("159b"),a("2a86")),c=a("26f2"),l={name:"AddImg",components:{CommonModal:o["a"],FormList:c["a"]},props:{editData:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},data:function(){return{source:{title:"添加图片"},labelCol:{span:4},wrapperCol:{span:6},formInfoList:[{title:"图片标题",prop:"title",type:"input",tips:"请输入图片标题",maxLength:30,value:""},{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}}],form:{pic_url:{},title:"",type:"img",typeText:"图片",key:"visibileAddImg"},rules:{title:[{required:!1,message:"未填写图片标题"}],pic_url:[{required:!0,message:"未选择图片"}]}}},watch:{editData:{handler:function(){var t;null!==(t=this.editData)&&void 0!==t&&t.type&&(this.form.title=this.editData.title||"",this.form.pic_url=this.editData.pic_url,this.getlistValue())},immediate:!0}},methods:{serviceOk:function(){var t=this;this.getFormValue()&&this.$refs.ruleForm.validate((function(e){if(!e)return!1;t.form.pic_url.compress?t.$emit("serviceOk",t.form):t.$message.warning("图片没有上传")}))},getFormValue:function(){var t=this;return this.formInfoList.forEach((function(e){e.type,t.form[e.prop]=e.value})),!0},getlistValue:function(){var t=this;this.formInfoList.forEach((function(e){e.type,e.value=t.form[e.prop]}))}}},u=l,d=(a("f564"),a("2877")),m=Object(d["a"])(u,s,r,!1,null,"cd8ffb1e",null),f=m.exports,p=a("a2ba"),h=a("7581"),g=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.pageList.length>0?e("ul",{staticClass:"randar-list-wrap"},t._l(t.pageList,(function(a){return e("li",{key:a.id,staticClass:"randar-list",on:{click:function(e){t.selectRandarId=a.id}}},[e("header",{staticClass:"randar-head"},[e("div"),e("a-checkbox",{attrs:{checked:t.selectRandarId===a.id}})],1),e("section",{staticClass:"randar-main"},[e("div",{staticClass:"randar-main-content"},[e("p",[t._v(t._s(a.activityName))]),e("p",{staticClass:"aks-tips"},[t._v(t._s(a.activityExplain))])]),e("a-avatar",{attrs:{size:40,src:a.cover,shape:"square"}})],1)])})),0):e("a-empty"),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e(),!t.loading&&t.pageList.length>0?e("div",{staticClass:"loading-container"},[t._v("没有更多数据了")]):t._e()],1)])},v=[],b=a("2909"),k=(a("7db0"),a("487a")),L=a.n(k),y=a("8bac"),w={name:"AddluckyDraw",directives:{infiniteScroll:L.a},components:{CommonModal:o["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""}},data:function(){return{sourceModal:{title:"抽奖活动"},pagination:{current:1,pageSize:10,total:0},form:{typeText:"抽奖活动",type:"link",linkTitle:"",desc:"",key:"visibileLuckDraw",coverUrl:{compress:""}},type:"",typeImg:{1:"/imgs/default-cover.png",2:"/icons/pdf.png",3:"/imgs/default-cover.png",4:"/imgs/default-cover.png"},radarName:"",loading:!1,busy:!1,pageList:[],selectRandarId:""}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{serviceOk:function(){var t=this;if(this.selectRandarId){var e=this.pageList.find((function(e){return e.id===t.selectRandarId}));e.typeText="抽奖活动",e.linkTitle=e.activityName,e.desc=e.activityExplain,e.type="link",e.key="visibileLuckDraw",e.linktype="luck_link",e.coverUrl={compress:e.cover},this.$emit("serviceOk",e)}else this.$message.warning("请选择一个自定义表单")},init:function(){var t=this,e={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,source:this.source,name:"",status:1};this.loading=!0,Object(y["f"])(e).then((function(e){var a;e.data.list.length>0&&((a=t.pageList).push.apply(a,Object(b["a"])(e.data.list)),t.pageList.forEach((function(t){t.cover="https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/h5/img/luckyBg.png"})));if(t.pagination.current++,e.data.list.length<t.pagination.pageSize)return t.busy=!0,void(t.loading=!1);t.pagination.total=e.data.total})).catch((function(e){t.$message.error(e||e.message)}))},selectTab:function(t){this.type=t,this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},search:function(){this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},handleInfiniteOnLoad:function(){!this.busy&&this.init()}}},T=w,x=(a("3de3"),Object(d["a"])(T,g,v,!1,null,"ec688aec",null)),_=x.exports,C={name:"Accessory",components:{AddImg:f,AddLink:p["a"],AddForm:h["a"],AddluckyDraw:_},props:{source:{type:String,default:""},maxLength:{type:Number,default:9},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0},attachmentsWrap:{type:Array,default:function(){return[]}},menuList:{type:Array,default:function(){return[{text:"图片",id:1,key:"visibileAddImg"},{text:"链接",id:2,key:"visibileAddLink"},{text:"自定义表单",id:4,key:"visibileForm"},{text:"抽奖活动",id:5,key:"visibileLuckDraw"}]}}},data:function(){return{visibileAddImg:!1,visibileAddLink:!1,visibileForm:!1,visibileLuckDraw:!1,key:"",editData:{},editIndex:void 0,attachments:[]}},watch:{attachmentsWrap:{handler:function(){this.attachments=this.attachmentsWrap},deep:!0,immediate:!0}},methods:{openAccessory:function(t){this.attachments.length>=this.maxLength?this.$message.warning("最多上传".concat(this.maxLength,"个附件")):(this.editData={},this.editIndex=void 0,this.key=t,this[this.key]=!0)},serviceOk:function(t){void 0===this.editIndex?this.attachments.length>=this.maxLength?this.$message.warning("最多上传".concat(this.maxLength,"个附件")):this.attachments.push(t):this.$set(this.attachments,this.editIndex,t),this[this.key]=!1,this.$emit("serviceOk",this.attachments)},deleteAttachments:function(t){this.attachments.splice(t,1)},editAttachments:function(t,e){this.editData=t,this.editIndex=e,this.key=t.key,this[this.key]=!0}}},S=C,O=(a("8897"),Object(d["a"])(S,i,n,!1,null,"6cd29031",null));e["a"]=O.exports},"888c":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"qrcode-wrap"},[e("div",{staticClass:"qr-code"},[e("img",{staticClass:"qr-img",attrs:{src:t.imgUrlCode,alt:"二维码"}}),t.urlCode?t._e():e("img",{staticClass:"qr-header",attrs:{src:t.defaultLogo}}),t.imageUrl?e("img",{staticClass:"qr-header",attrs:{src:t.imageUrl}}):t._e()]),e("a-upload",{staticClass:"avatar-uploader",attrs:{name:"avatar","list-type":"picture-card",accept:t.accept,"file-list":t.fileList,customRequest:t.customRequest},on:{preview:t.handlePreview,change:t.handleChange}},[e("div",[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(" "+t._s(t.title)+" ")])],1)]),e("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:function(e){t.previewVisible=!1}}},[e("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.imageUrl}})])],1)},n=[],s=a("ca00"),r={name:"CodePreview",props:{urlCode:{type:[String],default:""},qrCode:{type:[String],default:""},title:{type:[String],default:"选择图片"},state:{type:[String],default:"add"}},data:function(){return{accept:".bmp,.jpg,.jpeg,.png,.tif,.gif,.pcx,.tga,.exif,.fpx,.svg,.psd,.cdr,.pcd,.dxf,.ufo,.eps,.ai,.raw,.WMF,.webp",previewVisible:!1,imageUrl:"",fileList:[],defaultUrl:"/imgs/qr-preview.png",defaultLogo:"/imgs/default-logo.png"}},watch:{imgUrlQr:function(){var t=this;this.imageUrl&&Object(s["q"])(this.imgUrlQr,this.imageUrl).then((function(e){t.qrcodeCallback(e)}))}},activated:function(){this.imageUrl="",this.previewVisible=!1,this.fileList=[]},computed:{imgUrlCode:function(){return this.urlCode||this.defaultUrl},imgUrlQr:function(){return this.qrCode||this.defaultUrl}},mounted:function(){var t=this;"add"===this.state&&Object(s["q"])(this.imgUrlQr,this.defaultLogo).then((function(e){t.qrcodeCallback(e)}))},methods:{customRequest:function(t){t.onSuccess()},handlePreview:function(t){this.previewVisible=!0},getBase64:function(t,e){var a=new FileReader;a.addEventListener("load",(function(){return e(a.result)})),a.readAsDataURL(t)},handleChange:function(t){var e=this;this.$emit("qrcodeInfo",t),"uploading"===t.file.status&&(this.getBase64(t.file.originFileObj,(function(t){e.imageUrl=t,Object(s["q"])(e.imgUrlQr,e.imageUrl).then((function(t){e.qrcodeCallback(t)}))})),this.fileList=[t.fileList[t.fileList.length-1]],this.fileList[0].status="done"),"removed"===t.file.status&&(this.fileList=[],this.imageUrl="")},qrcodeCallback:function(t){this.$emit("qrcodeCallback",{base64:t,imageUrl:this.imageUrl})}}},o=r,c=(a("c59a"),a("2877")),l=Object(c["a"])(o,i,n,!1,null,"5625656c",null);e["a"]=l.exports},8897:function(t,e,a){"use strict";a("e53d")},"8bac":function(t,e,a){"use strict";a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"g",(function(){return o})),a.d(e,"h",(function(){return c})),a.d(e,"j",(function(){return l})),a.d(e,"e",(function(){return u})),a.d(e,"f",(function(){return d})),a.d(e,"a",(function(){return m})),a.d(e,"d",(function(){return f})),a.d(e,"i",(function(){return p}));var i=a("b775"),n={getList:"/marketing/luckyActivity/list",addSave:"/marketing/luckyActivity/save",updateList:"/marketing/luckyActivity/update",deleteList:"/marketing/luckyActivity/delete",getInfo:"/marketing/luckyActivity/info",uploadFile:"/marketing/luckActivityPrize/uploadFile",prizeInfo:"/marketing/luckActivityPrize/prizeInfo",numberOfPeopleInfo:"/marketing/luckyActivity/numberOfPeopleInfo",customerInfo:"/marketing/luckyActivity/customerInfo",cancelAfterVerification:"/marketing/luckyActivity/cancelAfterVerification"};function s(t){return Object(i["b"])({url:n.cancelAfterVerification,method:"post",data:t})}function r(t){return Object(i["b"])({url:n.customerInfo,method:"get",params:t})}function o(t){return Object(i["b"])({url:n.numberOfPeopleInfo,method:"get",params:t})}function c(t){return Object(i["b"])({url:n.prizeInfo,method:"get",params:t})}function l(t){return Object(i["b"])({url:n.uploadFile,method:"post",data:t})}function u(t){return Object(i["b"])({url:n.getInfo,method:"get",params:t})}function d(t){return Object(i["b"])({url:n.getList,method:"get",params:t})}function m(t){return Object(i["b"])({url:n.addSave,method:"post",data:t})}function f(t){return Object(i["b"])({url:n.deleteList,method:"post",data:t})}function p(t){return Object(i["b"])({url:n.updateList,method:"post",data:t})}},"8e34":function(t,e,a){"use strict";a("299d")},"8e87":function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"textarea",class:t.classNmae,attrs:{contenteditable:"true",maxLength:"maxLength","data-form-type":"reason","data-placeholder":"请输入回复框的内容"},domProps:{innerHTML:t._s(t.innerText)},on:{blur:t.textareaBlur,input:t.changeText}})},n=[],s=(a("a9e3"),a("ac1f"),a("466d"),a("5319"),{name:"Contenteditable",props:{classNmae:{type:String,default:"link-textarea"},value:{type:String,default:""},maxLength:{type:[String,Number],default:""}},computed:{state:function(){return this.$route.query.state}},data:function(){return{innerText:"",isLocked:!0,sel:null,range:null,textareaElement:"",num:0}},watch:{value:{handler:function(){"add"!==this.state&&this.isLocked&&this.value&&(this.innerText=this.value,this.isLocked=!1)},immediate:!0},classNmae:{handler:function(){this.textareaElement=document.querySelector(this.classNmae),this.textareaElement&&(this.textareaElement.focus(),this.textareaElement.blur())},immediate:!0}},methods:{keepLastIndex:function(t){t&&this.$nextTick((function(){if(window.getSelection){t.focus();var e=window.getSelection();e.selectAllChildren(t),e.collapseToEnd()}else if(document.selection){e=document.selection.createRange();e.moveToElementText(t),e.collapse(!1),e.select()}}))},textareaBlur:function(){this.sel=window.getSelection(),this.range=this.sel.getRangeAt(0),this.range.deleteContents()},changeText:function(t){var e=this;this.controlMaxlength(t.target.innerHTML,t),this.$nextTick((function(){e.$emit("input",e.checkInnerHtml(e.$el.innerHTML))}))},controlMaxlength:function(t,e){(null===t||void 0===t?void 0:t.length)>this.maxLength&&(this.innerText=t.substring(0,this.maxLength-this.num),this.num++,this.num>6&&(this.num=0)),this.keepLastIndex(this.textareaElement)},checkInnerHtml:function(t){var e=/<span[^>]*>([\s\S]*?)<\/span>/i,a=t.match(e),i=t;return a&&"客户昵称"!==a[1]&&(i=t.replace(/<span class="nick-name">/g,"").replace(/<\/span>/g,""),this.innerText=i,this.keepLastIndex(this.textareaElement)),i},insertHtmlAtCaret:function(t){if(window.getSelection){if(this.sel.getRangeAt&&this.sel.rangeCount){var e=document.createDocumentFragment(),a=e.appendChild(t),i=document.createElement("div");i.innerHTML="&#8203",a=e.appendChild(i.firstChild),this.range.insertNode(e),a&&(this.range=this.range.cloneRange(),this.range.setStartAfter(a),this.range.collapse(!0),this.sel.removeAllRanges(),this.sel.addRange(this.range),this.$emit("input",this.$el.innerHTML))}}else document.selection&&"Control"!=document.selection.type&&(document.selection.createRange().pasteHTML(html),this.$emit("input",this.$el.innerHTML))}}}),r=s,o=(a("d3ba"),a("2877")),c=Object(o["a"])(r,i,n,!1,null,"6c1514fc",null);e["a"]=c.exports},"8f19":function(t,e,a){"use strict";a.d(e,"n",(function(){return s})),a.d(e,"q",(function(){return r})),a.d(e,"a",(function(){return o})),a.d(e,"j",(function(){return c})),a.d(e,"h",(function(){return l})),a.d(e,"f",(function(){return u})),a.d(e,"l",(function(){return d})),a.d(e,"d",(function(){return m})),a.d(e,"e",(function(){return f})),a.d(e,"i",(function(){return p})),a.d(e,"g",(function(){return h})),a.d(e,"b",(function(){return g})),a.d(e,"k",(function(){return v})),a.d(e,"m",(function(){return b})),a.d(e,"c",(function(){return k})),a.d(e,"p",(function(){return L})),a.d(e,"o",(function(){return y}));var i=a("b775"),n={customerFormSave:"/client_transformation/customerForm/save",dateInfoList:"/client_transformation/customerFormData/dateInfoList",customerFormList:"/client_transformation/customerForm/list",customerFormInfo:"/client_transformation/customerForm/info",customerFormUpdate:"/client_transformation/customerForm/update",customerFormPublish:"/client_transformation/customerForm/publish",customerFormDelete:"/client_transformation/customerForm/delete",dataInfo:"/client_transformation/customerFormData/dataInfo",analysis:"/client_transformation/customerFormData/analysis",staffList:"/client_transformation/customerFormData/staffList",infoList:"/client_transformation/customerFormData/infoList",analysisExport:"/client_transformation/customerFormData/analysisExport",dataInfoExport:"/client_transformation/customerFormData/dataInfoExport",infoCityList:"/client_transformation/customerFormData/infoCityList",batchTags:"/client_transformation/customerFormData/batchTags",selectList:"/client_transformation/customerForm/userData/selectList",queryDataList:"/client_transformation/customerFormData/queryDataList"};function s(t){return Object(i["b"])({url:n.infoList,method:"post",data:t})}function r(t){return Object(i["b"])({url:n.staffList,method:"get",params:t})}function o(t){return Object(i["b"])({url:n.analysis,method:"get",params:t})}function c(t){return Object(i["b"])({url:n.dataInfo,method:"get",params:t})}function l(t){return Object(i["b"])({url:n.customerFormSave,method:"post",data:t})}function u(t){return Object(i["b"])({url:n.customerFormList,method:"get",params:t})}function d(t){return Object(i["b"])({url:n.dateInfoList,method:"get",params:t})}function m(t){return Object(i["b"])({url:n.customerFormDelete,method:"post",data:t})}function f(t){return Object(i["b"])({url:n.customerFormInfo,method:"get",params:t})}function p(t){return Object(i["b"])({url:n.customerFormUpdate,method:"post",data:t})}function h(t){return Object(i["b"])({url:n.customerFormPublish,method:"post",data:t})}function g(t){return Object(i["b"])({url:n.analysisExport,method:"get",params:t,responseType:"blob"})}function v(t){return Object(i["b"])({url:n.dataInfoExport,method:"get",params:t,responseType:"blob"})}function b(t){return Object(i["b"])({url:n.infoCityList,method:"get",params:t})}function k(t){return Object(i["b"])({url:n.batchTags,method:"post",data:t})}function L(t){return Object(i["b"])({url:n.selectList,method:"get",params:t})}function y(t){return Object(i["b"])({url:n.queryDataList,method:"post",data:t})}},"95d0":function(t,e,a){},9802:function(t,e,a){"use strict";var i=a("1bee");e["a"]={methods:{changeStartTime:function(t){if(t.endTime){var e,a,n=Object(i["b"])(null===t||void 0===t||null===(e=t.startTime)||void 0===e?void 0:e.format("HH:mm"),null===t||void 0===t||null===(a=t.endTime)||void 0===a?void 0:a.format("HH:mm"),"start");n&&(t.startTime=void 0,this.$message.warning("开始时间不能大于结束时间"))}},changeEndTime:function(t){if(t.startTime){var e,a=Object(i["b"])(null===t||void 0===t?void 0:t.startTime.format("HH:mm"),null===t||void 0===t||null===(e=t.endTime)||void 0===e?void 0:e.format("HH:mm"),"start");a&&(t.endTime=void 0,this.$message.warning("结束时间不能小于开始时间"))}}}}},"9e0d":function(t,e,a){},a2ba:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({attrs:{loading:t.loading},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("AddLinkWrap",{ref:"AddLinkWrap",staticClass:"add-link-wrap",attrs:{editData:t.editData,isNeedTag:t.isNeedTag,source:t.source,isNeedRader:t.isNeedRader,isNeedSelectRadar:t.isNeedSelectRadar}})],1)},n=[],s=a("7807"),r=a("2a86"),o={name:"AddLink",components:{AddLinkWrap:s["a"],CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""},loading:{type:Boolean,default:!1},isNeedTag:{type:Boolean,default:!1},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0}},watch:{editData:{handler:function(){this.sourceModal.title=this.editData.id?"修改链接":"添加链接"},immediate:!0}},data:function(){return{sourceModal:{}}},methods:{serviceOk:function(){var t=this;this.$refs.AddLinkWrap.getFormValue()&&this.$refs.AddLinkWrap.$refs.ruleForm.validate((function(e){if(!e)return!1;t.$emit("serviceOk",t.$refs.AddLinkWrap.form)}))}}},c=o,l=(a("d6b1"),a("2877")),u=Object(l["a"])(c,i,n,!1,null,"2002f84d",null);e["a"]=u.exports},acb6:function(t,e,a){},afd2:function(t,e,a){},b9cd:function(t,e,a){"use strict";a.d(e,"l",(function(){return i})),a.d(e,"j",(function(){return n})),a.d(e,"o",(function(){return s})),a.d(e,"n",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"g",(function(){return c})),a.d(e,"d",(function(){return l})),a.d(e,"a",(function(){return u})),a.d(e,"f",(function(){return d})),a.d(e,"k",(function(){return m})),a.d(e,"i",(function(){return f})),a.d(e,"e",(function(){return p})),a.d(e,"p",(function(){return h})),a.d(e,"c",(function(){return g})),a.d(e,"h",(function(){return v})),a.d(e,"q",(function(){return b})),a.d(e,"m",(function(){return k}));var i="LOSS_STATUS",n="GROUP_STATUS",s="ORDER_WAY",r="ORDER_CONDITION",o="ADD_WAY",c="GENDER",l="CUSTOMER_STATUS",u={0:"待分配",1:"待添加",2:"待通过",3:"已添加",4:"导入中"},d={1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六",7:"周日"},m=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:1},{text:"已不是好友",color:"#ffd4b6",id:2},{text:"客户接收达上限",color:"#fbe8ae",id:3},{text:"本月消息已经达到上限",color:"",id:4}],f=[{text:"未发送",color:"#ffc2c2",id:0},{text:"已发送",color:"",id:2},{text:"没有群发任务",color:"",id:4}],p={1:"微信",2:"企业微信"},h=[{id:"immediately",value:"立即发送"},{id:"timing",value:"定时发送"}],g={0:"渠道码",1:"区域扫码",2:"自动拉群",3:"一客一码",4:"加好友",5:"通过群码拉群"},v={0:{text:"拉人中",color:"green"},1:{text:"未开始",color:""},2:{text:"已达上限",color:"orange"},3:{text:"已停用",color:"red"}},b={0:{text:"创建失败",color:"green",id:0},1:{text:"待发送",color:"rgba(34,34,34,.85)",id:1},2:{text:"已发送",color:"rgba(34,34,34,.85)",id:2},3:{text:"已取消",color:"rgba(34,34,34,.85)",id:3},4:{text:"提醒发送",color:"#1890ff",id:4}},k=[{text:"文章",id:"0",format:""},{text:"链接",id:"1"},{text:"海报",id:"2",max:2,format:".bmp,.jpg,.jpeg,.png,.tif,.gif,.pcx,.tga,.exif,.fpx,.svg,.psd,.cdr,.pcd,.dxf,.ufo,.eps,.ai,.raw,.WMF,.webp",tips:"请上传png、jpg格式不超过2M的文件"},{text:"视频",id:"7",max:2e5,format:".MP4",tips:"请上传格式为MP4的视频文件"},{text:"PDF",id:"3",max:20,format:".pdf",icon:"/icons/pdf.png",tips:"请上传PDF格式不超过20M的文件"},{text:"PPT",id:"4",max:20,format:".pptx,.ppt,.pps",icon:"/icons/ppt.svg",tips:"请上传PPT格式不超过20M的文件"},{text:"表格",id:"5",max:20,format:".xlsx,.xls,.csv",icon:"/icons/excel.svg",tips:"请上传csv、xlsx格式不超过20M的文件"},{text:"文档",id:"6",max:20,format:".txt,.doc,.docx",icon:"/icons/word.svg",tips:"请上传doc、txt.docx格式不超过20M的文件"}]},bacb:function(t,e,a){"use strict";a("d298")},c036:function(t,e,a){},c59a:function(t,e,a){"use strict";a("acb6")},c952:function(t,e,a){"use strict";a.r(e);a("b0c0"),a("498a"),a("4c53");var i=function(){var t=this,e=t._self._c;return e("div",{ref:"pageWrap",staticClass:"page-wrap"},[e("a-page-header",{staticClass:"page-header background-white",attrs:{title:"".concat(t.isAddText,"活码")},on:{back:function(e){return t.$router.go(-1)}}}),e("section",{staticClass:"section background-white"},[e("a-form",{attrs:{"label-col":{span:2},"wrapper-col":{span:12},form:t.form}},[e("p",{staticClass:"base-info"},[t._v("基础信息")]),"batchAdd"===t.state?e("BatchCode",{model:{value:t.nameList,callback:function(e){t.nameList=e},expression:"nameList"}}):e("a-form-item",{attrs:{label:"二维码名称"}},[e("a-input",{attrs:{disabled:"edit"==t.state,placeholder:"名称不会展示给用户，用于企业记录渠道名称或使用场景",maxLength:25},model:{value:t.name,callback:function(e){t.name="string"===typeof e?e.trim():e},expression:"name"}})],1),e("a-form-item",{attrs:{label:"选择分组","wrapper-col":{span:4},required:""}},[e("a-select",{model:{value:t.groupId,callback:function(e){t.groupId=e},expression:"groupId"}},t._l(t.groupList,(function(a){return e("a-select-option",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.group_name)+" ")])})),1)],1),e("a-form-item",{attrs:{label:"客服人员",required:""}},[e("a-radio-group",{attrs:{name:"radioGroup"},on:{change:t.onlineTimeChange},model:{value:t.onlineTime,callback:function(e){t.onlineTime=e},expression:"onlineTime"}},[e("a-radio",{attrs:{value:"allDay"}},[t._v(" 全天在线 ")]),e("a-radio",{attrs:{value:"freedom"}},[t._v(" 自动上下线 ")])],1),"allDay"===t.onlineTime?e("div",[e("div",[e("a-button",{staticClass:"r-10",attrs:{type:"plus"},on:{click:function(e){t.AddTransfeVisible=!0}}},[t._v("添加成员")]),t._v(" 同一个二维码可选择多位客服成员进行接待，客户扫码后随机分配一名客服人员 ")],1),t.selectList.length>0?e("div",[e("ul",{staticClass:"account-list"},t._l(t.selectList,(function(a,i){return e("li",{key:i},[e("img",{staticClass:"avatar",attrs:{src:a.source.thumbAvatar,alt:""}}),e("a-icon",{staticClass:"close",attrs:{type:"close-circle"},on:{click:function(e){return t.closeDetel(i)}}}),t._v(" "+t._s(a.title)+" ")],1)})),0)]):t._e()]):t._e(),"freedom"===t.onlineTime?e("div",[e("header"),t._l(t.staffAutoOnlineList,(function(a,i){return e("div",{key:i,staticClass:"test-time"},[e("a-card",{staticClass:"freedom"},[e("a-form-item",{attrs:{label:"员工选择","wrapper-col":{span:21},"label-col":{span:3}}},[e("AddContent",{attrs:{title:"请选择员工",type:"deptId",dataList:a.staffIdList},on:{selectPerson:function(e){return t.selectPerson(a,i)}},model:{value:a.staffIdList,callback:function(e){t.$set(a,"staffIdList",e)},expression:"item.staffIdList"}})],1),e("a-form-item",{attrs:{label:"工作周期","wrapper-col":{span:16},"label-col":{span:3}}},[e("a-select",{attrs:{mode:"tags",placeholder:"请选择工作周期",allowClear:""},on:{change:function(e){return t.changeSelect(a,i)}},model:{value:a.workCycle,callback:function(e){t.$set(a,"workCycle",e)},expression:"item.workCycle"}},t._l(t.weekList,(function(a,i){return e("a-select-option",{key:String(i+1)},[t._v(" 周"+t._s(a)+" ")])})),1)],1),e("a-form-item",{attrs:{label:"上线时间","wrapper-col":{span:16},"label-col":{span:3}}},[e("a-time-picker",{attrs:{format:"HH:mm",placeholder:"开始时间"},on:{change:function(e){return t.changeStartTime(a,i)}},model:{value:a.startTime,callback:function(e){t.$set(a,"startTime",e)},expression:"item.startTime"}}),t._v(" ~ "),e("a-time-picker",{attrs:{format:"HH:mm",placeholder:"结束时间"},on:{change:function(e){return t.changeEndTime(a,i)}},model:{value:a.endTime,callback:function(e){t.$set(a,"endTime",e)},expression:"item.endTime"}})],1)],1),t.staffAutoOnlineList.length>1?e("a-icon",{staticClass:"delete",attrs:{type:"delete"},on:{click:function(e){return t.deleteStaff(i)}}}):t._e()],1)})),e("a-button",{attrs:{type:"link"},on:{click:t.addAtherWeekTime}},[e("a-icon",{attrs:{type:"plus-circle"}}),t._v(" 添加其他工作周期 ")],1)],2):t._e()],1),e("a-form-item",{attrs:{label:"员工添加上限"}},[e("a-switch",{on:{click:t.hasAddLimitStaus},model:{value:t.hasAddLimit,callback:function(e){t.hasAddLimit=e},expression:"hasAddLimit"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.hasAddLimit,expression:"hasAddLimit"}],staticClass:"addlimt"},[e("div",{staticClass:"desc"},[e("span",[t._v("员工添加上限：")]),e("span",[t._v(" 员工从该渠道添加的客户达到每日上限后，将自动下线当日不再接待该渠道新客户 ")])]),e("div",{staticClass:"choose-staff-box"},[e("div",{staticClass:"choose-staff-header"},[e("span",[t._v("共"+t._s(t.getSelectList.length)+"个员工")]),e("div",{staticClass:"info-box"},[e("span",[t._v("当日已添加客户数")]),e("span",[t._v("每日添加客户上限")])])])]),e("div",{staticClass:"choose-staff-content"},t._l(t.getSelectList,(function(a,i){return e("li",{key:i},[e("div",{staticClass:"basic"},[e("img",{attrs:{src:a.source.thumbAvatar}}),e("span",{staticClass:"name"},[t._v(t._s(a.title))])]),e("div",{staticClass:"info-box"},[e("span",[t._v(t._s(a.todayAddNum||0))]),e("a-input-number",{attrs:{min:0,max:100,"default-value":a.value},on:{change:function(e){return t.onChange(e,i)}}})],1)])})),0)])],1),e("a-form-item",{attrs:{label:"允许员工上下线"}},[e("a-switch",{on:{click:t.hasAddLimitStaus},model:{value:t.allowStaffOffline,callback:function(e){t.allowStaffOffline=e},expression:"allowStaffOffline"}}),t._v(" 开启后员工可在侧边栏修改个人上下线状态 ")],1),e("a-form-item",{attrs:{label:"备用人员"}},[e("div",[e("div",[e("a-button",{staticClass:"r-10",attrs:{type:"plus"},on:{click:t.getMember}},[t._v("+ "+t._s(t.sparetext)+"，请选择备用员")]),t._v(" 当活码中所有员工均不可接待时，将分配客户给该员工 ")],1),t.spareList.length>0?e("div",[e("ul",{staticClass:"account-list"},t._l(t.spareList,(function(a,i){return e("li",{key:i},[e("img",{staticClass:"avatar",attrs:{src:a.source.thumbAvatar,alt:""}}),e("a-icon",{staticClass:"close",attrs:{type:"close-circle"},on:{click:function(e){return t.closespareDetel(i)}}}),t._v(" "+t._s(a.title)+" ")],1)})),0)]):t._e()])]),e("a-form-item",{attrs:{label:"客户标签"}},[e("a-switch",{model:{value:t.hasTag,callback:function(e){t.hasTag=e},expression:"hasTag"}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.hasTag,expression:"hasTag"}]},[e("a-space",[e("a-button",{staticClass:"aks-border-but",attrs:{size:"small"},on:{click:function(e){t.visibleTag=!0}}},[e("a-icon",{attrs:{type:"plus"}}),t._v(" 添加标签 ")],1),t._l(t.selectTagList,(function(a,i){return e("a-tag",{key:a.tagId,attrs:{closable:""},on:{close:function(e){return t.closeTag(i)}}},[t._v(" "+t._s(a.tagName)+" ")])}))],2)],1)],1),e("a-form-item",{attrs:{label:"客户备注"}},[e("a-space",[e("a-switch",{model:{value:t.customerRemarkShow,callback:function(e){t.customerRemarkShow=e},expression:"customerRemarkShow"}}),e("span",{staticClass:"aks-tips"},[t._v("开启后可为客户昵称加备注，方便查看客户来源")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.customerRemarkShow,expression:"customerRemarkShow"}]},[e("div",{staticStyle:{width:"400px"}},[e("a-input",{attrs:{"addon-before":"客户昵称-",maxLength:10,allowClear:""},model:{value:t.customerRemark,callback:function(e){t.customerRemark=e},expression:"customerRemark"}})],1),e("div",{staticClass:"preview"},[e("a-space",[e("span",[t._v("预览: ")]),e("div",{staticClass:"customer-name"},[e("a-space",[e("a-avatar",{attrs:{src:"/icons/user.png",shape:"square"}}),e("span",[t._v("客户昵称- "+t._s(t.customerRemark)+" ")])],1)],1)])],1)])],1),e("a-form-item",{attrs:{label:"客户描述"}},[e("a-space",[e("a-switch",{model:{value:t.customerDescribeShow,callback:function(e){t.customerDescribeShow=e},expression:"customerDescribeShow"}}),e("span",{staticClass:"aks-tips"},[t._v("开启后可为客户添加描述，将在客户画像里展示")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.customerDescribeShow,expression:"customerDescribeShow"}]},[e("a-textarea",{attrs:{maxLength:t.maxLengthcustomerDescribe,placeholder:"请输入客户描述内容","allow-clear":"",autoSize:{minRows:6,maxRows:6}},model:{value:t.customerDescribe,callback:function(e){t.customerDescribe=e},expression:"customerDescribe"}}),e("p",{staticClass:"customer-decribe-length"},[t._v(t._s(t.customerDescribe.length)+"/"+t._s(t.maxLengthcustomerDescribe))])],1)],1),e("p",{staticClass:"base-info"},[t._v("设置欢迎语")]),e("div",{staticClass:"tips"},[e("a-icon",{attrs:{type:"exclamation-circle"}}),e("div",[t._v(" 因企业微信限制，若使用成员已在「"),e("b",[t._v("企业微信后台")]),t._v("」配置了欢迎语，这里的欢迎语将不会生效 ")])],1),e("a-form-model-item",{attrs:{label:"设置欢迎语","wrapper-col":{span:12}}},[e("a-radio-group",{attrs:{name:"radioGroup"},model:{value:t.messageVal,callback:function(e){t.messageVal=e},expression:"messageVal"}},[e("a-radio",{attrs:{value:1}},[t._v("渠道欢迎语")]),e("a-radio",{attrs:{value:2}},[t._v("默认欢迎语")]),e("a-radio",{attrs:{value:3}},[t._v("不发送欢迎语")])],1),e("p",{directives:[{name:"show",rawName:"v-show",value:"2"==t.messageVal,expression:"messageVal == '2'"}],staticClass:"tips-p"},[t._v(" 将发送成员已设置的欢迎语，若所选成员未设置欢迎语，则不会发送欢迎语 ")])],1),e("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:"1"==t.messageVal,expression:"messageVal == '1'"}],attrs:{label:"消息内容","wrapper-col":{span:16},prop:"innerText"}},[e("div",{staticClass:"flex-box"},[e("div",[e("div",{staticClass:"reason-box"},[e("div",{staticClass:"reason-tilte",on:{click:t.insertNickname}},[t._v("[插入客户昵称]")]),e("Contenteditable",{ref:"contenteditable",attrs:{maxLength:t.maxLength},model:{value:t.form.innerText,callback:function(e){t.$set(t.form,"innerText",e)},expression:"form.innerText"}}),e("div",{staticClass:"reason-tip"},[t._v(t._s(t.contentOne.length)+"/"+t._s(t.maxLength))])],1),e("Accessory",{staticStyle:{"margin-top":"20px"},attrs:{maxLength:9,source:"channel_qr",attachmentsWrap:t.attachments},on:{serviceOk:t.addAccessory}}),e("p",[t._v("当客户昵称字样由黄色变为黑色时，即不生效，请重新输入")])],1),e("PhoneModel",{attrs:{textList:t.textList}})],1)]),e("a-form-model-item",{attrs:{label:"分时段欢迎语","wrapper-col":{span:18}}},[e("a-space",[e("a-switch",{model:{value:t.welcomeSpanListShow,callback:function(e){t.welcomeSpanListShow=e},expression:"welcomeSpanListShow"}})],1),e("PeriodTime",{directives:[{name:"show",rawName:"v-show",value:t.welcomeSpanListShow,expression:"welcomeSpanListShow"}],attrs:{welcomeSpanList:t.welcomeSpanList}})],1),e("a-form-item",{attrs:{label:"欢迎语屏蔽"}},[e("a-switch",{model:{value:t.openWelcomeScreen,callback:function(e){t.openWelcomeScreen=e},expression:"openWelcomeScreen"}}),t._v(" 开启后，客户昵称中包含设定的关键词的客户不会收到欢迎语 "),t.openWelcomeScreen?e("TagComponents",{attrs:{isEdit:"",tagslist:t.tagsItem,closable:!0,isSelect:!1},on:{addTag:t.addTag}}):t._e()],1),e("p",{staticClass:"base-info"},[t._v("功能设置")]),e("a-form-item",{attrs:{label:"自动通过好友"}},[e("a-space",[e("a-switch",{model:{value:t.antoStart,callback:function(e){t.antoStart=e},expression:"antoStart"}}),e("a-tooltip",{attrs:{title:"开启后，客户添加该企业微信时，无需好友验证，将会自动添加成功"}},[e("a-icon",{attrs:{type:"question-circle"}})],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.antoStart,expression:"antoStart"}]},[e("a-radio-group",{attrs:{name:"radioGroup"},model:{value:t.autoTime,callback:function(e){t.autoTime=e},expression:"autoTime"}},[e("a-radio",{attrs:{value:"allDay"}},[t._v("全天开启")]),e("a-radio",{attrs:{value:"freedom"}},[t._v("选择时间段")])],1),"freedom"===t.autoTime?e("div",[e("a-time-picker",{attrs:{format:"HH:mm",placeholder:"请输入时间"},on:{change:t.changeStartTimeSelf},model:{value:t.openStartTimeshow,callback:function(e){t.openStartTimeshow=e},expression:"openStartTimeshow"}}),t._v(" 至 "),e("a-time-picker",{attrs:{format:"HH:mm",placeholder:"请输入时间"},on:{change:t.changeEndTimeSelf},model:{value:t.openEndTimeshow,callback:function(e){t.openEndTimeshow=e},expression:"openEndTimeshow"}}),e("p",{staticClass:"tips"},[t._v("在非开启「自动通过好友」时间段添加的好友，需要客服手动通过好友验证后才可添加")])],1):t._e()],1)],1),e("a-form-model-item",{attrs:{label:"二维码预览"}},[e("CodePreview",{attrs:{urlCode:t.urlCode,qrCode:t.qrCode,title:"更换头像",state:t.state},on:{qrcodeCallback:t.qrcodeCallback}}),e("p",[t._v("* 此二维码只是样式预览效果，请勿直接使用")])],1),e("a-form-item",{attrs:{"wrapper-col":{span:12,offset:2}}},[e("a-button",{attrs:{type:"primary",loading:t.loading},on:{click:t.sub}},[t._v(" "+t._s("".concat(t.isAddText,"活码"))+" ")])],1)],1)],1),e("a-modal",{attrs:{visible:t.previewVisible,footer:null},on:{cancel:function(e){t.previewVisible=!1}}},[e("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:t.imageUrl}})]),e("a-modal",{attrs:{footer:null,width:"680px",centered:"",destroyOnClose:""},on:{cancle:function(e){t.AddTransfeVisible=!1}},model:{value:t.AddTransfeVisible,callback:function(e){t.AddTransfeVisible=e},expression:"AddTransfeVisible"}},[e("AddTransfer",{attrs:{selectList:t.selectList,selectRoleIdList:t.selectCustomerIdList,disabledId:"staffId",type:"deptId"},on:{serviceOk:t.serviceOk,cancle:function(e){t.AddTransfeVisible=!1}}})],1),e("a-modal",{attrs:{footer:null,width:"680px",destroyOnClose:"",centered:""},on:{cancle:function(e){t.AddspareVisible=!1}},model:{value:t.AddspareVisible,callback:function(e){t.AddspareVisible=e},expression:"AddspareVisible"}},[e("AddTransfer",{attrs:{selectList:t.spareList,disabledId:"staffId",selectRoleIdList:t.selectRoleIdList,type:"deptId"},on:{serviceOk:t.servicespareOk,cancle:function(e){t.AddspareVisible=!1}}})],1),e("a-modal",{attrs:{footer:null,centered:""},model:{value:t.visibleTag,callback:function(e){t.visibleTag=e},expression:"visibleTag"}},[e("SelectTags",{attrs:{selectTagList:t.selectTagList},on:{cancle:function(e){t.visibleTag=!1},serviceOk:t.serviceTagOk}})],1)],1)},n=[],s=a("5530"),r=a("c7eb"),o=a("1da1"),c=a("2909"),l=(a("ac1f"),a("5319"),a("d81d"),a("0481"),a("4069"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("99af"),a("a630"),a("a434"),a("159b"),a("4de4"),a("a9e3"),a("a15b"),a("7db0"),a("c844")),u=function(){var t=this,e=t._self._c;return e("div",[e("h6",[t._v("添加成员")]),e("p",[t._v("没有想要添加的成员? "),e("a-button",{attrs:{type:"link"},on:{click:function(e){t.addRoleModal=!0}}},[t._v("添加成员教程")])],1),e("a-transfer",{attrs:{"data-source":t.mockData,"show-search":"","target-keys":t.targetKeys,render:function(t){return t.title}},on:{change:t.handleChange}}),e("a-modal",{attrs:{width:"700px",footer:null},model:{value:t.addRoleModal,callback:function(e){t.addRoleModal=e},expression:"addRoleModal"}},[e("AddRoleModal")],1)],1)},d=[],m=a("0cd2"),f={name:"SelectCustomer",components:{AddRoleModal:m["a"]},data:function(){return{mockData:[{key:"title",title:"标题",disabled:!1},{key:"name",title:"名字",disabled:!1}],targetKeys:[],addRoleModal:!1}},methods:{handleChange:function(t,e,a){this.targetKeys=t}}},p=f,h=(a("74a4"),a("2877")),g=Object(h["a"])(p,u,d,!1,null,"30352b89",null),v=g.exports,b=a("1eb1"),k=a("032e"),L=a("c1df"),y=a.n(L),w=a("888c"),T=a("1bee"),x=a("8e87"),_=a("e6b1"),C=function(){var t=this,e=t._self._c;return e("div",[e("a-form-item",{attrs:{label:"创建渠道活码"}},[e("a-input-number",{staticStyle:{width:"60px"},attrs:{min:1,max:200},on:{change:t.changeInputValue},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),t._v(" 个 ")],1),e("a-form-item",{attrs:{label:"二维码名称"}},[e("a-input",{attrs:{placeholder:"名称不会展示给用户，用于企业记录渠道名称或使用场景",maxLength:25},on:{change:function(e){t.name=t.name.trim()}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),e("p",{staticClass:"tips"},[t._v("自动创建的渠道活码将按照序号依次生成，如“渠道活码1”")]),e("a-button",{staticClass:"button",attrs:{type:"link"},on:{click:t.open}},[t._v(t._s(t.isOpen?"收起":"查看全部活码"))]),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"}],staticClass:"name-wrap"},[e("p",[t._v("共"+t._s(t.num||0)+"个渠道活码")]),e("div",{staticClass:"list-wrap"},t._l(t.num,(function(a,i){return e("li",{key:i},[e("p",[t._v(t._s("".concat(t.name||"未命名","-").concat(i+1)))])])})),0)])],1)],1)},S=[],O={name:"BatchCode",components:{},data:function(){return{num:1,name:"",isOpen:!0}},watch:{num:function(){this.getNameList()},name:function(){this.getNameList()}},methods:{open:function(){this.isOpen=!this.isOpen},changeInputValue:function(t){t>=200&&(this.num=200)},getNameList:function(){for(var t=[],e=0;e<this.num;e++)t.push("".concat(this.name||"未命名","-").concat(e+1));this.$emit("input",t)}}},A=O,I=(a("78fc"),Object(h["a"])(A,C,S,!1,null,"071e3534",null)),D=I.exports,R=function(){var t=this,e=t._self._c;return e("div",[t._m(0),e("ul",{staticClass:"section"},t._l(t.welcomeSpanList,(function(a,i){return e("a-form-model-item",{key:i,staticClass:"model-list",attrs:{label:"时段".concat(i+1),"wrapper-col":{span:22}}},[e("div",{staticClass:"flex-box"},[e("div",{staticClass:"section-contant"},[e("p",[t._v("发送日期：")]),e("div",{staticClass:"time"},[e("a-select",{staticClass:"change-time",attrs:{mode:"tags",placeholder:"请选择发送日期",allowClear:""},model:{value:a.weekday,callback:function(e){t.$set(a,"weekday",e)},expression:"item.weekday"}},t._l(t.weekList,(function(a,i){return e("a-select-option",{key:String(i+1)},[t._v(" 周"+t._s(a)+" ")])})),1),e("a-time-picker",{attrs:{format:"HH:mm",placeholder:"开始时间"},on:{change:function(e){return t.changeStartTime(a)}},model:{value:a.startTime,callback:function(e){t.$set(a,"startTime",e)},expression:"item.startTime"}}),t._v(" ~ "),e("a-time-picker",{attrs:{format:"HH:mm",placeholder:"结束时间"},on:{change:function(e){return t.changeEndTime(a)}},model:{value:a.endTime,callback:function(e){t.$set(a,"endTime",e)},expression:"item.endTime"}})],1),e("div",{staticClass:"reason-box"},[e("div",{staticClass:"reason-tilte",on:{click:function(e){return t.insertNickname("contenteditable".concat(i))}}},[t._v("[插入客户昵称]")]),e("Contenteditable",{ref:"contenteditable".concat(i),refInFor:!0,attrs:{maxLength:t.maxLength,classNmae:"contenteditable2"},model:{value:a.contentOne,callback:function(e){t.$set(a,"contentOne",e)},expression:"item.contentOne"}}),e("div",{staticClass:"reason-tip"},[t._v(t._s(t._f("getLength")(a.contentOne))+"/"+t._s(t.maxLength))])],1),e("Accessory",{staticStyle:{"margin-top":"20px"},attrs:{maxLength:9,source:"channel_welcome",attachmentsWrap:a.attachments},on:{serviceOk:function(e){return t.addAccessory(a,e)}}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:0!==i,expression:"index !== 0"}],staticClass:"rule-right"},[e("a-space",[e("a-icon",{attrs:{type:"delete"},on:{click:function(e){return t.deleteRule(i)}}})],1)],1),e("PhoneModel",{attrs:{textList:t.getTextList(a.contentOne,a.attachments)}})],1)])})),1),e("a-button",{attrs:{type:"link"},on:{click:t.addRule}},[e("a-icon",{attrs:{type:"plus-circle"}}),t._v("添加分时段欢迎语 "),e("span",{staticClass:"font-color-black-25"},[t._v("(最多设置5个规则)")])],1)],1)},j=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"divide-welcome-prompt"},[e("span",[t._v("分时段欢迎语 ：")]),e("span",[t._v(" 1、员工上下班不同时间段可设置不同欢迎语；"),e("br"),t._v(" 2、分时段之外的时间将发送渠道欢迎语。 ")])])}],N=a("9802"),$=a("2bf4"),F=a("7a44"),M={name:"PeriodTime",components:{Contenteditable:x["a"],PhoneModel:_["a"],Accessory:F["a"]},mixins:[N["a"],$["a"]],filters:{getLength:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return((null===t||void 0===t?void 0:t.replace(/<span class="nick-name">客户昵称<\/span>/g,"#"))||"").length}},props:{welcomeSpanList:{type:[Array],default:function(){return[]}}},data:function(){return{weekList:["一","二","三","四","五","六","天"],maxLength:600,defaultRuleDetails:function(){return{weekday:["1","2","3","4","5","6","7"],startTime:void 0,endTime:void 0,contentOne:"",attachments:[]}}}},methods:{addAccessory:function(t,e){t.attachments=e},getTextList:function(t,e){var a=[];return t&&a.push(t.replace(/<span class="nick-name">/g," ").replace(/<\/span>/g," ")),(null===e||void 0===e?void 0:e.length)>0&&a.push.apply(a,Object(c["a"])(e)),a},addRule:function(){this.welcomeSpanList.length>=5?this.$message.warning("最多设置5个规则"):this.welcomeSpanList.push(this.defaultRuleDetails())},insertNickname:function(t){var e=document.createElement("span");e.className="nick-name",e.innerHTML="客户昵称",this.$refs[t][0].insertHtmlAtCaret(e)},deleteRule:function(t){this.welcomeSpanList.splice(t,1)}}},E=M,H=(a("bacb"),Object(h["a"])(E,R,j,!1,null,"b912c82c",null)),q=H.exports,P=a("6290"),U=a("e1ae"),V=a("b9cd"),W={name:"NewCode",mixins:[N["a"],$["a"]],components:{SelectCustomer:v,AddTransfer:b["a"],SelectTags:l["a"],CodePreview:w["a"],Contenteditable:x["a"],PhoneModel:_["a"],BatchCode:D,PeriodTime:q,TagComponents:P["a"],AddContent:U["a"],Accessory:F["a"]},data:function(){return{attachments:[],conFlictflag:!1,conFlictText:"",tagsItem:{tags:[]},staffAutoOnlineList:[{staffIdList:[],staffName:"",workCycle:["1","2","3","4","5","6","7"],startTime:"",endTime:"",value:1}],defaultStaffAutoOnlineList:function(){return{value:0,staffIdList:[],staffName:"",workCycle:["1","2","3","4","5","6","7"],startTime:"",endTime:""}},openWelcomeScreen:!1,allowStaffOffline:!1,AddspareVisible:!1,spareList:[],messageVal:1,sparetext:"选填",base64:"",groupId:"",user:[],name:"",nameList:[],customerRemark:"",customerRemarkShow:!1,customerDescribe:"",customerDescribeShow:!1,maxLengthcustomerDescribe:150,numvalue:100,antoStart:!0,searchName:"",hasAddLimit:!1,hasTag:!1,visibleTag:!1,selectTagList:[],previewVisible:!1,previewImage:"",imageUrl:"",fileList:[],selectList:[],onlineTime:"allDay",autoTime:"allDay",weekList:["一","二","三","四","五","六","天"],welcomeSpanListShow:!1,welcomeSpanList:[{weekday:["1","2","3","4","5","6","7"],startTime:void 0,endTime:void 0,contentOne:"",attachments:[],message:{}}],AddTransfeVisible:!1,openStartTimeshow:null,openEndTimeshow:null,isBuildSucess:!1,urlCode:"",qrCode:"",maxLength:600,form:{innerText:"",welcomesNotificationType:!0},loading:!1,groupList:[],clickCheck:!0}},created:function(){this.id=this.$route.query.id||"",this.id&&this.getDetailPage(),this.getGroupList()},mounted:function(){this.$refs.pageWrap.scrollTop=0},computed:{welcomeScreenList:function(){return this.tagsItem.tags},textList:function(){var t,e=[];return this.form.innerText&&e.push(this.form.innerText.replace(/<span class="nick-name">/g," ").replace(/<\/span>/g," ")),(null===(t=this.attachments)||void 0===t?void 0:t.length)>0&&e.push.apply(e,Object(c["a"])(this.attachments)),e},selectRoleIdList:function(){return this.getStaffList.map((function(t){return t.source.staffId}))},selectCustomerIdList:function(){return this.spareList.map((function(t){return t.source.staffId}))},state:function(){return this.$route.query.state},contentOne:function(){var t;return(null===(t=this.form.innerText)||void 0===t?void 0:t.replace(/<span class="nick-name">用户昵称<\/span>/g,"#"))||""},isAddText:function(){var t="";switch(this.$route.query.state){case"add":t="新建";break;case"edit":t="修改";break;case"copy":t="复制";case"batchAdd":t="新建";break}return t},getStaffList:function(){var t,e,a=null===(t=this.staffAutoOnlineList)||void 0===t||null===(e=t.map((function(t){return t.staffIdList})))||void 0===e?void 0:e.flat(),i=[],n={};if((null===a||void 0===a?void 0:a.length)>1)for(var s=0;s<a.length;s++){var r=a[s].key;n[r]||(n[r]=1,i.push(a[s]))}else i=a;return i},getSelectList:function(){var t=[];return t="allDay"===this.onlineTime?this.selectList:this.getStaffList,t}},methods:{onlineTimeChange:function(t){"freedom"==t.target.value?this.sparetext="必填":this.sparetext="选填"},changeSelect:function(t,e){this.changeStartTime(t,e),this.changeEndTime(t,e)},changeStartTime:function(t,e){if(t.startTime&&!(t.staffIdList.length<=0)&&!(t.workCycle.length<=0)){var a=this,i=t.staffIdList.map((function(t){return t.title})),n=t.workCycle;a.conFlictflag=!1,a.staffAutoOnlineList.length>1?a.staffAutoOnlineList.map((function(s,r){if(s.endTime&&!(s.staffIdList.length<=0)&&!(s.workCycle.length<=0)&&t.value!=s.value){var o=s.staffIdList.map((function(t){return t.title})),c=!1;if(o.every((function(t){var e=i.indexOf(t);c=e<=-1})),!c){var l=new Set(i.concat(o)),u=Array.from(l);if(u.length<=i.length+o.length){var d=s.workCycle,m=new Set(n.concat(d)),f=Array.from(m);if(f.length<n.length+d.length){var p=a.$moment(t.startTime).isBetween(s.startTime,s.endTime);return p?(a.conFlictflag=!0,a.conFlictText="员工「".concat(o[0],"」的【周期").concat(e+1,"】 和【周期").concat(r+1,"】在").concat(V["f"][d[0]],"的时间有冲突"),void a.$message.warning(a.conFlictText)):void 0}a.conFlictflag=!1}else a.conFlictflag=!1}}})):a.conFlictflag=!1}},changeEndTime:function(t,e){if(t.endTime&&!(t.staffIdList.length<=0)&&!(t.workCycle.length<=0)){var a=this;a.conFlictflag=!1;var i=t.staffIdList.map((function(t){return t.title})),n=t.workCycle;a.staffAutoOnlineList.length>1?a.staffAutoOnlineList.map((function(s,r){if(s.endTime&&!(s.staffIdList.length<=0)&&!(s.workCycle.length<=0)&&t.value!=s.value){var o=s.staffIdList.map((function(t){return t.title})),c=!1;if(o.every((function(t){var e=i.indexOf(t);c=e<=-1})),!c){var l=new Set(i.concat(o)),u=Array.from(l);if(u.length<i.length+o.length){var d=s.workCycle,m=new Set(n.concat(d)),f=Array.from(m);if(f.length<n.length+d.length){var p=a.$moment(t.endTime).isBetween(s.startTime,s.endTime);return p?(a.conFlictflag=!0,a.conFlictText="员工「".concat(o[0],"」的【周期").concat(e+1,"】 和【周期").concat(r+1,"】在").concat(V["f"][d[0]],"的时间有冲突"),void a.$message.warning(a.conFlictText)):void 0}a.conFlictflag=!1}else a.conFlictflag=!1}}})):a.conFlictflag=!1}},addTag:function(t){t.value;var e=t.callBack;t.tagItem;e()},selectPerson:function(t,e){var a=this;setTimeout((function(){a.changeStartTime(t,e),a.changeEndTime(t,e)}),200)},addAtherWeekTime:function(){this.staffAutoOnlineList.push(this.defaultStaffAutoOnlineList()),this.staffAutoOnlineList.map((function(t,e){return t.value=e,Object.assign({},t)}))},deleteStaff:function(t){this.staffAutoOnlineList.splice(t,1)},getGroupList:function(){var t=this,e={pageSize:999,currentPage:1};Object(k["p"])(e).then((function(e){var a;if((null===(a=e.data)||void 0===a?void 0:a.list.length)>0){if(t.groupList=e.data.list,t.id)return;t.groupId=t.groupList[0].id}})).catch((function(e){t.$message.error(e)}))},getMember:function(){this.getSelectList.length>0?this.AddspareVisible=!0:this.$message.warning("请先选择客服人员")},AddTransshow:function(t){this.AddTransType=t,this.AddTransfeVisible=!0},insertNickname:function(){var t=document.createElement("span");t.className="nick-name",t.innerHTML="客户昵称",this.$refs.contenteditable.insertHtmlAtCaret(t)},hasAddLimitStaus:function(){if(this.hasAddLimit||this.allowStaffOffline?this.sparetext="必填":this.sparetext="选填",this.selectList.length<=0&&this.getStaffList.length<=0)return this.$message.warning("未添加使用成员，请先选择使用成员"),void(this.hasAddLimit=!1)},onChange:function(t,e){"allDay"===this.onlineTime?this.$set(this.selectList[e],"value",t):this.$set(this.getStaffList[e],"value",t)},onSearchName:function(){},serviceOk:function(t){this.AddTransfeVisible=!1,t.forEach((function(t){t.value=100})),this.selectList=t},servicespareOk:function(t){this.AddspareVisible=!1,this.spareList=t},closeTag:function(t){this.selectTagList.splice(t,1),this.selectTagList.length<=0&&(this.hasTag=!1)},serviceTagOk:function(t){this.selectTagList=t.filter((function(t){return t.selectTagList.length>0})).map((function(t){return t.selectTagList})).flat(),this.visibleTag=!1},closeDetel:function(t){this.selectList.splice(t,1),this.selectList.length<=0&&(this.hasAddLimit=!1)},closespareDetel:function(t){this.spareList.splice(t,1)},qrcodeCallback:function(t){var e=t.base64,a=t.imageUrl;this.base64=e,this.imageUrl=a,this.updatePic()},customRequest:function(t){t.onSuccess()},verify:function(){var t=this;return new Promise((function(e,a){if(t.loading&&a(),!t.name&&t.nameList.length<1)return t.$message.warning("未填写二维码名称"),void a("未填写二维码名称");if("allDay"===t.onlineTime){if(t.selectList.length<=0)return t.$message.warning("请先选择客服人员"),void a("请先选择客服人员")}else for(var i=0;i<t.staffAutoOnlineList.length;i++){var n,s,r=t.staffAutoOnlineList[i];if((null===(n=r.staffIdList)||void 0===n?void 0:n.length)<1)return t.$message.warning("工作周期".concat(i+1,"员工没有选择")),void a("");if((null===(s=r.workCycle)||void 0===s?void 0:s.length)<1)return t.$message.warning("工作周期".concat(i+1,"工作日期没有选择")),void a("");if(!r.startTime||!r.endTime)return t.$message.warning("工作周期".concat(i+1,"上线时间没有选择")),void a("");for(var o=i+1;o<t.staffAutoOnlineList.length;o++)if(Object(T["b"])(t.staffAutoOnlineList[o].startTime.format("HH:mm"),r.startTime.format("HH:mm"))){if(!Object(T["b"])(t.staffAutoOnlineList[o].startTime.format("HH:mm"),r.endTime.format("HH:mm")))return t.$message.warning("上线时间".concat(i+1,"个和上线时间").concat(o+1,"个时间存在重复")),void a()}else if(Object(T["b"])(t.staffAutoOnlineList[o].endTime.format("HH:mm"),r.startTime.format("HH:mm")))return t.$message.warning("上线时间".concat(i+1,"个和上线时间").concat(o+1,"个时间存在重复")),void a()}if(t.hasTag&&t.selectTagList.length<=0)return t.$message.warning("开启标签后，请先选择标签"),void a();if(t.customerRemarkShow&&!t.customerRemark)return t.$message.warning("开启客户备注后，请填写客户备注"),void a();if(t.customerDescribeShow&&!t.customerDescribe)return t.$message.warning("开启客户描述后，请填写客户描述"),void a();if(t.welcomeSpanListShow)for(var c=0;c<t.welcomeSpanList.length;c++){var l=t.welcomeSpanList[c];if(!l.weekday||l.weekday.length<1)return t.$message.warning("分时段欢迎语".concat(c+1,"发送日期不能为空")),void a();if(!l.startTime)return t.$message.warning("分时段欢迎语".concat(c+1,"开始日期不能为空")),void a();if(!l.endTime)return t.$message.warning("分时段欢迎语".concat(c+1,"结束日期不能为空")),void a();if(!l.contentOne)return t.$message.warning("分时段欢迎语".concat(c+1,"消息内容不能为空")),void a()}e()}))},sub:function(){var t=this;return Object(o["a"])(Object(r["a"])().mark((function e(){var a,i,n,s,c,l,u,d,m,f,p;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.verify();case 2:if(i=null===(a=t.welcomeSpanList.map((function(t){return t.attachments})))||void 0===a?void 0:a.flat(),t.conFlictflag&&t.$message.warning(t.conFlictText),n=t.getSelectList.map((function(t){return{staffId:t.source.staffId,userid:t.source.userid,staffAddLimit:t.value,todayAddNum:t.todayAddNum||0}})),s=t.hasTag?t.selectTagList.map((function(t){return{tagId:t.tagId,tagName:t.tagName}})):[],!t.antoStart){e.next=19;break}if("allDay"!=t.autoTime){e.next=13;break}c=void 0,l=void 0,u=!0,e.next=19;break;case 13:if(c=t.openStartTime,l=t.openEndTime,u=!1,t.openStartTime&&t.openEndTime){e.next=19;break}return t.$message.warning("自动通过好友开启选择时间段后，请先选择时间"),e.abrupt("return");case 19:if(!t.hasAddLimit&&!t.allowStaffOffline){e.next=26;break}if(!(t.spareList.length<=0)){e.next=23;break}return t.$message.warning("请选择备用员工"),e.abrupt("return");case 23:d=t.spareList.map((function(t){return{staffId:t.source.staffId,userid:t.source.userid}})),e.next=27;break;case 26:d=t.spareList.length<=0?[]:t.spareList.map((function(t){return{staffId:t.source.staffId,userid:t.source.userid}}));case 27:if("1"!=t.messageVal){e.next=31;break}if(t.form.innerText||!(t.attachments.length<1)){e.next=31;break}return t.$message.warning("消息内容不能为空"),e.abrupt("return");case 31:if("freedom"!==t.onlineTime){e.next=35;break}if(!(t.spareList.length<=0)){e.next=35;break}return t.$message.warning("请选择备用员工"),e.abrupt("return");case 35:return m="",t.form.innerText&&(m=t.form.innerText.replace(/<span class="nick-name">/g,"#").replace(/<\/span>/g,"#")),t.loading=!0,e.next=40,t.channelCodeUploadFileFun(i);case 40:return e.next=42,t.channelCodeUploadFileFun();case 42:f={nameList:"batchAdd"===t.state?t.nameList:[t.name],allowManualOffline:"allDay"!==t.onlineTime,user:n,groupId:t.groupId,tagList:s,backupUser:d,autoPassFriend:t.antoStart,openStaffAddLimit:Number(t.hasAddLimit),allDayOpen:u,openStartTime:c,openEndTime:l,customerRemark:t.customerRemark?t.customerRemark:"",customerDescribe:t.customerDescribeShow?t.customerDescribe:"",messageType:Number(t.messageVal),message:JSON.stringify({text:{content:m},attachments:t.getAttachments()||[]}),allowStaffOffline:Number(t.allowStaffOffline),openSpanWelcome:Number(t.welcomeSpanListShow),openWelcomeScreen:Number(t.openWelcomeScreen),welcomeScreenList:t.openWelcomeScreen?t.welcomeScreenList.map((function(t){return{keyword:t.tagName,codeId:t.codeId}})):[],staffAutoOnlineList:"allDay"===t.onlineTime?[]:t.staffAutoOnlineList.map((function(t){return{codeId:t.codeId,staffIdList:t.staffIdList.map((function(t){return t.source.staffId})),staffName:t.staffIdList.map((function(t){return t.title})).join(","),workCycle:t.workCycle.join(","),onlineStartTime:t.startTime.format("HH:mm"),onlineEndTime:t.endTime.format("HH:mm")}})),welcomeSpanList:t.welcomeSpanListShow?t.welcomeSpanList.map((function(e){return{weekDay:e.weekday.join(","),welcomeSpanId:e.welcomeSpanId,spanStartTime:e.startTime.format("HH:mm:ss"),spanEndTime:e.endTime.format("HH:mm:ss"),message:JSON.stringify({text:{content:e.contentOne.replace(/<span class="nick-name">/g,"#").replace(/<\/span>/g,"#")},attachments:t.getAttachments(e.attachments)||[]})}})):[]},t.id&&"edit"==t.state?(f.id=t.id,p=Object(k["u"])(f)):p=Object(k["b"])(f),t.isBuildSucess=!0,p.then(function(){var e=Object(o["a"])(Object(r["a"])().mark((function e(a){var i,n;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:null!==(i=a.data)&&void 0!==i&&null!==(n=i[0])&&void 0!==n&&n.qrCode&&(t.qrCode=a.data[0].qrCode,t.id=a.data[0].id),t.imageUrl?"edit"===t.state&&t.updatePic():(t.$message.success("".concat(t.isAddText,"活码成功")),t.$router.go(-1));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading=!1,t.$message.error(e)})).finally((function(){}));case 46:case"end":return e.stop()}}),e)})))()},updatePic:function(){var t=this;if(this.imageUrl&&this.qrCode&&this.isBuildSucess){var e={id:this.id,base64:this.base64};this.loading=!0,Object(k["v"])(e).catch((function(e){t.$message.error("二维码头像更新失败")})).finally((function(){t.$message.success("".concat(t.isAddText,"活码成功")),t.loading=!1,t.$router.go(-1)}))}},getDetailPage:function(){var t=this;Object(k["f"])({id:this.id}).then((function(e){var a,i=e.data;if(t.name=i.nameList[0],t.id=e.data.id,t.hasAddLimit=i.openStaffAddLimit,t.antoStart=i.autoPassFriend,t.messageVal=i.messageType,t.groupId=i.groupId,t.openWelcomeScreen=Boolean(i.openWelcomeScreen),t.allowStaffOffline=Boolean(i.allowStaffOffline),t.customerDescribe=i.customerDescribe||"",t.onlineTime=i.allowManualOffline?"freedom":"allDay",t.tagsItem.tags=null===(a=i.welcomeScreenList)||void 0===a?void 0:a.map((function(t){return Object(s["a"])(Object(s["a"])({},t),{},{tagName:t.keyword})})),1===i.openSpanWelcome&&t.getDetailWelcome(i),t.customerDescribe&&(t.customerDescribeShow=!0),t.customerRemark=i.customerRemark,t.customerRemark&&(t.customerRemarkShow=!0),i.message){var n,r=JSON.parse(i.message);t.attachments=t.attachmentsDetail(null===r||void 0===r?void 0:r.attachments),null!==r&&void 0!==r&&null!==(n=r.text)&&void 0!==n&&n.content&&(t.form.innerText=r.text.content.replace(/#客户昵称#​*/g,'<span class="nick-name">客户昵称</span>'))}i.tagList.length>0?(t.hasTag=!0,t.selectTagList=i.tagList):(t.hasTag=!1,t.selectTagList=[]),t.openStaffAddLimit?t.sparetext="必填":t.sparetext="选填",t.qrCode=e.data.qrCode,t.urlCode=e.data.urlCode,t.getDetailSelectList(i),t.getAutoTime(i),t.getDetailspareList(i)})).catch((function(e){t.$message.error(e)}))},getDetailspareList:function(t){t.backupUser?this.spareList=t.backupUser.map((function(t){return{source:Object(s["a"])(Object(s["a"])({},t),{},{thumbAvatar:t.staffAvatar,staffId:t.staffId,userid:t.userid}),key:String(t.userid),title:t.staffName}})):this.spareList=[]},getDetailSelectList:function(t){var e=this;t.user&&!t.allowManualOffline?this.selectList=t.user.map((function(t){t.title=t.staffName;var e=Object(s["a"])(Object(s["a"])({},t),{},{thumbAvatar:t.staffAvatar,staffId:t.staffId,userid:t.userid});return t.key=String(t.userid),t.value=t.staffAddLimit,t.todayAddNum=t.todayAddNum,t.source=e,Object.assign({},t)})):(t.staffAutoOnlineList.forEach((function(a){var i;a.startTime=e.$moment(a.onlineStartTime,"HH:mm"),a.endTime=e.$moment(a.onlineEndTime,"HH:mm"),a.workCycle=null===(i=a.workCycle)||void 0===i?void 0:i.split(","),a.staffIdList=a.staffIdList.map((function(e){var a=t.user.find((function(t){return t.staffId===e}));return e={title:a.staffName,key:String(a.userid),value:a.staffAddLimit,todayAddNum:a.todayAddNum,source:Object(s["a"])(Object(s["a"])({},a),{},{thumbAvatar:a.staffAvatar,staffId:a.staffId,userid:a.userid})},e}))})),this.staffAutoOnlineList=t.staffAutoOnlineList,this.selectList=[])},getDetailWelcome:function(t){var e=this;this.welcomeSpanListShow=!0,this.welcomeSpanList=t.welcomeSpanList.map((function(t){var a,i=[],n="";if(t.message){var r,o=JSON.parse(t.message);i=e.attachmentsDetail(null===o||void 0===o?void 0:o.attachments),null!==o&&void 0!==o&&null!==(r=o.text)&&void 0!==r&&r.content&&(n=o.text.content.replace(/#客户昵称#​*/g,'<span class="nick-name">客户昵称</span>'))}return Object(s["a"])(Object(s["a"])({},t),{},{weekday:null===(a=t.weekDay)||void 0===a?void 0:a.split(","),startTime:e.$moment(t.spanStartTime,"HH:mm:ss"),endTime:e.$moment(t.spanEndTime,"HH:mm:ss"),message:"",attachments:i,contentOne:n})}))},getAutoTime:function(t){if(t.allDayOpen)this.autoTime="allDay";else{this.autoTime="freedom";var e=Date.parse(new Date),a=this.timestampToTime(e,t.openStartTime),i=y()(a);i._f="HH:mm:ss",i._i=i._i.split(" ")[1],this.openStartTimeshow=i,this.openStartTime=t.openStartTime;var n=this.timestampToTime(e,t.openEndTime),s=y()(n);s._f="HH:mm:ss",s._i=s._i.split(" ")[1],this.openEndTimeshow=s,this.openEndTime=t.openEndTime}},changeStartTimeSelf:function(t,e){this.openStartTimeshow=t,this.openStartTime=e;var a=Object(T["b"])(this.openStartTime,this.openEndTime,"start");a&&(this.openStartTimeshow="",this.openStartTime=void 0,this.$message.warning("开始时间不能大于结束时间"))},changeEndTimeSelf:function(t,e){this.openEndTimeshow=t,this.openEndTime=e;var a=Object(T["b"])(this.openStartTime,this.openEndTime,"end");a&&(this.openEndTimeshow="",this.openEndTime=void 0,this.$message.warning("结束时间不能小于开始时间"))},timestampToTime:function(t,e){var a=new Date(t),i=a.getFullYear()+"-",n=(a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1)+"-",s=a.getDate()+" ";a.getHours(),a.getMinutes(),a.getSeconds();return i+n+s+e+":00"}}},B=W,z=(a("281e"),Object(h["a"])(B,i,n,!1,null,"1ba20ae0",null));e["default"]=z.exports},d298:function(t,e,a){},d3ba:function(t,e,a){"use strict";a("e7a1")},d631:function(t,e,a){},d6b1:function(t,e,a){"use strict";a("260e")},e1b8:function(t,e,a){"use strict";a("c036")},e53d:function(t,e,a){},e6b1:function(t,e,a){"use strict";var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"phone-model"},[e("img",{staticClass:"bg",attrs:{src:"/imgs/chatBg.png"}}),e("div",{staticClass:"contant"},[e("p",{staticClass:"time"},[t._v(t._s(t.time))]),t.textList.length>0?e("ul",t._l(t.textList,(function(a,i){return e("li",{key:i,staticClass:"contant-list"},["img"===a.type?[e("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),e("div",{staticClass:"contant-main"},[e("img",{staticClass:"upload-img",attrs:{src:a.pic_url.compress}})])]:t._e(),"link"===a.type?[e("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),e("div",{staticClass:"contant-title"},[e("a-tooltip",{attrs:{title:a.linkTitle}},[e("p",{staticClass:"contant-subtitle"},[t._v(t._s(a.linkTitle))])]),e("div",{staticClass:"contant-contant"},[a.desc?e("a-tooltip",{attrs:{title:a.desc}},[e("span",[t._v(t._s(a.desc))])]):t._e(),e("a-avatar",{attrs:{src:a.coverUrl.compress,size:32,shape:"square"}})],1)],1)]:t._e(),a.type?t._e():[e("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),e("div",{staticClass:"contant-main"},[t._v(t._s(a))])]],2)})),0):t._e()])])},n=[],s={name:"PhoneModel",data:function(){return{time:this.$moment().format("HH:mm")}},props:{textList:{type:[Array],default:function(){return[]}}},watch:{textList:function(){}}},r=s,o=(a("8e34"),a("2877")),c=Object(o["a"])(r,i,n,!1,null,"1aa7a172",null);e["a"]=c.exports},e7a1:function(t,e,a){},f564:function(t,e,a){"use strict";a("3fc5")}}]);