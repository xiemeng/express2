(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7193eccb"],{"09a6":function(t,e,n){"use strict";n("8e6b")},"0a2c":function(t,e,n){"use strict";n("c0e2")},1011:function(t,e,n){"use strict";n("b0c0");var i=function(){var t=this,e=t._self._c;return e("div",[e("ul",t._l(t.sendContentList,(function(n,i){return e("li",{key:i,staticClass:"send-content"},[t.needTitle?e("span",[t._v("消息"+t._s(i+1)+"：")]):t._e(),e("div",{staticClass:"flex1"},[e("p",{staticClass:"radio"},[e("a-radio-group",{on:{change:function(e){return t.changeType(i)}},model:{value:n.msgType,callback:function(e){t.$set(n,"msgType",e)},expression:"item.msgType"}},t._l(t.msgTypeList,(function(n,i){return e("a-radio",{key:i,attrs:{value:n.id}},[t._v(" "+t._s(n.text)+" ")])})),1),0!==i?e("a-icon",{attrs:{type:"delete"},on:{click:function(e){return t.$emit("delContent",i)}}}):t._e()],1),0===n.msgType?e("div",{staticClass:"textarea-wrap"},[e("a-textarea",{staticClass:"textarea",attrs:{maxLength:n.maxLength,placeholder:"请输入内容",autoSize:{minRows:4,maxRows:4}},model:{value:n.msgContent,callback:function(e){t.$set(n,"msgContent",e)},expression:"item.msgContent"}}),n.maxLength?e("p",{staticClass:"statistics font-color-black-25"},[t._v(" "+t._s(n.msgContent.length)+"/"+t._s(n.maxLength)+" ")]):t._e()],1):t._e(),1===n.msgType?e("div",[e("FormList",{staticClass:"input",attrs:{formInfo:n.imageObj},model:{value:n.msgContent,callback:function(e){t.$set(n,"msgContent",e)},expression:"item.msgContent"}})],1):t._e(),2===n.msgType?e("div",[e("AddLinkWrap",{attrs:{editData:n.msgContent.form,isNeedSelectRadar:t.isNeedSelectRadar,source:t.source,isNeedRader:t.isNeedRader},model:{value:n.msgContent,callback:function(e){t.$set(n,"msgContent",e)},expression:"item.msgContent"}})],1):t._e(),3===n.msgType?e("div",{staticClass:"flex-pdf"},[n.pdfArr[0]?e("AccessoryList",{attrs:{item:n}}):t._e(),e("div",{staticClass:"flex-pdf"},[e("a-upload",{attrs:{"file-list":n.pdfArr,showUploadList:!1,accept:t.acceptPdf,customRequest:t.customRequest},on:{change:t.handleChange}},[n.pdfArr[0]?e("a-button",{attrs:{type:"link"}},[t._v("重新上传")]):e("div",{staticClass:"ant-upload"},[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(" 添加pdf ")])],1)],1),e("span",{staticClass:"font-color-black-25",staticStyle:{"margin-left":"10px"}},[t._v("请在20M以内")])],1)],1):t._e(),4===n.msgType?e("div",{staticClass:"flex-box"},[n.formObj.name?e("AccessoryList",{attrs:{item:n}}):t._e(),e("div",[n.formObj.name?e("a-button",{attrs:{type:"link"},on:{click:function(e){t.visibileForm=!0}}},[t._v("重新选择")]):e("div",{staticClass:"ant-upload",on:{click:function(e){t.visibileForm=!0}}},[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(" 选择素材 ")])],1)],1)],1):t._e(),5===n.msgType?e("div",{staticClass:"flex-pdf"},[n.videoArr[0]?e("AccessoryList",{attrs:{item:n}}):t._e(),e("div",{staticClass:"flex-pdf"},[e("a-upload",{attrs:{showUploadList:!1,accept:t.acceptVideo,customRequest:t.customRequest},on:{change:t.handleChangeVideo,preview:t.handlePreview}},[n.videoArr[0]?e("a-button",{attrs:{type:"link"}},[t._v("重新上传")]):e("div",{staticClass:"ant-upload"},[e("a-icon",{attrs:{type:"plus"}}),e("div",{staticClass:"ant-upload-text"},[t._v(" 上传视频 ")])],1)],1),e("span",{staticClass:"font-color-black-25",staticStyle:{"margin-left":"10px"}},[t._v("请在10M以内")])],1)],1):t._e()])])})),0),e("a-modal",{attrs:{footer:null,destroyOnClose:"",width:"880px",centered:""},model:{value:t.visibileForm,callback:function(e){t.visibileForm=e},expression:"visibileForm"}},[e("AddForm",{attrs:{editData:t.editData,source:t.source},on:{cancle:function(e){t.visibileForm=!1},serviceOk:t.serviceOk}})],1)],1)},s=[],a=n("5530"),r=n("c7eb"),o=n("1da1"),c=(n("7db0"),n("d3b7"),n("fb6a"),n("d81d"),n("26f2")),u=n("7807"),l=n("7581"),d=n("6536"),f={name:"TypeAccessory",components:{FormList:c["a"],AddLinkWrap:u["a"],AddForm:l["a"],AccessoryList:d["a"]},props:{sendContentList:{type:Array,default:function(){return[]}},needTitle:{type:Boolean,default:function(){return!0}},msgTypeList:{type:Array,default:function(){return[]}},source:{type:String,default:""},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0}},data:function(){return{acceptPdf:".pdf",acceptVideo:".MP4",visibileForm:!1,editData:{},formObj:{}}},watch:{sendContentList:function(){}},created:function(){},methods:{changeType:function(t){this.sendContentList[t].msgContent=""},handlePreview:function(t){var e=this;return Object(o["a"])(Object(r["a"])().mark((function n(){var i;return Object(r["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.url||t.preview){n.next=4;break}return n.next=3,e.getBase64(t.originFileObj);case 3:t.preview=n.sent;case 4:i=e.sendContentList.find((function(t){return 5===t.msgType})),i.videoArr[0].pdfFile=t.url||t.preview;case 6:case"end":return n.stop()}}),n)})))()},getBase64:function(t){return new Promise((function(e,n){var i=new FileReader;i.readAsDataURL(t),i.onload=function(){return e(i.result)},i.onerror=function(t){return n(t)}}))},handleChange:function(t){var e,n=this,i=t.fileList,s=i.slice(-1);(null===s||void 0===s||null===(e=s[0])||void 0===e?void 0:e.size)>2048e4?this.$message.warning("pdf不能大于20M"):setTimeout((function(){var t=n.sendContentList.find((function(t){return 3===t.msgType}));t.pdfArr=s.map((function(t){return Object(a["a"])(Object(a["a"])({},t),{},{status:"done",msgType:3})}))}),0)},handleChangeVideo:function(t){var e,n=this,i=t.fileList,s=i.slice(-1);(null===s||void 0===s||null===(e=s[0])||void 0===e?void 0:e.size)>1024e4?this.$message.warning("视频不能大于10M"):setTimeout((function(){n.getBase64(s[0].originFileObj).then((function(t){var e=n.sendContentList.find((function(t){return 5===t.msgType}));e.videoArr=s.map((function(e){return Object(a["a"])(Object(a["a"])({},e),{},{status:"done",msgType:5,pdfFile:t})}))}))}),0)},customRequest:function(t){t.onSuccess()},serviceOk:function(t){var e=this.sendContentList.find((function(t){return 4===t.msgType}));e.formObj=Object(a["a"])(Object(a["a"])({},t),{},{msgType:4}),this.visibileForm=!1}}},p=f,m=(n("0a2c"),n("2877")),v=Object(m["a"])(p,i,s,!1,null,"4b56a150",null);e["a"]=v.exports},"146f":function(t,e,n){"use strict";n("7d57")},"1b40":function(t,e,n){"use strict";n.d(e,"a",(function(){return C})),n.d(e,"c",(function(){return i["a"]})),n.d(e,"b",(function(){return w})),n.d(e,"d",(function(){return j}));var i=n("2b0e");
/**
  * vue-class-component v7.2.6
  * (c) 2015-present Evan You
  * @license MIT
  */function s(t){return s="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){return o(t)||c(t)||u()}function o(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function c(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function l(){return"undefined"!==typeof Reflect&&Reflect.defineMetadata&&Reflect.getOwnMetadataKeys}function d(t,e){f(t,e),Object.getOwnPropertyNames(e.prototype).forEach((function(n){f(t.prototype,e.prototype,n)})),Object.getOwnPropertyNames(e).forEach((function(n){f(t,e,n)}))}function f(t,e,n){var i=n?Reflect.getOwnMetadataKeys(e,n):Reflect.getOwnMetadataKeys(e);i.forEach((function(i){var s=n?Reflect.getOwnMetadata(i,e,n):Reflect.getOwnMetadata(i,e);n?Reflect.defineMetadata(i,s,t,n):Reflect.defineMetadata(i,s,t)}))}var p={__proto__:[]},m=p instanceof Array;function v(t){return function(e,n,i){var s="function"===typeof e?e:e.constructor;s.__decorators__||(s.__decorators__=[]),"number"!==typeof i&&(i=void 0),s.__decorators__.push((function(e){return t(e,n,i)}))}}function h(t){var e=s(t);return null==t||"object"!==e&&"function"!==e}function g(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var i in t.$options.props)t.hasOwnProperty(i)||n.push(i);n.forEach((function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){t[n]=e},configurable:!0})}))};var i=new e;e.prototype._init=n;var s={};return Object.keys(i).forEach((function(t){void 0!==i[t]&&(s[t]=i[t])})),s}var b=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured","serverPrefetch"];function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(t){if("constructor"!==t)if(b.indexOf(t)>-1)e[t]=n[t];else{var i=Object.getOwnPropertyDescriptor(n,t);void 0!==i.value?"function"===typeof i.value?(e.methods||(e.methods={}))[t]=i.value:(e.mixins||(e.mixins=[])).push({data:function(){return a({},t,i.value)}}):(i.get||i.set)&&((e.computed||(e.computed={}))[t]={get:i.get,set:i.set})}})),(e.mixins||(e.mixins=[])).push({data:function(){return g(this,t)}});var s=t.__decorators__;s&&(s.forEach((function(t){return t(e)})),delete t.__decorators__);var r=Object.getPrototypeOf(t.prototype),o=r instanceof i["a"]?r.constructor:i["a"],c=o.extend(e);return _(c,t,o),l()&&d(c,t),c}var k={prototype:!0,arguments:!0,callee:!0,caller:!0};function _(t,e,n){Object.getOwnPropertyNames(e).forEach((function(i){if(!k[i]){var s=Object.getOwnPropertyDescriptor(t,i);if(!s||s.configurable){var a=Object.getOwnPropertyDescriptor(e,i);if(!m){if("cid"===i)return;var r=Object.getOwnPropertyDescriptor(n,i);if(!h(a.value)&&r&&r.value===a.value)return}0,Object.defineProperty(t,i,a)}}}))}function O(t){return"function"===typeof t?y(t):function(e){return y(e,t)}}O.registerHooks=function(t){b.push.apply(b,r(t))};var C=O;var L="undefined"!==typeof Reflect&&"undefined"!==typeof Reflect.getMetadata;function x(t,e,n){if(L&&!Array.isArray(t)&&"function"!==typeof t&&!t.hasOwnProperty("type")&&"undefined"===typeof t.type){var i=Reflect.getMetadata("design:type",e,n);i!==Object&&(t.type=i)}}function w(t){return void 0===t&&(t={}),function(e,n){x(t,e,n),v((function(e,n){(e.props||(e.props={}))[n]=t}))(e,n)}}function j(t,e){void 0===e&&(e={});var n=e.deep,i=void 0!==n&&n,s=e.immediate,a=void 0!==s&&s;return v((function(e,n){"object"!==typeof e.watch&&(e.watch=Object.create(null));var s=e.watch;"object"!==typeof s[t]||Array.isArray(s[t])?"undefined"===typeof s[t]&&(s[t]=[]):s[t]=[s[t]],s[t].push({handler:n,deep:i,immediate:a})}))}},2314:function(t,e,n){"use strict";n("afd2")},"36b4":function(t,e,n){"use strict";n.d(e,"m",(function(){return a})),n.d(e,"b",(function(){return r})),n.d(e,"p",(function(){return o})),n.d(e,"k",(function(){return c})),n.d(e,"l",(function(){return u})),n.d(e,"q",(function(){return l})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return f})),n.d(e,"r",(function(){return p})),n.d(e,"o",(function(){return m})),n.d(e,"c",(function(){return v})),n.d(e,"n",(function(){return h})),n.d(e,"e",(function(){return g})),n.d(e,"d",(function(){return b})),n.d(e,"i",(function(){return y})),n.d(e,"a",(function(){return k})),n.d(e,"t",(function(){return _})),n.d(e,"f",(function(){return O})),n.d(e,"j",(function(){return C})),n.d(e,"s",(function(){return L}));var i=n("b775"),s={list:"/custservice/account/list",uploadMedia:"/client_group/upload/uploadMedia",add:"/custservice/account/add",update:"/custservice/account/update",delete:"/custservice/account/delete",info:"/custservice/account/info",channelSave:"/custservice/customerservicechannel/save",channelUpdate:"/custservice/customerservicechannel/update",getchannelList:"/custservice/customerservicechannel/list",channelDelete:"/custservice/customerservicechannel/delete",getkeyword:"/custservice/account/getkeyword",saveReceptionSet:"/custservice/account/saveReceptionSet",receptionistsList:"/custservice/customerserviceservicer/list",getByMember:"/custservice/data/getByMember",getByChannel:"/custservice/data/getByChannel",overview:"/custservice/data/overview",getListByMember:"/custservice/data/getListByMember",getListByChannel:"/custservice/data/getListByChannel",memberExport:"/custservice/data/memberExport",attendenceExport:"/custservice/data/attendenceExport",getOnLineDetailByMember:"/custservice/data/getOnLineDetailByMember"};function a(t){return Object(i["b"])({url:s.getOnLineDetailByMember,method:"post",data:t})}function r(t){return Object(i["b"])({url:s.attendenceExport,method:"post",data:t,responseType:"blob"})}function o(t){return Object(i["b"])({url:s.memberExport,method:"post",data:t,responseType:"blob"})}function c(t){return Object(i["b"])({url:s.getListByChannel,method:"post",data:t})}function u(t){return Object(i["b"])({url:s.getListByMember,method:"post",data:t})}function l(t){return Object(i["b"])({url:s.overview,method:"post",data:t})}function d(t){return Object(i["b"])({url:s.getByChannel,method:"post",data:t})}function f(t){return Object(i["b"])({url:s.getByMember,method:"post",data:t})}function p(t){return Object(i["b"])({url:s.receptionistsList,method:"post",data:t})}function m(t){return Object(i["b"])({url:s.getkeyword,method:"post",data:t})}function v(t){return Object(i["b"])({url:s.channelDelete,method:"post",data:t})}function h(t){return Object(i["b"])({url:s.getchannelList,method:"post",data:t})}function g(t){return Object(i["b"])({url:s.channelUpdate,method:"post",data:t})}function b(t){return Object(i["b"])({url:s.channelSave,method:"post",data:t})}function y(t){return Object(i["b"])({url:s.list,method:"post",data:t})}function k(t){return Object(i["b"])({url:s.add,method:"post",data:t})}function _(t){return Object(i["b"])({url:s.update,method:"post",data:t})}function O(t){return Object(i["b"])({url:s.delete,method:"post",data:t})}function C(t){return Object(i["b"])({url:s.info,method:"post",data:t})}function L(t){return Object(i["b"])({url:s.saveReceptionSet,method:"post",data:t})}},40572:function(t,e,n){"use strict";n("66cf")},"48f1":function(t,e,n){},6536:function(t,e,n){"use strict";n("b0c0");var i=function(){var t=this,e=t._self._c;return e("div",[0===t.item.msgType?e("div",[t._v(" "+t._s(t.item.msgContent)+" ")]):t._e(),1===t.item.msgType?e("div",[e("img",{staticClass:"image",attrs:{src:t.item.msgContent.compress}})]):t._e(),2===t.item.msgType?e("div",{staticClass:"card-box"},[e("img",{attrs:{src:t.item.msgContent.form.coverUrl.compress||"/imgs/default-cover.png"},on:{error:t.errorImg}}),e("div",{staticClass:"box-right"},[e("h5",[t._v(t._s(t.item.msgContent.form.linkTitle))]),e("p",[t._v(t._s(t.item.msgContent.form.desc))])])]):t._e(),3===t.item.msgType?e("div",{staticClass:"custom-pdf"},[e("a-avatar",{attrs:{size:60,src:"/icons/pdf.png",shape:"square"}}),e("div",{staticClass:"contant"},[e("p",[t._v(t._s(t.item.pdfArr[0].name))]),e("span",[t._v(t._s(t._f("getUnits")(t.item.pdfArr[0].size)))])])],1):t._e(),5===t.item.msgType?e("div",[e("video",{staticClass:"cover-img",attrs:{src:t.item.videoArr[0].pdfFile,controls:"",height:"100%"}})]):t._e(),4===t.item.msgType?e("div",{staticClass:"custom-form"},[e("h4",[t._v(t._s(t.item.formObj.name))]),e("div",{staticClass:"flex-box"},[e("p",{staticClass:"font-color-black-25"},[t._v(t._s(t.item.formObj.desc))]),e("a-avatar",{attrs:{size:40,src:t.item.formObj.cover,shape:"square"}})],1)]):t._e()])},s=[],a=n("ca00"),r={name:"AccessoryList",components:{},props:{item:{type:Object,default:function(){return{}}}},watch:{item:{handler:function(){},deep:!0,immediate:!0}},data:function(){return{}},filters:{getUnits:function(t){return Object(a["b"])(t)}},methods:{errorImg:function(t){t.target.src="/imgs/default-cover.png"}}},o=r,c=(n("146f"),n("2877")),u=Object(c["a"])(o,i,s,!1,null,"7b304a5e",null);e["a"]=u.exports},"66cf":function(t,e,n){},7581:function(t,e,n){"use strict";n("b0c0");var i=function(){var t=this,e=t._self._c;return e("CommonModal",t._b({on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},"CommonModal",t.sourceModal,!1),[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10}},[t.pageList.length>0?e("ul",{staticClass:"randar-list-wrap"},t._l(t.pageList,(function(n){return e("li",{key:n.formId,staticClass:"randar-list",on:{click:function(e){t.selectRandarId=n.formId}}},[e("header",{staticClass:"randar-head"},[e("div"),e("a-checkbox",{attrs:{checked:t.selectRandarId===n.formId}})],1),e("section",{staticClass:"randar-main"},[e("div",{staticClass:"randar-main-content"},[e("p",[t._v(t._s(n.name))]),e("p",{staticClass:"aks-tips"},[t._v(t._s(n.describe))])]),e("a-avatar",{attrs:{size:40,src:n.cover,shape:"square"}})],1)])})),0):e("a-empty"),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e(),!t.loading&&t.pageList.length>0?e("div",{staticClass:"loading-container"},[t._v("没有更多数据了")]):t._e()],1)])},s=[],a=n("2909"),r=(n("7db0"),n("d3b7"),n("2a86")),o=n("487a"),c=n.n(o),u=n("8f19"),l={name:"AddForm",directives:{infiniteScroll:c.a},components:{CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""}},data:function(){return{sourceModal:{title:"自定义表单"},pagination:{current:1,pageSize:10,total:0},form:{typeText:"自定义表单",type:"link",linkTitle:"",desc:"",coverUrl:{compress:""}},type:"",typeText:{1:"链接",2:"PDF",3:"文章",4:"文章"},typeImg:{1:"/imgs/default-cover.png",2:"/icons/pdf.png",3:"/imgs/default-cover.png",4:"/imgs/default-cover.png"},radarName:"",loading:!1,busy:!1,pageList:[],selectRandarId:""}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{serviceOk:function(){var t=this;if(this.selectRandarId){var e=this.pageList.find((function(e){return e.formId===t.selectRandarId}));e.typeText="自定义表单",e.linkTitle=e.name,e.desc=e.describe,e.type="link",e.key="visibileForm",e.linktype="form_link",e.coverUrl={compress:e.cover},this.$emit("serviceOk",e)}else this.$message.warning("请选择一个自定义表单")},init:function(){var t=this,e={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,source:this.source,status:1};this.loading=!0,Object(u["f"])(e).then((function(e){var n;e.data.list.length>0&&(n=t.pageList).push.apply(n,Object(a["a"])(e.data.list));if(t.pagination.current++,e.data.list.length<t.pagination.pageSize)return t.busy=!0,void(t.loading=!1);t.pagination.total=e.data.total})).catch((function(e){t.$message.error(e||e.message)}))},selectTab:function(t){this.type=t,this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},search:function(){this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},handleInfiniteOnLoad:function(){!this.busy&&this.init()}}},d=l,f=(n("2314"),n("2877")),p=Object(f["a"])(d,i,s,!1,null,"66fbf478",null);e["a"]=p.exports},"7d57":function(t,e,n){},"7f2b":function(t,e,n){},8857:function(t,e,n){"use strict";n("a453")},"8e6b":function(t,e,n){},"8f19":function(t,e,n){"use strict";n.d(e,"n",(function(){return a})),n.d(e,"q",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"j",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"l",(function(){return d})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return p})),n.d(e,"i",(function(){return m})),n.d(e,"g",(function(){return v})),n.d(e,"b",(function(){return h})),n.d(e,"k",(function(){return g})),n.d(e,"m",(function(){return b})),n.d(e,"c",(function(){return y})),n.d(e,"p",(function(){return k})),n.d(e,"o",(function(){return _}));var i=n("b775"),s={customerFormSave:"/client_transformation/customerForm/save",dateInfoList:"/client_transformation/customerFormData/dateInfoList",customerFormList:"/client_transformation/customerForm/list",customerFormInfo:"/client_transformation/customerForm/info",customerFormUpdate:"/client_transformation/customerForm/update",customerFormPublish:"/client_transformation/customerForm/publish",customerFormDelete:"/client_transformation/customerForm/delete",dataInfo:"/client_transformation/customerFormData/dataInfo",analysis:"/client_transformation/customerFormData/analysis",staffList:"/client_transformation/customerFormData/staffList",infoList:"/client_transformation/customerFormData/infoList",analysisExport:"/client_transformation/customerFormData/analysisExport",dataInfoExport:"/client_transformation/customerFormData/dataInfoExport",infoCityList:"/client_transformation/customerFormData/infoCityList",batchTags:"/client_transformation/customerFormData/batchTags",selectList:"/client_transformation/customerForm/userData/selectList",queryDataList:"/client_transformation/customerFormData/queryDataList"};function a(t){return Object(i["b"])({url:s.infoList,method:"post",data:t})}function r(t){return Object(i["b"])({url:s.staffList,method:"get",params:t})}function o(t){return Object(i["b"])({url:s.analysis,method:"get",params:t})}function c(t){return Object(i["b"])({url:s.dataInfo,method:"get",params:t})}function u(t){return Object(i["b"])({url:s.customerFormSave,method:"post",data:t})}function l(t){return Object(i["b"])({url:s.customerFormList,method:"get",params:t})}function d(t){return Object(i["b"])({url:s.dateInfoList,method:"get",params:t})}function f(t){return Object(i["b"])({url:s.customerFormDelete,method:"post",data:t})}function p(t){return Object(i["b"])({url:s.customerFormInfo,method:"get",params:t})}function m(t){return Object(i["b"])({url:s.customerFormUpdate,method:"post",data:t})}function v(t){return Object(i["b"])({url:s.customerFormPublish,method:"post",data:t})}function h(t){return Object(i["b"])({url:s.analysisExport,method:"get",params:t,responseType:"blob"})}function g(t){return Object(i["b"])({url:s.dataInfoExport,method:"get",params:t,responseType:"blob"})}function b(t){return Object(i["b"])({url:s.infoCityList,method:"get",params:t})}function y(t){return Object(i["b"])({url:s.batchTags,method:"post",data:t})}function k(t){return Object(i["b"])({url:s.selectList,method:"get",params:t})}function _(t){return Object(i["b"])({url:s.queryDataList,method:"post",data:t})}},"9e88":function(t,e,n){"use strict";n("48f1")},a453:function(t,e,n){},afd2:function(t,e,n){},c0e2:function(t,e,n){},c7b7:function(t,e,n){"use strict";n("b0c0");var i=function(){var t=this,e=t._self._c;return e("a-select",{staticStyle:{width:"180px"},attrs:{allowClear:1==t.defaultType,placeholder:"请选择客服账号",dropdownMatchSelectWidth:!1,dropdownStyle:t.dropdownStyle},on:{change:t.change},scopedSlots:t._u([{key:"dropdownRender",fn:function(n){return e("div",{staticStyle:{padding:"10px 8px"}},[e("div",{on:{mousedown:function(t){return t.preventDefault()}}},[t._v("全部客服（"+t._s(t.items.length)+"）")]),e("v-nodes",{attrs:{vnodes:n}})],1)}}]),model:{value:t.kfid,callback:function(e){t.kfid=e},expression:"kfid"}},t._l(t.items,(function(n,i){return e("a-select-option",{key:i,attrs:{value:n.kfid}},[e("a-avatar",{attrs:{src:n.img,size:23,shape:"square"}}),t._v(" "+t._s(n.name)+" ")],1)})),1)},s=[],a=n("c7eb"),r=n("1da1"),o=(n("a9e3"),n("36b4")),c={name:"Account",props:{timerNum:{type:Number,default:0},defaultType:{type:Number,default:0}},setup:function(){},components:{VNodes:{functional:!0,render:function(t,e){return e.props.vnodes}}},data:function(){return{kfid:"",dropdownStyle:{width:"260px"},items:[]}},created:function(){var t=this;return Object(r["a"])(Object(a["a"])().mark((function e(){return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:case"end":return e.stop()}}),e)})))()},methods:{init:function(){var t=this;Object(o["i"])().then((function(e){var n,i,s;0===t.defaultType?(t.kfid=null===(n=e.data)||void 0===n||null===(i=n.list)||void 0===i||null===(s=i[0])||void 0===s?void 0:s.kfid,t.$emit("changeCustomer",t.kfid)):t.kfid=void 0;t.items=e.data.list})).catch((function(e){t.$message.error(e)}))},clearList:function(){this.kfid=void 0},change:function(t){this.$emit("changeCustomer",t)}},watch:{timerNum:function(){this.init()}}},u=c,l=n("2877"),d=Object(l["a"])(u,i,s,!1,null,"532fb7b4",null);e["a"]=d.exports},eed2:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",[t.kefu?t._e():e("div",{staticClass:"error-tips"},[e("a-icon",{attrs:{type:"exclamation-circle"}}),t._v("   您暂时还没开通微信客服功能，请前去开通 ")],1),e("a-tabs",{on:{change:t.tabChange},model:{value:t.defaultVal,callback:function(e){t.defaultVal=e},expression:"defaultVal"}},[e("a-tab-pane",{key:"1",attrs:{tab:"质检设定"}},[e("Keywords")],1),e("a-tab-pane",{key:"2",attrs:{tab:"聊天记录查询"}},[e("ChatRecord",{attrs:{timerNum:t.timerNum}})],1)],1)],1)},s=[],a=n("9ab4"),r=n("1b40"),o=(n("b0c0"),function(){var t=this,e=t._self._c;return e("div",[e("header",{staticClass:"header"},[e("a-space",{attrs:{size:12}},[e("a-button",{attrs:{type:"primary",size:"large"},on:{click:t.addContent}},[t._v(" 新建关键词 ")])],1),e("div",{staticClass:"flex-box"},[e("span",{staticClass:"label"},[t._v("关键词:")]),e("a-input-search",{staticStyle:{width:"220px"},attrs:{allowClear:"",placeholder:"请输入关键词"},on:{blur:t.searchName,search:t.searchName},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),e("span",{staticClass:"label"},[t._v("发送成员:")]),e("div",{staticClass:"use-person",on:{click:function(e){t.visibleUsePerson=!0}}},[e("ul",{staticClass:"a-line-omit"},[t._l(t.serviceList,(function(n){return e("li",{key:n.key,staticClass:"a-line-omit"},[e("a-tag",[t._v(t._s(n.title))])],1)})),t.serviceList.length<1?e("p",{staticClass:"font-color-black-25"},[t._v("请选择发送成员")]):t._e()],2),t.serviceList.length>2?e("span",{staticClass:"omit"},[t._v("等"+t._s(t.serviceList.length)+"个账号")]):t._e(),e("div",{staticClass:"icon"},[t.serviceList.length<1?e("a-icon",{attrs:{type:"down"}}):t._e(),t.serviceList.length>0?e("a-icon",{staticClass:"close-circle",attrs:{type:"close-circle"},on:{click:function(e){return e.stopPropagation(),t.clean.apply(null,arguments)}}}):t._e()],1)])],1)],1),e("a-table",{staticClass:"background-white",attrs:{pagination:t.pagination,columns:t.columns,"data-source":t.channelList},on:{change:t.change},scopedSlots:t._u([{key:"keywords",fn:function(n){return e("div",{},t._l(n,(function(n,i){return e("a-tag",{key:i},[t._v(" "+t._s(n.keyword)+" ")])})),1)}},{key:"staffInfo",fn:function(n){return e("div",{},[t._l(n,(function(n,i){return e("div",{directives:[{name:"show",rawName:"v-show",value:i<=t.openNum,expression:"index <= openNum"}],key:i,staticStyle:{"margin-bottom":"10px"}},[e("a-avatar",{attrs:{src:n.avatar}}),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(n.name))])],1)})),n.length>3?e("span",{staticClass:"switch",on:{click:t.changeNum}},[t._v(t._s(t.openNum>98?"关闭":"展开"))]):t._e()],2)}},{key:"status",fn:function(n){return e("div",{},[e("a-switch",{attrs:{checked:Boolean(n.isEnable)},on:{click:function(e){return t.changeStatus(n)}}}),t._v("    "),e("span",[t._v(t._s(0===n.isEnable?"关闭":"启用"))])],1)}},{key:"operation",fn:function(n){return e("div",{},[e("a-space",{attrs:{size:12}},[e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.editList(n)}}},[t._v("编辑")]),e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.deleteList(n)}}},[t._v("删除")])],1)],1)}}])}),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"599px"},model:{value:t.visibileForm,callback:function(e){t.visibileForm=e},expression:"visibileForm"}},[e("AddReply",{attrs:{editData:t.editData},on:{cancle:function(e){t.visibileForm=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,width:"680px",centered:"",destroyOnClose:""},model:{value:t.visibleUsePerson,callback:function(e){t.visibleUsePerson=e},expression:"visibleUsePerson"}},[e("AddTransfer",{attrs:{type:"deptId",title:"请选择客服",selectList:t.serviceList,selectRoleIdList:t.selectRoleIdList},on:{serviceOk:t.serviceCustomer,cancle:function(e){t.visibleUsePerson=!1}}})],1)],1)}),c=[],u=n("5530"),l=(n("a15b"),n("d81d"),function(){var t=this,e=t._self._c;return e("CommonModal",{attrs:{title:t.title},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:t.serviceOk}},[e("ul",{staticClass:"main"},[e("li",{staticClass:"list"},[e("label",{staticClass:"label"},[t._v("是否启用:")]),e("div",[e("a-switch",{model:{value:t.isEnable,callback:function(e){t.isEnable=e},expression:"isEnable"}})],1)]),e("li",{staticClass:"list"},[e("label",{staticClass:"label"},[t._v("关键词:")]),e("div",{staticClass:"content input"},[t._l(t.tagList,(function(n){return e("div",{key:n.key,staticClass:"input-list"},[e("a-input",{staticStyle:{width:"90%","margin-right":"8px"},attrs:{placeholder:"请输入关键词"},model:{value:n.value,callback:function(e){t.$set(n,"value",e)},expression:"domain.value"}}),t.tagList.length>1?e("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===t.tagList.length},on:{click:function(e){return t.removeDomain(n)}}}):t._e()],1)})),e("a-button",{staticStyle:{padding:"0"},attrs:{type:"link"},on:{click:t.addDomain}},[e("a-icon",{attrs:{type:"plus-circle"}}),t._v(" 添加关键词 ")],1)],2)]),e("li",{staticClass:"list",attrs:{id:"section"}},[e("label",{staticClass:"label"},[t._v("回复内容:")]),e("div",{staticClass:"content"},[e("TypeAccessory",{attrs:{sendContentList:t.sendContentList,msgTypeList:t.msgTypeList,isNeedSelectRadar:!1,isNeedRader:!1,needTitle:!1,source:"person_sop"},on:{delContent:t.delContent}}),e("div",{staticStyle:{color:"red"}},[t._v("客服人员用 %serviceruser 代替 ，触发的关键词用 %keyword 代替")])],1)]),e("li",{staticClass:"list",attrs:{id:"section"}},[e("label",{staticClass:"label"},[t._v("发送员工:")]),e("div",{staticClass:"use-person",on:{click:function(e){t.visibleUsePerson=!0}}},[e("ul",{staticClass:"a-line-omit"},[t._l(t.serviceList,(function(n){return e("li",{key:n.key,staticClass:"a-line-omit"},[e("a-tag",[t._v(t._s(n.title))])],1)})),t.serviceList.length<1?e("p",{staticClass:"font-color-black-25"},[t._v("请选择发送成员")]):t._e()],2),t.serviceList.length>2?e("span",{staticClass:"omit"},[t._v("等"+t._s(t.serviceList.length)+"个账号")]):t._e(),e("div",{staticClass:"icon"},[t.serviceList.length<1?e("a-icon",{attrs:{type:"down"}}):t._e(),t.serviceList.length>0?e("a-icon",{staticClass:"close-circle",attrs:{type:"close-circle"},on:{click:function(e){return e.stopPropagation(),t.clean.apply(null,arguments)}}}):t._e()],1)])])]),e("a-modal",{attrs:{footer:null,width:"680px",centered:"",destroyOnClose:""},model:{value:t.visibleUsePerson,callback:function(e){t.visibleUsePerson=e},expression:"visibleUsePerson"}},[e("AddTransfer",{attrs:{type:"deptId",title:"请选择客服",selectList:t.serviceList,selectRoleIdList:t.selectRoleIdList},on:{serviceOk:t.serviceCustomer,cancle:function(e){t.visibleUsePerson=!1}}})],1)],1)}),d=[],f=n("2909"),p=(n("a434"),n("d3b7"),n("a9e3"),n("4de4"),n("c740"),n("159b"),n("2a86")),m=n("1011"),v=n("1eb1"),h=n("b775"),g={inspectkeywordList:"/custservice/inspectkeyword/list",inspectkeywordAdd:"/custservice/inspectkeyword/add",inspectkeywordUpdate:"/custservice/inspectkeyword/update",inspectkeywordDelete:"/custservice/inspectkeyword/delete",inspectkeywordSearch:"/custservice/chat/search"};function b(t){return Object(h["b"])({url:g.inspectkeywordList,method:"post",data:t})}function y(t){return Object(h["b"])({url:g.inspectkeywordAdd,method:"post",data:t})}function k(t){return Object(h["b"])({url:g.inspectkeywordUpdate,method:"post",data:t})}function _(t){return Object(h["b"])({url:g.inspectkeywordDelete,method:"post",data:t})}function O(t){return Object(h["b"])({url:g.inspectkeywordSearch,method:"post",data:t})}var C={name:"AddReply",components:{CommonModal:p["a"],TypeAccessory:m["a"],AddTransfer:v["a"]},props:{editData:{type:Object,default:function(){return{}}}},computed:{},data:function(){return{title:"新建关键词",msgTypeList:[{id:0,text:"文字",type:"text",maxLength:200}],serviceList:[],isEnable:!0,selectRoleIdList:[""],visibleUsePerson:!1,sendContentList:[{msgType:0,imageObj:{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}},maxLength:2e3,msgContent:"",pdfArr:[],formObj:{}}],defaultSendContentList:function(){return{msgType:0,imageObj:{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}},msgContent:"",pdfArr:[],formObj:{}}},tagList:[{value:"",key:Date.now()}],key:""}},watch:{editData:{handler:function(){this.editData.contentId?(this.isEnable=Boolean(this.editData.isEnable),this.sendContentList[0].msgContent=this.editData.contentOne,this.tagList=this.editData.keywords.map((function(t){return{value:t.keyword,keywordId:t.keywordId}})),this.serviceList=this.editData.receivesStaff.map((function(t){return{key:t.userid,title:t.name,source:{userid:t.userid,name:t.name,thumbAvatar:t.avatar,roleName:t.roleName}}})),this.title="修改关键词"):this.title="新建关键词"},deep:!0,immediate:!0}},methods:{clean:function(){this.serviceList=[]},removeDomain:function(t){var e=this.tagList.indexOf(t);-1!==e&&this.tagList.splice(e,1)},serviceCustomer:function(t){this.serviceList=t,this.visibleUsePerson=!1},addDomain:function(){this.tagList.length>=10?this.$message.warning("同一个规则至多只能设置10个关键词"):this.tagList.push({value:"",key:Date.now()})},verify:function(){var t=this;return new Promise((function(e,n){for(var i=0;i<t.tagList.length;i++){var s=t.tagList[i];s.value||n("请填写关键词")}for(var a=0;a<t.sendContentList.length;a++){var r=t.sendContentList[a];r.msgContent||n("请填写回复内容")}t.serviceList.length<=0&&n("请选择发送成员"),e()}))},serviceOk:function(){var t=this;this.verify().then((function(e){t.editData.contentId?t.inspectkeywordUpdateFun():t.inspectkeywordAddFun()})).catch((function(e){t.$message.warning(e||e.message)}))},inspectkeywordAddFun:function(){var t,e,n=this,i={isEnable:Number(this.isEnable),contentOneType:0,contentOne:null===(t=this.sendContentList[0])||void 0===t?void 0:t.msgContent,receivesStaff:this.serviceList.map((function(t){return{userid:t.key}})),keywords:null===(e=this.tagList)||void 0===e?void 0:e.map((function(t){return{keyword:t.value}}))};y(i).then((function(t){n.$message.success("新建成功"),n.$emit("serviceOk")})).catch((function(t){n.$message.error(t||t.message)}))},getDeleteKeyWord:function(){var t=this,e=this.editData.keywords.filter((function(e){var n=t.tagList.findIndex((function(t){return t.keywordId===e.keywordId}));return n<0}));return null===e||void 0===e||e.forEach((function(t){t.isDeleted=1})),e},inspectkeywordUpdateFun:function(){var t,e,n,i=this,s={isEnable:Number(this.isEnable),contentId:this.editData.contentId,contentOneType:0,contentOne:null===(t=this.sendContentList[0])||void 0===t?void 0:t.msgContent,receivesStaff:this.serviceList.map((function(t){return{userid:t.key}})),keywords:null===(e=this.tagList)||void 0===e?void 0:e.map((function(t){return{keyword:t.value,keywordId:t.keywordId}}))};(n=s.keywords).push.apply(n,Object(f["a"])(this.getDeleteKeyWord())),k(s).then((function(t){i.$message.success("修改成功"),i.$emit("serviceOk")})).catch((function(t){i.$message.error(t||t.message)}))},delContent:function(t){this.sendContentList.splice(t,1)},addContent:function(){this.sendContentList.push(this.defaultSendContentList()),this.$nextTick((function(){var t=document.getElementById("section");t.scrollHeight>t.clientHeight&&setTimeout((function(){t.scrollTop=t.scrollHeight}),300)}))}}},L=C,x=(n("9e88"),n("2877")),w=Object(x["a"])(L,l,d,!1,null,"37c83146",null),j=w.exports,T={name:"Keywords",components:{AddReply:j,AddTransfer:v["a"]},data:function(){return{channelList:[],visibileForm:!1,serviceList:[],openNum:2,selectRoleIdList:[""],visibleUsePerson:!1,editData:{},keyword:"",columns:[{title:"关键词",key:"keywords",dataIndex:"keywords",scopedSlots:{customRender:"keywords"}},{title:"回复内容",key:"contentOne",dataIndex:"contentOne",width:"400px"},{title:"发送成员",key:"staffInfo",dataIndex:"staffInfo",scopedSlots:{customRender:"staffInfo"}},{title:"状态",key:"status",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",key:"operation",align:"right",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],pagination:{current:1,pageSize:10,total:0}}},created:function(){this.getPageList()},methods:{changeStatus:function(t){var e=this,n=0===t.isEnable?1:0,i={isEnable:n,contentOneType:0,contentOne:t.contentOne,receivesStaff:t.receivesStaff,keywords:t.keywords,contentId:t.contentId};k(i).then((function(t){e.$message.success("状态更新成功"),e.getPageList()})).catch((function(t){e.$message.error(t||t.message)}))},searchName:function(){this.pagination.current=1,this.getPageList()},change:function(t){var e=t.current;this.pagination.current=e,this.getPageList()},changeNum:function(){2===this.openNum?this.openNum=99:this.openNum=2},serviceCustomer:function(t){this.serviceList=t,this.visibleUsePerson=!1,this.getPageList()},getPageList:function(){var t=this,e={page:this.pagination.current,limit:this.pagination.pageSize,keyword:this.keyword,staffId:this.serviceList.map((function(t){return t.key})).join(",")};b(e).then((function(e){var n;null!==e&&void 0!==e&&e.data&&(t.channelList=null===(n=e.data.list)||void 0===n?void 0:n.map((function(t){return Object(u["a"])(Object(u["a"])({status:t,operation:t},t),{},{staffInfo:t.receivesStaff,key:t.contentId})})),t.pagination.total=e.data.total)})).catch((function(e){t.$message.error(e||e.message)}))},serviceOk:function(){this.visibileForm=!1,this.getPageList()},addContent:function(){this.visibileForm=!0,this.editData={}},clean:function(){this.serviceList=[],this.getPageList()},editList:function(t){this.visibileForm=!0,this.editData=t},deleteList:function(t){var e=this;this.$confirm({title:"提示",icon:"",content:"确定删除该关键词吗?",onOk:function(){e.inspectkeywordDelete(t.contentId)}})},inspectkeywordDelete:function(t){var e=this,n=[t];_(n).then((function(t){e.getPageList(),e.$message.success("删除成功")})).catch((function(t){e.$message.error(t||t.message)}))}}},S=T,D=(n("8857"),Object(x["a"])(S,o,c,!1,null,"068519a1",null)),I=D.exports,P=function(){var t=this,e=t._self._c;return e("div",[e("header",{staticClass:"header"},[e("div",{staticClass:"flex-box"},[e("span",{staticClass:"label"},[t._v("聊天内容:")]),e("a-input-search",{staticStyle:{width:"220px","margin-right":"20px"},attrs:{allowClear:"",placeholder:"请输入关键词"},on:{blur:t.searchName,search:t.searchName},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),e("a-select",{staticStyle:{width:"100px","margin-right":"10px"},on:{change:t.changePeriodTime},model:{value:t.timeSpace,callback:function(e){t.timeSpace=e},expression:"timeSpace"}},t._l(t.periodTime,(function(n){return e("a-select-option",{key:n.id,attrs:{value:n.id}},[t._v(" "+t._s(n.text)+" ")])})),1),t._v(" 自定义: "),e("a-range-picker",{staticStyle:{width:"300px","margin-right":"20px","margin-left":"5px"},attrs:{disabledDate:t.disabledDate,allowClear:!1},on:{change:t.changeDate},model:{value:t.startOrEndTime,callback:function(e){t.startOrEndTime=e},expression:"startOrEndTime"}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1),t._v(" 客服账号: "),e("Account",{staticStyle:{"margin-left":"5px"},attrs:{defaultType:1},on:{changeCustomer:t.changeCustomer}})],1)]),e("a-table",{staticClass:"background-white",attrs:{pagination:t.pagination,columns:t.columns,"data-source":t.channelList},on:{change:t.change},scopedSlots:t._u([{key:"origin",fn:function(n){return e("div",{},[e("span",[t._v(t._s(t.originList[n]))])])}},{key:"text",fn:function(n){return e("div",{},[t._v(" "+t._s(n.content)+" ")])}},{key:"servicerInfo",fn:function(n){return e("div",{},[n.servicerUserAvtar?e("a-avatar",{attrs:{src:n.servicerUserAvtar}}):e("span",{staticClass:"robot"},[e("a-icon",{attrs:{type:"robot"}})],1),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(n.servicerUserName||"机器人"))])],1)}},{key:"externalInfo",fn:function(n){return e("div",{},[e("a-avatar",{attrs:{src:n.externalUserAvtar}}),e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(n.externalUserName))])],1)}},{key:"operation",fn:function(n){return e("div",{},[e("a-space",{attrs:{size:12}},[e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.editList(n)}}},[t._v("详情")])],1)],1)}}])}),e("a-modal",{attrs:{footer:null,destroyOnClose:"",centered:"",width:"799px"},model:{value:t.visibileForm,callback:function(e){t.visibileForm=e},expression:"visibileForm"}},[e("ChatContent",{attrs:{editData:t.editData},on:{cancle:function(e){t.visibileForm=!1},serviceOk:t.serviceOk}})],1),e("a-modal",{attrs:{footer:null,width:"680px",centered:"",destroyOnClose:""},model:{value:t.visibleUsePerson,callback:function(e){t.visibleUsePerson=e},expression:"visibleUsePerson"}},[e("AddTransfer",{attrs:{type:"deptId",title:"请选择客服",selectList:t.serviceList,selectRoleIdList:t.selectRoleIdList},on:{serviceOk:t.serviceCustomer,cancle:function(e){t.visibleUsePerson=!1}}})],1)],1)},F=[],R=function(){var t=this,e=t._self._c;return e("CommonModal",{attrs:{title:t.title},on:{cancle:function(e){return t.$emit("cancle")},serviceOk:function(e){return t.$emit("cancle")}}},[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],ref:"listWrap",staticClass:"list-wrap",attrs:{"infinite-scroll-disabled":t.busy,"infinite-scroll-distance":10},on:{scroll:t.scrollEvent}},[t.upLoading?e("div",{staticClass:"loading-container"},[e("a-spin")],1):t._e(),t.groupOwners.length>0?e("ul",{staticClass:"scroll-content"},t._l(t.groupOwners,(function(n,i){return e("li",{key:i,staticClass:"title-wrap"},[e("p",{staticStyle:{"text-align":"center"}},[t._v(t._s(n.sendTimeFormat))]),3===n.origin?e("div",{staticClass:"flex-box"},[e("div",{staticStyle:{"margin-right":"10px"}},[e("a-avatar",{attrs:{src:n.externalUserAvtar,shape:"square"}})],1),e("div",{staticClass:"left-text"},[e("span",[t._v(t._s(n.text.content))])])]):t._e(),5===n.origin?e("div",{staticClass:"flex-box right"},[e("div",{staticClass:"right-text"},[e("span",[t._v(t._s(n.text.content))])]),e("div",{staticStyle:{"margin-left":"10px"}},[e("a-avatar",{attrs:{src:n.servicerUserAvtar,shape:"square"}})],1)]):t._e(),-1===n.origin?e("div",{staticClass:"flex-box right"},[e("div",[e("span",[t._v(t._s(n.text.content))])]),e("div",{staticStyle:{"margin-left":"10px"}},[e("span",{staticClass:"robot"},[e("a-icon",{attrs:{type:"robot"}})],1)])]):t._e()])})),0):e("a-empty"),t.loading?e("div",{staticClass:"loading-container"},[e("a-spin",{attrs:{tip:"正在加载中..."}})],1):t._e(),!t.loading&&t.groupOwners.length>0?e("div",{staticClass:"loading-container"},[t._v("没有更多数据了")]):t._e()],1)])},A=[],N=n("487a"),$=n.n(N),U={name:"ChatContent",components:{CommonModal:p["a"]},directives:{infiniteScroll:$.a},props:{editData:{type:Object,default:function(){return{}}}},computed:{},data:function(){return{title:"聊天详情",busy:!1,isNext:!0,upCurrent:1,upLoading:!1,groupOwners:[],loading:!0,once:0,upbusy:!1,isLoad:!1,pagination:{current:1,pageSize:10,total:0}}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{scrollEvent:function(t){var e=this;0!==t.target.scrollTop||this.isLoad||this.upbusy||(this.isNext=!1,this.upLoading=!0,this.init(this.upCurrent).then((function(t){e.upCurrent++,e.dispathListData(t,(function(){var n;(n=e.groupOwners).unshift.apply(n,Object(f["a"])(t.data.list.reverse())),e.$nextTick((function(){if(e.$refs.listWrap.scrollTop=40*t.data.list.length,e.groupOwners.length>=e.pagination.total)return e.upbusy=!0,void(e.upLoading=!1)}))}))})).then((function(t){e.upLoading=!1})))},init:function(t){var e=this;this.isLoad=!0;var n=Object(u["a"])({currentPage:t,pageSize:this.pagination.pageSize,isNext:this.isNext},this.editData);return new Promise((function(t,i){O(n).then((function(n){e.pagination.total=n.data.total,t(n)})).catch((function(t){e.loading=!1,i(),e.$message.error(t||t.message)})).finally((function(){e.isLoad=!1}))}))},dispathListData:function(t,e){var n,i=this;if(null!==t&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.list){var s=0;t.data.list.forEach((function(e,n){n>=1&&(e.sendTime-t.data.list[s].sendTime<=14400?e.sendTime="":s=n),e.sendTime&&(e.sendTimeFormat=i.$moment(1e3*e.sendTime).format("YYYY-MM-DD HH:mm:ss"))})),e()}},handleInfiniteOnLoad:function(){var t=this;this.busy||this.isLoad||(this.isNext=!0,this.init(this.pagination.current).then((function(e){t.pagination.current++,t.dispathListData(e,(function(){var n;(n=t.groupOwners).push.apply(n,Object(f["a"])(e.data.list)),t.$nextTick((function(){if(t.once||(t.once=1,t.$refs.listWrap.scrollTop=20),t.groupOwners.length>=t.pagination.total)return t.busy=!0,void(t.loading=!1)}))}))})))}}},E=U,M=(n("09a6"),Object(x["a"])(E,R,A,!1,null,"64890b82",null)),z=M.exports,B=n("c7b7"),Y={name:"ChatRecord",components:{ChatContent:z,AddTransfer:v["a"],Account:B["a"]},data:function(){return{channelList:[],visibileForm:!1,serviceList:[],openNum:2,selectRoleIdList:[""],timeSpace:7,startOrEndTime:void 0,visibleUsePerson:!1,editData:{},keyword:"",openKfid:"",columns:[{title:"发送来源",key:"origin",dataIndex:"origin",scopedSlots:{customRender:"origin"}},{title:"发送内容",key:"text",dataIndex:"text",scopedSlots:{customRender:"text"},width:"400px"},{title:"客服账号",key:"openKfidName",dataIndex:"openKfidName",scopedSlots:{customRender:"openKfidName"}},{title:"客服信息",key:"servicerInfo",dataIndex:"servicerInfo",scopedSlots:{customRender:"servicerInfo"}},{title:"客户信息",key:"externalInfo",dataIndex:"externalInfo",scopedSlots:{customRender:"externalInfo"}},{title:"发送时间",key:"sendTime",dataIndex:"sendTime",scopedSlots:{customRender:"sendTime"}},{title:"操作",key:"operation",align:"right",dataIndex:"operation",scopedSlots:{customRender:"operation"}}],originList:{"-1":"机器人客服",3:"微信客户",5:"企业微信客服"},periodTime:[{text:"今日",id:0},{text:"近一周",id:7},{text:"近一个月",id:30}],pagination:{current:1,pageSize:10,total:0}}},created:function(){this.changePeriodTime(this.timeSpace)},methods:{changeCustomer:function(t){this.openKfid=t||"",this.pagination.current=1,this.getPageList()},changePeriodTime:function(t){this.startOrEndTime=0===t?[this.$moment().subtract(t,"days"),this.$moment().subtract(t,"days")]:[this.$moment().subtract(t-1,"days"),this.$moment()],this.pagination.current=1,this.getPageList()},disabledDate:function(t){return t&&t>Date.now()},searchName:function(){this.pagination.current=1,this.getPageList()},change:function(t){var e=t.current;this.pagination.current=e,this.getPageList()},changeNum:function(){2===this.openNum?this.openNum=99:this.openNum=2},serviceCustomer:function(t){this.serviceList=t,this.visibleUsePerson=!1,this.getPageList()},getPageList:function(){var t,e,n,i,s=this,a={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,content:this.keyword,begin:(null===(t=this.startOrEndTime)||void 0===t||null===(e=t[0])||void 0===e?void 0:e.format("YYYY-MM-DD"))+" 00:00:00",end:(null===(n=this.startOrEndTime)||void 0===n||null===(i=n[1])||void 0===i?void 0:i.format("YYYY-MM-DD"))+" 23:59:59",openKfid:this.openKfid};O(a).then((function(t){var e;null!==t&&void 0!==t&&t.data&&(s.channelList=null===(e=t.data.list)||void 0===e?void 0:e.map((function(t,e){return Object(u["a"])(Object(u["a"])({operation:t,servicerInfo:t,externalInfo:t},t),{},{sendTime:s.$moment(1e3*t.sendTime).format("YYYY-MM-DD HH:mm:ss"),staffInfo:t.receivesStaff,key:e})})),s.pagination.total=t.data.total)})).catch((function(t){s.$message.error(t||t.message)}))},changeDate:function(t){t.length>0&&this.getPageList()},serviceOk:function(){this.visibileForm=!1,this.getPageList()},editList:function(t){var e;this.visibileForm=!0,this.editData={begin:null===(e=this.$moment(1e3*t.sendTime))||void 0===e?void 0:e.format("YYYY-MM-DD HH:mm:ss"),openKfid:t.kfid,servicerUserid:t.servicerUserid||"",externalUserid:t.externalUserid||""}}}},q=Y,K=(n("fca7"),Object(x["a"])(q,P,F,!1,null,"477936de",null)),H=K.exports,V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.defaultVal="1",e.timerNum=0,e}return Object(a["d"])(e,t),e.prototype.tabChange=function(){this.timerNum=(new Date).valueOf()},Object.defineProperty(e.prototype,"kefu",{get:function(){var t;return null===(t=this.$store.state.user.live)||void 0===t?void 0:t.kefu},enumerable:!1,configurable:!0}),e=Object(a["c"])([Object(r["a"])({components:{Keywords:I,ChatRecord:H}})],e),e}(r["c"]),W=V,J=W,G=(n("40572"),Object(x["a"])(J,i,s,!1,null,"504df13e",null));e["default"]=G.exports},fca7:function(t,e,n){"use strict";n("7f2b")}}]);