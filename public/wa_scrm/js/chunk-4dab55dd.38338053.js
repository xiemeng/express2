(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dab55dd"],{"413a":function(t,e,i){},"9e62":function(t,e,i){"use strict";i.r(e);i("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",[e("a-page-header",{staticClass:"page-header background-white",attrs:{title:"Segment Details"},on:{back:function(e){return t.$router.go(-1)}}}),e("a-spin",{attrs:{spinning:t.loadingHead}},[e("header",{staticClass:"header"},[e("div",{staticClass:"header-flex"},[e("h1",[t._v(t._s(t.name))]),e("div",[t._v(" "+t._s(t.form.task_type_text)+"    "+t._s(t.form.create_time)+" ")])]),e("div",[t._v(t._s(t.form.run_status))]),e("div",{staticClass:"header-flex"},[e("div",{staticClass:"left",on:{click:t.goUserDetails}},[e("a-tooltip",{attrs:{title:"View basic info and rules"}},[t._v(" "+t._s(t.form.resultValue)+" 人 "+t._s(t.form.create_time_text)+" "),t.form.resultValue>0?e("a-icon",{attrs:{type:"right"}}):t._e()],1)],1),e("div",{staticClass:"right"},[e("a-button",{attrs:{type:"primary"},on:{click:t.buildGroup}},[t._v("View Rule")]),t._v("  ")],1)])])]),e("section",{staticClass:"section"},[e("div",[e("header",{staticClass:"section-header"},[e("h2",[t._v("Segment Histories")]),e("a-range-picker",{on:{change:t.grounListFun},model:{value:t.startAndEndTime,callback:function(e){t.startAndEndTime=e},expression:"startAndEndTime"}})],1),e("div",{attrs:{id:"chat"}})]),e("a-table",{staticClass:"table",attrs:{columns:t.columns,"data-source":t.historyList,pagination:t.pagination,loading:t.tableLoading},scopedSlots:t._u([{key:"operation",fn:function(i){return e("div",{},[e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.downUser(i)}}},[t._v("下载")])],1)}}])})],1)],1)},n=[],o=i("5530"),s=(i("d3b7"),i("d81d"),i("a9e3"),i("4820")),r=i("ca00"),u=i("99afe"),l=i("c1df"),d=i.n(l),c={name:"GroupDetail",components:{},data:function(){return{historyList:[],columns:[{title:"Calculate Base Time",dataIndex:"resultDate",scopedSlots:{customRender:"base_time"},align:"center",key:"resultDate"},{title:"User Count",dataIndex:"resultValue",align:"center",key:"resultValue"}],pagination:{current:1,pageSize:10,total:0},downLoading:!1,form:{group_name:void 0,limit:void 0,remark:void 0,task_type:1,task_type_text:void 0},loadingHead:!1,tableLoading:!1,startAndEndTime:[d()().subtract(1,"day"),d()()],columnPlot:void 0}},mounted:function(){this.init()},computed:{id:function(){return this.$route.query.id},name:function(){return this.$route.query.name}},methods:{grounListFun:function(){var t=this,e={contactsGroupId:this.id,startTime:this.startAndEndTime[0].format("YYYY-MM-DD 00:00:00"),endTime:this.startAndEndTime[1].format("YYYY-MM-DD 00:00:00")};this.tableLoading=!0,Object(s["e"])(e).then((function(e){var i;t.historyList=null===(i=e.data)||void 0===i?void 0:i.map((function(t){return Object(o["a"])(Object(o["a"])({},t),{},{key:t.id,operation:t})})),t.randChat()})).catch((function(e){t.$message.error(e)})).finally((function(){t.tableLoading=!1}))},getChat:function(){var t,e=this;this.columnPlot=new u["Column"]("chat",{data:null===(t=this.historyList)||void 0===t?void 0:t.map((function(t){return{type:e.$moment(t.update_time).format("MM-DD"),sales:Number(t.user_count)}})),xField:"type",yField:"sales",maxColumnWidth:200,label:{position:"middle",style:{fill:"#FFFFFF",opacity:.6}},xAxis:{label:{autoHide:!0,autoRotate:!1}},meta:{type:{alias:"人数"},sales:{alias:"计算基准时间"}}})},randChat:function(){var t,e,i=this;this.columnPlot?this.columnPlot.options.data=null===(t=this.historyList)||void 0===t?void 0:t.map((function(t){return{type:i.$moment(t.resultDate).format("MM-DD"),sales:Number(t.resultValue)}})):this.columnPlot=new u["Column"]("chat",{data:null===(e=this.historyList)||void 0===e?void 0:e.map((function(t){return{type:i.$moment(t.resultDate).format("MM-DD"),sales:Number(t.resultValue)}})),xField:"type",yField:"sales",maxColumnWidth:200,label:{position:"middle",style:{fill:"#FFFFFF",opacity:.6}},xAxis:{label:{autoHide:!0,autoRotate:!1}},meta:{type:{alias:"人数"},sales:{alias:"Calculate Base Time"}}});this.columnPlot.render()},init:function(){this.groupDetailFun(),this.grounListFun()},groupDetailFun:function(){var t=this;this.loadingHead=!0,Object(s["f"])({contactsGroupId:this.id}).then((function(e){var i=e.data;t.form=Object(o["a"])(Object(o["a"])({},i),{},{group_name:i.group_name,limit:i.limit,remark:i.remark,create_time_text:t.$moment(i.create_time).format("MM-DD"),task_type_text:(i.task_type,""),task_type:Number(i.task_type)})})).catch((function(e){t.$message.error(e)})).finally((function(){t.loadingHead=!1}))},buildGroup:function(){this.$router.push({name:"BuildGroup",query:{id:this.id,isEdit:!0}})},downloadUserFun:function(){var t=this;this.downLoading=!0,Object(s["l"])({id:this.id}).then((function(t){Object(r["b"])(t,".csv","分群历史详情")})).catch((function(e){t.$message.error(e)})).finally((function(){t.downLoading=!1}))},downUser:function(t){var e=this,i={group_id:t.group_id,record_id:t.record_id};Object(s["c"])(i).then((function(t){Object(r["b"])(t,".csv","分群用户详情")})).catch((function(t){e.$message.error(t)}))},goUserDetails:function(){this.form.user_count<=0||this.$router.push({name:"UserDetails",query:{id:this.id,time:this.form.create_time}})}}},m=c,h=(i("e015"),i("2877")),f=Object(h["a"])(m,a,n,!1,null,"2e7bddda",null);e["default"]=f.exports},e015:function(t,e,i){"use strict";i("413a")}}]);