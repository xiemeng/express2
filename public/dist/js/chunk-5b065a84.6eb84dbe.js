(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5b065a84"],{"0a2c":function(e,t,a){"use strict";a("c0e2")},1011:function(e,t,a){"use strict";a("b0c0");var n=function(){var e=this,t=e._self._c;return t("div",[t("ul",e._l(e.sendContentList,(function(a,n){return t("li",{key:n,staticClass:"send-content"},[e.needTitle?t("span",[e._v("消息"+e._s(n+1)+"：")]):e._e(),t("div",{staticClass:"flex1"},[t("p",{staticClass:"radio"},[t("a-radio-group",{on:{change:function(t){return e.changeType(n)}},model:{value:a.msgType,callback:function(t){e.$set(a,"msgType",t)},expression:"item.msgType"}},e._l(e.msgTypeList,(function(a,n){return t("a-radio",{key:n,attrs:{value:a.id}},[e._v(" "+e._s(a.text)+" ")])})),1),0!==n?t("a-icon",{attrs:{type:"delete"},on:{click:function(t){return e.$emit("delContent",n)}}}):e._e()],1),0===a.msgType?t("div",{staticClass:"textarea-wrap"},[t("a-textarea",{staticClass:"textarea",attrs:{maxLength:a.maxLength,placeholder:"请输入内容",autoSize:{minRows:4,maxRows:4}},model:{value:a.msgContent,callback:function(t){e.$set(a,"msgContent",t)},expression:"item.msgContent"}}),a.maxLength?t("p",{staticClass:"statistics font-color-black-25"},[e._v(" "+e._s(a.msgContent.length)+"/"+e._s(a.maxLength)+" ")]):e._e()],1):e._e(),1===a.msgType?t("div",[t("FormList",{staticClass:"input",attrs:{formInfo:a.imageObj},model:{value:a.msgContent,callback:function(t){e.$set(a,"msgContent",t)},expression:"item.msgContent"}})],1):e._e(),2===a.msgType?t("div",[t("AddLinkWrap",{attrs:{editData:a.msgContent.form,isNeedSelectRadar:e.isNeedSelectRadar,source:e.source,isNeedRader:e.isNeedRader},model:{value:a.msgContent,callback:function(t){e.$set(a,"msgContent",t)},expression:"item.msgContent"}})],1):e._e(),3===a.msgType?t("div",{staticClass:"flex-pdf"},[a.pdfArr[0]?t("AccessoryList",{attrs:{item:a}}):e._e(),t("div",{staticClass:"flex-pdf"},[t("a-upload",{attrs:{"file-list":a.pdfArr,showUploadList:!1,accept:e.acceptPdf,customRequest:e.customRequest},on:{change:e.handleChange}},[a.pdfArr[0]?t("a-button",{attrs:{type:"link"}},[e._v("重新上传")]):t("div",{staticClass:"ant-upload"},[t("a-icon",{attrs:{type:"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(" 添加pdf ")])],1)],1),t("span",{staticClass:"font-color-black-25",staticStyle:{"margin-left":"10px"}},[e._v("请在20M以内")])],1)],1):e._e(),4===a.msgType?t("div",{staticClass:"flex-box"},[a.formObj.name?t("AccessoryList",{attrs:{item:a}}):e._e(),t("div",[a.formObj.name?t("a-button",{attrs:{type:"link"},on:{click:function(t){e.visibileForm=!0}}},[e._v("重新选择")]):t("div",{staticClass:"ant-upload",on:{click:function(t){e.visibileForm=!0}}},[t("a-icon",{attrs:{type:"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(" 选择素材 ")])],1)],1)],1):e._e(),5===a.msgType?t("div",{staticClass:"flex-pdf"},[a.videoArr[0]?t("AccessoryList",{attrs:{item:a}}):e._e(),t("div",{staticClass:"flex-pdf"},[t("a-upload",{attrs:{showUploadList:!1,accept:e.acceptVideo,customRequest:e.customRequest},on:{change:e.handleChangeVideo,preview:e.handlePreview}},[a.videoArr[0]?t("a-button",{attrs:{type:"link"}},[e._v("重新上传")]):t("div",{staticClass:"ant-upload"},[t("a-icon",{attrs:{type:"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(" 上传视频 ")])],1)],1),t("span",{staticClass:"font-color-black-25",staticStyle:{"margin-left":"10px"}},[e._v("请在10M以内")])],1)],1):e._e()])])})),0),t("a-modal",{attrs:{footer:null,destroyOnClose:"",width:"880px",centered:""},model:{value:e.visibileForm,callback:function(t){e.visibileForm=t},expression:"visibileForm"}},[t("AddForm",{attrs:{editData:e.editData,source:e.source},on:{cancle:function(t){e.visibileForm=!1},serviceOk:e.serviceOk}})],1)],1)},s=[],i=a("5530"),r=a("c7eb"),o=a("1da1"),c=(a("7db0"),a("d3b7"),a("fb6a"),a("d81d"),a("26f2")),l=a("7807"),u=a("7581"),d=a("6536"),p={name:"TypeAccessory",components:{FormList:c["a"],AddLinkWrap:l["a"],AddForm:u["a"],AccessoryList:d["a"]},props:{sendContentList:{type:Array,default:function(){return[]}},needTitle:{type:Boolean,default:function(){return!0}},msgTypeList:{type:Array,default:function(){return[]}},source:{type:String,default:""},isNeedRader:{type:Boolean,default:!0},isNeedSelectRadar:{type:Boolean,default:!0}},data:function(){return{acceptPdf:".pdf",acceptVideo:".MP4",visibileForm:!1,editData:{},formObj:{}}},watch:{sendContentList:function(){}},created:function(){},methods:{changeType:function(e){this.sendContentList[e].msgContent=""},handlePreview:function(e){var t=this;return Object(o["a"])(Object(r["a"])().mark((function a(){var n;return Object(r["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e.url||e.preview){a.next=4;break}return a.next=3,t.getBase64(e.originFileObj);case 3:e.preview=a.sent;case 4:n=t.sendContentList.find((function(e){return 5===e.msgType})),n.videoArr[0].pdfFile=e.url||e.preview;case 6:case"end":return a.stop()}}),a)})))()},getBase64:function(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){return t(n.result)},n.onerror=function(e){return a(e)}}))},handleChange:function(e){var t,a=this,n=e.fileList,s=n.slice(-1);(null===s||void 0===s||null===(t=s[0])||void 0===t?void 0:t.size)>2048e4?this.$message.warning("pdf不能大于20M"):setTimeout((function(){var e=a.sendContentList.find((function(e){return 3===e.msgType}));e.pdfArr=s.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{status:"done",msgType:3})}))}),0)},handleChangeVideo:function(e){var t,a=this,n=e.fileList,s=n.slice(-1);(null===s||void 0===s||null===(t=s[0])||void 0===t?void 0:t.size)>1024e4?this.$message.warning("视频不能大于10M"):setTimeout((function(){a.getBase64(s[0].originFileObj).then((function(e){var t=a.sendContentList.find((function(e){return 5===e.msgType}));t.videoArr=s.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{status:"done",msgType:5,pdfFile:e})}))}))}),0)},customRequest:function(e){e.onSuccess()},serviceOk:function(e){var t=this.sendContentList.find((function(e){return 4===e.msgType}));t.formObj=Object(i["a"])(Object(i["a"])({},e),{},{msgType:4}),this.visibileForm=!1}}},m=p,f=(a("0a2c"),a("2877")),h=Object(f["a"])(m,n,s,!1,null,"4b56a150",null);t["a"]=h.exports},"146f":function(e,t,a){"use strict";a("7d57")},"1f57":function(e,t,a){"use strict";a("ab3f")},2314:function(e,t,a){"use strict";a("afd2")},"239b":function(e,t,a){"use strict";a("9f4a")},"299d":function(e,t,a){},"2d24":function(e,t,a){},"329a":function(e,t,a){"use strict";a("fb6a");var n=function(){var e=this,t=e._self._c;return t("div",[t("a-button",{staticClass:"add-tag-button",attrs:{disabled:!e.examine},on:{click:e.showInput}},[t("a-icon",{attrs:{type:"plus"}}),e._v(e._s(e.title))],1),e.inputVisible?t("a-input",{ref:"input",style:{width:"120px"},attrs:{type:"text",inputVisible:"false",value:e.inputValue},on:{change:e.handleInputChange,blur:e.cancle,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleInputConfirm.apply(null,arguments)}}}):e._e(),e.examine?[e._l(e.tagslist,(function(a,n){return[a.tagName.length>20?t("a-tooltip",{key:n},[t("a-tag",{key:a.tagName,attrs:{closable:""},on:{close:function(t){return e.close(n)}}},[e._v(" "+e._s("".concat(a.tagName.slice(0,20),"..."))+" ")])],1):t("a-tag",{key:n,attrs:{closable:""},on:{close:function(t){return e.close(n)}}},[e._v(" "+e._s(a.tagName)+" ")])]}))]:[e._l(e.tagslist,(function(a,n){return[a.tagName.length>20?t("a-tooltip",{key:n},[t("a-tag",{key:a.tagName},[e._v(" "+e._s("".concat(a.tagName.slice(0,20),"..."))+" ")])],1):t("a-tag",{key:n},[e._v(" "+e._s(a.tagName)+" ")])]}))]],2)},s=[],i=(a("a434"),{name:"addTag",data:function(){return{inputVisible:!1,inputValue:"",index:""}},props:{title:{type:[String],default:"添加"},tagslist:{type:[Array],default:function(){return[]}},examine:{type:[Boolean],default:!0}},methods:{showInput:function(){this.inputVisible=!0,this.$nextTick((function(){this.$refs.input.focus()}))},handleInputChange:function(e){this.inputValue=e.target.value},cancle:function(){this.inputValue="",this.inputVisible=!1},close:function(e){this.tagslist.splice(e,1)},handleInputConfirm:function(){if(""!=this.inputValue){var e=this.inputValue;this.tagslist.push({tagName:e}),this.cancle()}else this.cancle()}}}),r=i,o=(a("e476"),a("2877")),c=Object(o["a"])(r,n,s,!1,null,"2e16dd79",null);t["a"]=c.exports},"3c83":function(e,t,a){"use strict";a("3c8b")},"3c8b":function(e,t,a){},"44aa":function(e,t,a){"use strict";a("f7f6")},"48c5":function(e,t,a){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",[t("a-col",[t("a-tree-select",{staticStyle:{width:"192px"},attrs:{"dropdown-style":{maxHeight:"300px",overflow:"auto"},"tree-data":e.treeData,"tree-default-expand-all":"",allowClear:e.allowClear},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1)],1)},s=[],i={data:function(){return{value:"全部部门",allowClear:!1}},watch:{value:function(e){this.$emit("selectDepartment",e),void 0===e?this.value="全部部门":this.allowClear="全部部门"!==e}},props:["treeData"]},r=i,o=a("2877"),c=Object(o["a"])(r,n,s,!1,null,null,null);t["a"]=c.exports},"53c2":function(e,t,a){"use strict";a("9f78")},"61a2":function(e,t,a){"use strict";a("7c1b")},6536:function(e,t,a){"use strict";a("b0c0");var n=function(){var e=this,t=e._self._c;return t("div",[0===e.item.msgType?t("div",[e._v(" "+e._s(e.item.msgContent)+" ")]):e._e(),1===e.item.msgType?t("div",[t("img",{staticClass:"image",attrs:{src:e.item.msgContent.compress}})]):e._e(),2===e.item.msgType?t("div",{staticClass:"card-box"},[t("img",{attrs:{src:e.item.msgContent.form.coverUrl.compress||"/imgs/default-cover.png"},on:{error:e.errorImg}}),t("div",{staticClass:"box-right"},[t("h5",[e._v(e._s(e.item.msgContent.form.linkTitle))]),t("p",[e._v(e._s(e.item.msgContent.form.desc))])])]):e._e(),3===e.item.msgType?t("div",{staticClass:"custom-pdf"},[t("a-avatar",{attrs:{size:60,src:"/icons/pdf.png",shape:"square"}}),t("div",{staticClass:"contant"},[t("p",[e._v(e._s(e.item.pdfArr[0].name))]),t("span",[e._v(e._s(e._f("getUnits")(e.item.pdfArr[0].size)))])])],1):e._e(),5===e.item.msgType?t("div",[t("video",{staticClass:"cover-img",attrs:{src:e.item.videoArr[0].pdfFile,controls:"",height:"100%"}})]):e._e(),4===e.item.msgType?t("div",{staticClass:"custom-form"},[t("h4",[e._v(e._s(e.item.formObj.name))]),t("div",{staticClass:"flex-box"},[t("p",{staticClass:"font-color-black-25"},[e._v(e._s(e.item.formObj.desc))]),t("a-avatar",{attrs:{size:40,src:e.item.formObj.cover,shape:"square"}})],1)]):e._e()])},s=[],i=a("ca00"),r={name:"AccessoryList",components:{},props:{item:{type:Object,default:function(){return{}}}},watch:{item:{handler:function(){},deep:!0,immediate:!0}},data:function(){return{}},filters:{getUnits:function(e){return Object(i["b"])(e)}},methods:{errorImg:function(e){e.target.src="/imgs/default-cover.png"}}},o=r,c=(a("146f"),a("2877")),l=Object(c["a"])(o,n,s,!1,null,"7b304a5e",null);t["a"]=l.exports},"65b6":function(e,t,a){},7581:function(e,t,a){"use strict";a("b0c0");var n=function(){var e=this,t=e._self._c;return t("CommonModal",e._b({on:{cancle:function(t){return e.$emit("cancle")},serviceOk:e.serviceOk}},"CommonModal",e.sourceModal,!1),[t("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.handleInfiniteOnLoad,expression:"handleInfiniteOnLoad"}],staticClass:"scroll-list",attrs:{"infinite-scroll-disabled":e.busy,"infinite-scroll-distance":10}},[e.pageList.length>0?t("ul",{staticClass:"randar-list-wrap"},e._l(e.pageList,(function(a){return t("li",{key:a.formId,staticClass:"randar-list",on:{click:function(t){e.selectRandarId=a.formId}}},[t("header",{staticClass:"randar-head"},[t("div"),t("a-checkbox",{attrs:{checked:e.selectRandarId===a.formId}})],1),t("section",{staticClass:"randar-main"},[t("div",{staticClass:"randar-main-content"},[t("p",[e._v(e._s(a.name))]),t("p",{staticClass:"aks-tips"},[e._v(e._s(a.describe))])]),t("a-avatar",{attrs:{size:40,src:a.cover,shape:"square"}})],1)])})),0):t("a-empty"),e.loading?t("div",{staticClass:"loading-container"},[t("a-spin",{attrs:{tip:"正在加载中..."}})],1):e._e(),!e.loading&&e.pageList.length>0?t("div",{staticClass:"loading-container"},[e._v("没有更多数据了")]):e._e()],1)])},s=[],i=a("2909"),r=(a("7db0"),a("d3b7"),a("2a86")),o=a("487a"),c=a.n(o),l=a("8f19"),u={name:"AddForm",directives:{infiniteScroll:c.a},components:{CommonModal:r["a"]},props:{editData:{type:Object,default:function(){return{}}},source:{type:String,default:""}},data:function(){return{sourceModal:{title:"自定义表单"},pagination:{current:1,pageSize:10,total:0},form:{typeText:"自定义表单",type:"link",linkTitle:"",desc:"",coverUrl:{compress:""}},type:"",typeText:{1:"链接",2:"PDF",3:"文章",4:"文章"},typeImg:{1:"/imgs/default-cover.png",2:"/icons/pdf.png",3:"/imgs/default-cover.png",4:"/imgs/default-cover.png"},radarName:"",loading:!1,busy:!1,pageList:[],selectRandarId:""}},watch:{editData:{handler:function(){},deep:!0,immediate:!0}},methods:{serviceOk:function(){var e=this;if(this.selectRandarId){var t=this.pageList.find((function(t){return t.formId===e.selectRandarId}));t.typeText="自定义表单",t.linkTitle=t.name,t.desc=t.describe,t.type="link",t.key="visibileForm",t.linktype="form_link",t.coverUrl={compress:t.cover},this.$emit("serviceOk",t)}else this.$message.warning("请选择一个自定义表单")},init:function(){var e=this,t={currentPage:this.pagination.current,pageSize:this.pagination.pageSize,source:this.source,status:1};this.loading=!0,Object(l["f"])(t).then((function(t){var a;t.data.list.length>0&&(a=e.pageList).push.apply(a,Object(i["a"])(t.data.list));if(e.pagination.current++,t.data.list.length<e.pagination.pageSize)return e.busy=!0,void(e.loading=!1);e.pagination.total=t.data.total})).catch((function(t){e.$message.error(t||t.message)}))},selectTab:function(e){this.type=e,this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},search:function(){this.pagination.current=1,this.pageList=[],this.busy=!1,this.init()},handleInfiniteOnLoad:function(){!this.busy&&this.init()}}},d=u,p=(a("2314"),a("2877")),m=Object(p["a"])(d,n,s,!1,null,"66fbf478",null);t["a"]=m.exports},"7c1b":function(e,t,a){},"7d57":function(e,t,a){},8242:function(e,t,a){},"842b":function(e,t,a){"use strict";var n=a("5530"),s=(a("d3b7"),a("d81d"),a("3ca3"),a("ddb0"),a("a15b"),a("a9e3"),a("b0c0"),a("9911"),a("d885")),i=a("cf5f");t["a"]={methods:{interactiveRadarUploadFile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.uploadFilePath;return new Promise((function(a,n){var s=new FormData;s.append("file",e),s.append("dir",t),Object(i["m"])(s).then((function(e){a(e.data)})).catch((function(e){n(e)}))}))},uploadMedia:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.attachments;return new Promise((function(a,n){var s=(null===t||void 0===t?void 0:t.map((function(t){return new Promise((function(a,n){if("link"===t.type&&t.isRadar&&!t.isMaterial)e.interactiveRadarAdd(t).then((function(e){a(e)})).catch((function(e){n(e)}));else if("img"===t.type){var s=new FormData;s.append("file",t.pic_url.file),s.append("dir","clientTransformation"),s.append("type","image"),Object(i["y"])(s).then((function(e){t.pic_url.fileUrl=e.data.fileUrl,t.pic_url.mediaId=e.data.mediaId,a(e.data)}))}else a()}))})))||[];Promise.all(s).then((function(e){a()})).catch((function(t){e.$message.error(t||t.message),e.loading=!1,n(t)}))}))},interactiveRadarAdd:function(e){var t=this;return new Promise((function(a,n){t.getParamsLink(e).then((function(t){Object(s["f"])(t).then((function(t){e.radarId=t.data.radarId,e.url=t.data.radarLink+e.source,a(t)})).catch((function(e){n(e)}))}))}))},getParamsLink:function(e){return new Promise((function(t,a){var n=new FormData,s=e.isCustomerTag?[{autoMarkTagBitmaps:e.selectCustomerTagList.map((function(e){return e.bitmap})).join(",")}]:[];if(n.append("type",1),n.append("radarName",e.linkTitle),n.append("link",e.url),n.append("activityNotify",Number(e.activityNotify)),n.append("behaviorNotify",Number(e.behaviorNotify)),n.append("tagRule",JSON.stringify(s)),n.append("title",e.radarTitle),n.append("desc",e.desc),n.append("hasCustomerTag",Number(e.isCustomerTag)),e.isScoreRule){var r=JSON.stringify(e.ruleDetails.map((function(e){var t,a;return{autoMarkTagBitmaps:null===(t=e.selectTagList)||void 0===t||null===(a=t.map((function(e){return e.bitmap})))||void 0===a?void 0:a.join(","),hasTag:Number(e.hasTag),score:e.score,ruleKind:e.ruleKind,count:e.count||0}})));n.append("scoreRule",r)}if(e.coverUrl.file){var o=new FormData;o.append("file",e.coverUrl.file),o.append("dir","clientTransformation"),Object(i["m"])(o).then((function(a){n.append("coverUrl",a.data),e.picurl=a.data,t(n)})).catch((function(e){a(e)}))}else t(n)}))},getMessageList:function(e){return e.map((function(e){var t="";if(0===e.msgType&&(t=e.msgContent,e.formObj={},e.pdfArr=[],e.videoArr=[]),1===e.msgType&&(t={compress:e.msgContent},e.imageObj={title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{compress:e.msgContent}},e.formObj={},e.pdfArr=[],e.videoArr=[]),2===e.msgType){e.pdfArr=[],e.videoArr=[];var a,s,i,r,o=JSON.parse(e.msgContent);if(t={form:{linkTitle:o.title,desc:o.desc,coverUrl:{compress:o.picUrl},type:"link",url:o.url}},e.interactRadar)t.form.isRadar=!0,t.form.behaviorNotify=Boolean(e.interactRadar.behaviorNotify),t.form.activityNotify=Boolean(e.interactRadar.activityNotify),t.form.isCustomerTag=(null===(a=e.interactRadar.tagRules)||void 0===a?void 0:a.length)>0,t.form.radarTitle=e.interactRadar.radarName,t.form.radarId=e.interactRadar.radarId,t.form.selectCustomerTagList=null===(s=e.interactRadar.tagRules[0])||void 0===s||null===(i=s.customerTags)||void 0===i?void 0:i.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{key:e.tagId})})),t.form.isScoreRule=(null===(r=e.interactRadar.scoreRules)||void 0===r?void 0:r.length)>0,t.form.ruleDetails=e.interactRadar.scoreRules.map((function(e){var t;return Object(n["a"])(Object(n["a"])({},e),{},{autoMarkTagBitmaps:e.autoMarkTagBitmaps,selectTagList:null===(t=e.customerTags)||void 0===t?void 0:t.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{key:e.tagId})})),hasTag:Boolean(e.hasTag),score:e.score,ruleKind:e.ruleKind,count:e.count})}))}if(3===e.msgType){var c=JSON.parse(e.msgContent);e.pdfArr=[Object(n["a"])(Object(n["a"])({},c),{},{uid:"1",status:"done"})],e.formObj={},e.videoArr=[]}if(4===e.msgType){var l=JSON.parse(e.msgContent);e.formObj=Object(n["a"])(Object(n["a"])({},l),{},{name:l.title}),e.pdfArr=[]}if(5===e.msgType){var u=JSON.parse(e.msgContent);e.videoArr=[Object(n["a"])({},u)],e.formObj={},e.pdfArr=[]}return Object(n["a"])(Object(n["a"])({},e),{},{msgContent:t})}))},getPlanList:function(e){var t=this;return e.map((function(e){return Object(n["a"])(Object(n["a"])({},e),{},{messageList:t.getAddMessageList(e.messageList)})}))},getAddMessageList:function(e){return e.map((function(e){var t="";if(0===e.msgType&&(t=e.msgContent),1===e.msgType&&(t=e.fileUrl||e.msgContent.compress),2===e.msgType){var a,n,s="";e.fileUrl?s=e.fileUrl:e.msgContent.form.picurl?s=e.msgContent.form.picurl:e.msgContent.form.coverUrl.compress&&(s=e.msgContent.form.coverUrl.compress);var i=e.msgContent.form.radarId||(null===(a=e.msgContent.form.interactRadar)||void 0===a?void 0:a.radarId);i&&(i=String(i)),t=JSON.stringify({desc:e.msgContent.form.desc,picUrl:s,url:e.msgContent.form.url,title:e.msgContent.form.linkTitle,radarId:i,type:e.msgContent.form.radarId||null!==(n=e.msgContent.form.interactRadar)&&void 0!==n&&n.radarId?"radar_link":"normal_link"})}return 3===e.msgType&&(t=JSON.stringify({pdfFile:e.pdfArr[0].fileUrl||e.pdfArr[0].pdfFile,name:e.pdfArr[0].name,size:e.pdfArr[0].size,cover:"https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/h5/img/pdf.png"})),4===e.msgType&&(t=JSON.stringify({cover:e.formObj.cover,desc:e.formObj.desc,title:e.formObj.name,url:e.formObj.link})),{messageId:e.messageId,msgType:e.msgType,msgContent:t}}))},getPlanFileList:function(e){var t=this,a=[];return e.length>0&&(a=e.map((function(e){return new Promise((function(a,n){var s,i,r,o;2===e.msgType?e.msgContent.form.isRadar&&e.msgContent.form.randerIsEdit?t.interactiveRadarAdd(e.msgContent.form).then((function(t){e.radarId=t.data,a(t)})).catch((function(e){n(e)})):e.msgContent.form.coverUrl.file?t.interactiveRadarUploadFile(e.msgContent.form.coverUrl.file).then((function(t){e.fileUrl=t,a(t)})).catch((function(e){n(e)})):a():1===e.msgType&&e.msgContent.file?t.interactiveRadarUploadFile(e.msgContent.file).then((function(t){e.fileUrl=t,a(t)})).catch((function(e){n(e)})):3===e.msgType&&null!==(s=e.pdfArr)&&void 0!==s&&null!==(i=s[0])&&void 0!==i&&i.originFileObj?t.interactiveRadarUploadFile(e.pdfArr[0].originFileObj).then((function(t){e.pdfArr[0].fileUrl=t,a(t)})).catch((function(e){n(e)})):5===e.msgType&&null!==(r=e.videoArr)&&void 0!==r&&null!==(o=r[0])&&void 0!==o&&o.originFileObj?t.interactiveRadarUploadFile(e.videoArr[0].originFileObj).then((function(t){e.videoArr[0].fileUrl=t,a(t)})).catch((function(e){n(e)})):a()}))}))),a}}}},"8e34":function(e,t,a){"use strict";a("299d")},"8f19":function(e,t,a){"use strict";a.d(t,"n",(function(){return i})),a.d(t,"q",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"j",(function(){return c})),a.d(t,"h",(function(){return l})),a.d(t,"f",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"e",(function(){return m})),a.d(t,"i",(function(){return f})),a.d(t,"g",(function(){return h})),a.d(t,"b",(function(){return g})),a.d(t,"k",(function(){return v})),a.d(t,"m",(function(){return b})),a.d(t,"c",(function(){return y})),a.d(t,"p",(function(){return _})),a.d(t,"o",(function(){return C}));var n=a("b775"),s={customerFormSave:"/client_transformation/customerForm/save",dateInfoList:"/client_transformation/customerFormData/dateInfoList",customerFormList:"/client_transformation/customerForm/list",customerFormInfo:"/client_transformation/customerForm/info",customerFormUpdate:"/client_transformation/customerForm/update",customerFormPublish:"/client_transformation/customerForm/publish",customerFormDelete:"/client_transformation/customerForm/delete",dataInfo:"/client_transformation/customerFormData/dataInfo",analysis:"/client_transformation/customerFormData/analysis",staffList:"/client_transformation/customerFormData/staffList",infoList:"/client_transformation/customerFormData/infoList",analysisExport:"/client_transformation/customerFormData/analysisExport",dataInfoExport:"/client_transformation/customerFormData/dataInfoExport",infoCityList:"/client_transformation/customerFormData/infoCityList",batchTags:"/client_transformation/customerFormData/batchTags",selectList:"/client_transformation/customerForm/userData/selectList",queryDataList:"/client_transformation/customerFormData/queryDataList"};function i(e){return Object(n["b"])({url:s.infoList,method:"post",data:e})}function r(e){return Object(n["b"])({url:s.staffList,method:"get",params:e})}function o(e){return Object(n["b"])({url:s.analysis,method:"get",params:e})}function c(e){return Object(n["b"])({url:s.dataInfo,method:"get",params:e})}function l(e){return Object(n["b"])({url:s.customerFormSave,method:"post",data:e})}function u(e){return Object(n["b"])({url:s.customerFormList,method:"get",params:e})}function d(e){return Object(n["b"])({url:s.dateInfoList,method:"get",params:e})}function p(e){return Object(n["b"])({url:s.customerFormDelete,method:"post",data:e})}function m(e){return Object(n["b"])({url:s.customerFormInfo,method:"get",params:e})}function f(e){return Object(n["b"])({url:s.customerFormUpdate,method:"post",data:e})}function h(e){return Object(n["b"])({url:s.customerFormPublish,method:"post",data:e})}function g(e){return Object(n["b"])({url:s.analysisExport,method:"get",params:e,responseType:"blob"})}function v(e){return Object(n["b"])({url:s.dataInfoExport,method:"get",params:e,responseType:"blob"})}function b(e){return Object(n["b"])({url:s.infoCityList,method:"get",params:e})}function y(e){return Object(n["b"])({url:s.batchTags,method:"post",data:e})}function _(e){return Object(n["b"])({url:s.selectList,method:"get",params:e})}function C(e){return Object(n["b"])({url:s.queryDataList,method:"post",data:e})}},9994:function(e,t,a){"use strict";a("65b6")},"9f4a":function(e,t,a){},"9f78":function(e,t,a){},a669:function(e,t,a){},a68f:function(e,t,a){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrap"},[t("div",[t("p",{staticStyle:{"text-align":"right"}},[t("a-icon",{staticClass:"close-circle",attrs:{type:"close-circle"},on:{click:function(t){return e.$emit("cancle")}}})],1),t("PhoneModel",{attrs:{textList:e.textList}})],1)])},s=[],i=a("e6b1"),r={name:"AlertPhone",components:{PhoneModel:i["a"]},props:{textList:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{}},o=r,c=(a("b04e"),a("2877")),l=Object(c["a"])(o,n,s,!1,null,"28c760da",null);t["a"]=l.exports},ab3f:function(e,t,a){},ab9b:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"team_procedure"},[t("a-tabs",{attrs:{"default-active-key":e.activeKey},on:{change:e.callback}},[t("a-tab-pane",{key:"1",attrs:{tab:"企业话术"}},["1"==e.activeKey?t("enterprise-procedure"):e._e()],1),t("a-tab-pane",{key:"2",attrs:{tab:"团队话术"}},["2"==e.activeKey?t("group-procedure"):e._e()],1),t("a-tab-pane",{key:"3",attrs:{tab:"个人话术"}},["3"==e.activeKey?t("person-procedure"):e._e()],1)],1)],1)},s=[],i=(a("b0c0"),function(){var e=this,t=e._self._c;return t("div",{staticClass:"height100 page-box",staticStyle:{"margin-top":"0"}},[t("header",{staticClass:"header"},[t("a-space",{attrs:{size:12}},[t("a-button",{attrs:{type:"primary",size:"large"},on:{click:e.plusLanguage}},[e._v(" 新建话术 ")]),t("a-button",{staticClass:"aks-border-but",attrs:{size:"large"},on:{click:function(t){e.visibleUploadFile=!0}}},[e._v(" 导入话术 ")]),t("div",{staticClass:"flex"},[t("div",[t("a-tooltip",[e._v(" 侧边栏开关 "),t("div",{attrs:{slot:"title"},slot:"title"},[e._v(" 员工可在企业微信客户端侧边栏-快捷回复使用企业话术 ")]),t("a-icon",{attrs:{type:"question-circle"}}),e._v("： ")],1)],1),t("a-switch",{staticStyle:{"margin-top":"3px"},attrs:{size:"small"},on:{change:e.onSetSidebarStatus},model:{value:e.sidebarShow,callback:function(t){e.sidebarShow=t},expression:"sidebarShow"}})],1)],1),t("a-space",[t("span",[e._v("可用部门：")]),t("TreeSelect",{attrs:{treeData:e.treeData},on:{selectDepartment:e.selectDepartment}}),t("a-input-search",{staticClass:"search-name",attrs:{allowClear:"",placeholder:"请输入话术内容"},on:{search:e.searchName},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1)],1),t("section",{staticClass:"main"},[t("aside",{staticClass:"aside background-white"},[t("Grouping",{attrs:{groupList:e.groupList,speechType:1},on:{changeSpeechGroupId:e.changeSpeechGroupId,addGroup:e.speechGroup,delGroupNow:e.delGroupNow}})],1),t("a-table",{staticClass:"background-white table",attrs:{columns:e.columns,"data-source":e.fSend,pagination:e.pagination,loading:e.loading},on:{change:e.changePage},scopedSlots:e._u([{key:"speechDetailList",fn:function(a,n,s){return t("div",{attrs:{index:s}},[t("div",{staticClass:"contant-wrap"},[t("p",{staticStyle:{color:"#139A32","margin-bottom":"8px"}},[e._v("[共"+e._s(e.getContantLength(n.context))+"条]")]),e._l(n.context,(function(a,s){return t("div",{directives:[{name:"show",rawName:"v-show",value:s<=1||n.isOpen,expression:"key <= 1 || record.isOpen"}],key:s},[0===a.msgType?[a.msgContent?t("span",[e._v(e._s(a.msgContent))]):e._e()]:e._e(),1===a.msgType?[t("a-avatar",{attrs:{src:a.msgContent,shape:"square"}})]:e._e(),2===a.msgType?[t("div",{staticClass:"link-box"},[t("a-avatar",{attrs:{src:a.msgContent.picUrl,shape:"square",size:60}}),t("div",{staticClass:"link-right"},[t("h5",[e._v(e._s(a.msgContent.title))]),t("p",[e._v(e._s(a.msgContent.desc))])])],1)]:e._e(),3===a.msgType?[t("div",{staticClass:"custom-pdf"},[t("a-avatar",{attrs:{size:60,src:"/icons/pdf.png",shape:"square"}}),t("div",{staticClass:"contant"},[t("p",[e._v(e._s(a.msgContent.name))]),t("span",[e._v(e._s(e._f("getUnits")(a.msgContent.size)))])])],1)]:e._e(),5===a.msgType?[t("div",{staticClass:"custom-pdf"},[t("video",{staticClass:"cover-img",attrs:{src:a.msgContent.pdfFile}}),t("div",{staticClass:"contant"},[t("p",[e._v(e._s(a.msgContent.name))]),t("span",[e._v(e._s(e._f("getUnits")(a.msgContent.size)))])])])]:e._e()],2)}))],2),e.getContantLength(n.context)>2?t("div",{staticClass:"stretch primaryColor",on:{click:function(e){n.isOpen=!n.isOpen}}},[e._v(" "+e._s(n.isOpen?"收起":"展开全部")+" ")]):e._e()])}},{key:"creatorName",fn:function(a){return t("div",{staticClass:"tag-list"},[t("a-tag",[t("a-icon",{attrs:{type:"user"}}),e._v(" "+e._s(a)+" ")],1)],1)}},{key:"operation",fn:function(a){return t("div",{},[t("a-button",{attrs:{type:"link"},on:{click:function(t){return e.editLanguage(a)}}},[e._v("修改")]),t("a-button",{attrs:{type:"link"},on:{click:function(t){return e.deleteWelcome(a)}}},[e._v("删除")])],1)}}])},[t("div",{attrs:{slot:"sendNumTxt"},slot:"sendNumTxt"},[e._v(" 发送次数 "),t("a-tooltip",{attrs:{title:"发送次数自本功能上线后开始统计"}},[t("a-icon",{staticStyle:{"margin-left":"4px"},attrs:{type:"question-circle"}})],1)],1)])],1),t("a-modal",{attrs:{footer:null,width:"599px",centered:"",destroyOnClose:""},model:{value:e.visibleAddLanguage,callback:function(t){e.visibleAddLanguage=t},expression:"visibleAddLanguage"}},[t("AddLanguage",{attrs:{speechType:1,departmentId:e.departmentId,speechGroupId:e.speechGroupId,state:e.state,detailData:e.detailData},on:{cancle:function(t){e.visibleAddLanguage=!1},serviceOk:e.serviceOk,addGroup:e.speechGroup}})],1),t("a-modal",{attrs:{footer:null,width:"599px",centered:"",destroyOnClose:""},model:{value:e.visibleUploadFile,callback:function(t){e.visibleUploadFile=t},expression:"visibleUploadFile"}},[t("UploadFile",{on:{cancle:function(t){e.visibleUploadFile=!1},serviceOk:e.uploadSucess}})],1),t("AlertPhone",{directives:[{name:"show",rawName:"v-show",value:e.isAlertPhone,expression:"isAlertPhone"}],attrs:{textList:e.textList},on:{cancle:function(t){e.isAlertPhone=!1}}})],1)}),r=[],o=a("5530"),c=a("2909"),l=(a("d81d"),a("99af"),a("d3b7"),a("a9e3"),a("caad"),a("b775")),u={searchPage:"/client_transformation/speechInfo/page",addPage:"/client_transformation/speechInfo/add",updatePage:"/client_transformation/speechInfo/update",delSpeechInfo:"/client_transformation/speechInfo/delSpeechInfo",downloadTemp:"/client_transformation/speechInfo/downloadTemp",importSpeech:"/client_transformation/speechInfo/importSpeech",speechGroup:"/client_transformation/speechGroup/list",addGroup:"/client_transformation/speechGroup/add",updateGroup:"/client_transformation/speechGroup/update",delGroup:"/client_transformation/speechGroup/delGroup",bar:"/client_transformation/speechteam/bar",updateSpeechTeam:"/client_transformation/speechteam/updateSpeechTeam",delSpeechTeam:"/client_transformation/speechteam/delSpeechTeam",sidebarStatus:"/client_transformation/speechInfo/sidebarStatus",setSidebarStatus:"/client_transformation/speechInfo/setSidebarStatus"};function d(e){return Object(l["b"])({url:u.sidebarStatus,method:"get",params:e})}function p(e){return Object(l["b"])({url:u.setSidebarStatus,method:"get",params:e})}function m(e){return Object(l["b"])({url:u.searchPage,method:"get",params:e})}function f(e){return Object(l["b"])({url:u.addPage,method:"post",data:e})}function h(e){return Object(l["b"])({url:u.updatePage,method:"post",data:e})}function g(e){return Object(l["b"])({url:u.delSpeechInfo,method:"post",params:e})}function v(){window.open(PRD_VUE_APP_API_BASE_URL+u.downloadTemp,"_blank")}function b(e){return Object(l["b"])({url:u.importSpeech,method:"post",data:e})}function y(e){return Object(l["b"])({url:u.speechGroup,method:"get",params:e})}function _(e){return Object(l["b"])({url:u.addGroup,method:"post",data:e})}function C(e){return Object(l["b"])({url:u.updateGroup,method:"post",data:e})}function k(e){return Object(l["b"])({url:u.delGroup,method:"post",params:e})}function I(e){return Object(l["b"])({url:u.bar,method:"get",params:e})}function x(e){return Object(l["b"])({url:u.updateSpeechTeam,method:"post",data:e})}function O(e){return Object(l["b"])({url:u.delSpeechTeam,method:"post",data:e})}var T=a("1c9c"),L=a("48c5"),w=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"wrap"},[e.examine?t("h6",{staticClass:"dialog-title"},[e._v(e._s(e.stateText)+"话术")]):t("h6",{staticClass:"dialog-title"},[e._v("查看话术详情")]),t("a-form-model",{attrs:{model:e.form,rules:e.rules,"label-col":{span:2},"wrapper-col":{span:22},labelAlign:"left"}},[t("a-form-model-item",{attrs:{label:"分组","wrapper-col":{span:14}}},[t("a-select",{attrs:{value:e.selectGroup.groupName,disabled:!e.examine}},[t("ul",{staticClass:"grouping",attrs:{slot:"dropdownRender"},slot:"dropdownRender"},[t("li",{staticClass:"plus-but",on:{click:function(t){e.visible=!0}}},[t("a-icon",{attrs:{type:"plus"}}),e._v("添加分组")],1),e._l(e.groupList,(function(a,n){return t("li",{key:n,on:{click:function(t){e.defaultIndex=n}}},[e._v(" "+e._s(a.groupName)+" ")])}))],2)])],1),t("a-form-model-item",{attrs:{label:"标题","wrapper-col":{span:14}}},[t("a-input",{attrs:{placeholder:"选填，仅内部可见，方便整理和查看",maxLength:15,disabled:!e.examine},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}})],1),t("a-form-model-item",{attrs:{"wrapper-col":{span:24}}},[t("TypeAccessory",{attrs:{sendContentList:e.speechDetailList,msgTypeList:e.msgTypeList,isNeedSelectRadar:!1,isNeedRader:!1},on:{delContent:e.delContent}})],1),t("a-space",{staticClass:"add-contant"},[t("a-button",{staticClass:"aks-border-but",attrs:{disabled:!e.examine},on:{click:e.plusContant}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 添加内容 ")],1),t("span",{staticClass:"font-color-black-25"},[e._v("(添加的多个内容可一键发送)")])],1),t("a-form-model-item",[t("h6",{staticClass:"title"},[e._v("设置关键词")]),t("div",{staticClass:"tip"},[e._v(" 设置关键词后，当客户发送的消息中有对应的关键词，将在侧边栏快捷回复中智能推荐该话术。仅对开通了消息存档的员工生效 ")])]),t("a-form-model-item",{attrs:{label:"模糊匹配","label-col":{span:4},"wrapper-col":{span:20}}},[t("addTag",{attrs:{title:"添加关键词",tagslist:e.fuzzyKeywords,examine:e.examine}})],1),t("a-form-model-item",{attrs:{label:"精确匹配","label-col":{span:4},"wrapper-col":{span:20}}},[t("addTag",{attrs:{title:"添加关键词",tagslist:e.exactKeywords,examine:e.examine}})],1)],1)],1),t("div",{staticClass:"foot-button"},[t("a-checkbox",{model:{value:e.updatedRemind,callback:function(t){e.updatedRemind=t},expression:"updatedRemind"}},[e._v("话术更新后，「"+e._s(e.corpName)+"提醒」通知员工")]),t("a-space",{attrs:{size:12}},[t("a-button",{on:{click:function(t){return e.$emit("cancle")}}},[e._v("取消")]),e.examine?t("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.submit}},[e._v("添加")]):e._e()],1)],1),t("a-modal",{attrs:{footer:null,width:"599px",centered:"",destroyOnClose:""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("BuildGroup",{attrs:{speechType:e.speechType,teamId:e.teamId,staffId:e.staffId,creatorName:e.creatorName},on:{cancle:function(t){e.visible=!1},serviceOk:e.serviceOk}})],1)],1)},S=[],N=a("c7eb"),D=a("1da1"),j=(a("c740"),a("159b"),a("3ca3"),a("ddb0"),a("a434"),a("329a")),A=function(){var e=this,t=e._self._c;return t("div",[t("h6",{staticClass:"dialog-title"},[e._v(e._s(e.stateText)+"分组")]),t("section",[t("div",{staticClass:"tips"},[t("a-icon",{attrs:{type:"bell",theme:"filled"}}),e._v(" 新增可见范围设置，管理员可根据不同部门选择展示不同话术，部门管理员可创建部门可见的话术 ")],1),t("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":{span:4},"wrapper-col":{span:18},labelAlign:"right"}},[t("a-form-model-item",{attrs:{label:"分组名称",prop:"groupName"}},[t("a-input",{attrs:{maxLength:15,placeholder:"请输入分组名称",disabled:1===e.detailData.isDefault},model:{value:e.form.groupName,callback:function(t){e.$set(e.form,"groupName",t)},expression:"form.groupName"}})],1),t("a-form-model-item",{attrs:{label:"可见范围",prop:"type"}},[t("a-radio-group",{model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("a-radio",{attrs:{value:0}},[e._v(" 全部员工 ")]),t("a-radio",{attrs:{value:1}},[e._v(" 部门可用 ")])],1)],1),1===e.form.type?t("a-form-model-item",{attrs:{label:"选择可用部门"}},[t("AddContent",{attrs:{title:"请选择部门",type:"wxDepartmentId",tip:"",dataList:e.selectList},on:{selectPerson:e.selectPerson}})],1):e._e()],1)],1),t("div",{staticClass:"foot-button"},[t("a-space",{attrs:{size:12}},[t("a-button",{on:{click:function(t){return e.$emit("cancle")}}},[e._v("取消")]),t("a-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确定")])],1)],1)])},G=[],P=(a("a15b"),a("e1ae")),F={name:"BuildGroup",components:{AddContent:P["a"]},props:{detailData:{type:[Object],default:function(){return{}}},state:{type:[String],default:"add"},speechType:{type:[Number],default:1},teamId:{type:[String],default:""},staffId:{type:[Number,String],default:""},creatorName:{type:[String],default:""}},data:function(){return{accept:".xlsx,.xls,.csv",selectList:[],form:{groupName:"",type:0,departmentIds:""},rules:{groupName:[{required:!0,message:"请填写分组名称"}]}}},computed:{speechGroupId:function(){return this.detailData.speechGroupId},stateText:function(){return"add"===this.state?"新建":"修改"}},created:function(){var e;(null===(e=this.detailData)||void 0===e?void 0:e.speechGroupId)&&this.getDetailData()},methods:{getDetailData:function(){var e;this.detailData.speechGroupId&&(this.form.groupName=this.detailData.groupName,this.form.type=this.detailData.type,this.selectList=null===(e=this.detailData.departmentList)||void 0===e?void 0:e.map((function(e){if(e)return{key:String(e.wxDepartmentId),title:e.name,source:e,icon:"file"}})))},selectPerson:function(e){this.selectList=e},submit:function(){var e=this;this.$refs.ruleForm.validate(function(){var t=Object(D["a"])(Object(N["a"])().mark((function t(a){var n,s;return Object(N["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=8;break}return t.next=3,e.validate();case 3:n=e.getParams(),s=e.speechGroupId?e.updateGroup(n):e.addGroup(n),s.then((function(){e.$message.success("".concat(e.stateText,"分组成功")),e.$emit("serviceOk")})).catch((function(t){e.$message.error(t)})),t.next=9;break;case 8:return t.abrupt("return",!1);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},validate:function(){var e=this;return new Promise((function(t,a){1===e.form.type&&e.selectList.length<1&&(e.$message.warning("请选择部门"),a("请选择部门")),t()}))},getParams:function(){var e,t={speechType:this.speechType,groupName:this.form.groupName,type:this.form.type,departmentIds:null===(e=this.selectList)||void 0===e?void 0:e.map((function(e){return e.source.wxDepartmentId})).join(",")};return 2==this.speechType&&(t.speechTeamId=this.teamId),3==this.speechType&&(t.creatorId=this.staffId,t.creatorName=this.creatorName),t},updateGroup:function(e){return e.speechGroupId=this.speechGroupId,C(e)},addGroup:function(e){return _(e)}}},R=F,$=(a("53c2"),a("2877")),U=Object($["a"])(R,A,G,!1,null,"82e71848",null),z=U.exports,B=a("1011"),M=a("842b"),q={name:"AddLanguage",components:{addTag:j["a"],BuildGroup:z,TypeAccessory:B["a"]},mixins:[M["a"]],props:{departmentId:{type:[String],default:""},speechGroupId:{type:String,default:""},detailData:{type:[Object],default:function(){return{}}},state:{type:[String],default:"add"},speechType:{type:[Number],default:1},teamId:{type:[String],default:""},examine:{type:[Boolean],default:!0},staffId:{type:[Number,String],default:""},creatorName:{type:[String],default:""}},data:function(){return{uploadFilePath:"clientTransformation",groupList:[],defaultIndex:0,visible:!1,exactKeywords:[],fuzzyKeywords:[],loading:!1,msgTypeList:[{id:0,text:"文字",type:"text"},{id:1,text:"图片",type:"image"},{id:2,text:"链接",type:"link"},{id:3,text:"PDF",type:"pdf"},{id:5,text:"视频",type:"video"}],updatedRemind:!1,defaultContant:function(){return{msgType:0,imageObj:{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}},msgContent:"",pdfArr:[],videoArr:[],formObj:{}}},speechDetailList:[{msgType:0,imageObj:{title:"图片",prop:"pic_url",type:"img",tips:"",accept:".jpg,.png",maxLength:2097152,value:{}},msgContent:"",pdfArr:[],formObj:{},videoArr:[]}],title:"",form:{},rules:{}}},computed:{speechInfoId:function(){return this.detailData.speechInfoId},stateText:function(){return"add"===this.state?"新建":"修改"},selectGroup:function(){return this.groupList[this.defaultIndex]||{}},corpName:function(){var e,t,a,n;return(null===(e=this.$store)||void 0===e||null===(t=e.state)||void 0===t||null===(a=t.user)||void 0===a||null===(n=a.corp)||void 0===n?void 0:n.name)||"未获到公司名"}},created:function(){var e;this.speechGroup(),(null===(e=this.detailData)||void 0===e?void 0:e.speechInfoId)&&this.getDetailData()},methods:{serviceOk:function(){var e;this.visible=!1,this.speechGroup(),this.$emit("addGroup"),(null===(e=this.detailData)||void 0===e?void 0:e.speechInfoId)&&this.getDetailData()},getDetailData:function(){if(this.detailData.speechInfoId){var e,t;this.title=this.detailData.title,this.fuzzyKeywords=null===(e=this.detailData.fuzzyKeywords)||void 0===e?void 0:e.map((function(e){return{tagName:e}})),this.exactKeywords=null===(t=this.detailData.exactKeywords)||void 0===t?void 0:t.map((function(e){return{tagName:e}}));var a=this.detailData.speechDetailList.map((function(e){return Object(o["a"])(Object(o["a"])({},e),{},{msgType:e.contentType,msgContent:e.content})}));this.speechDetailList=this.getMessageList(a),this.updatedRemind=Boolean(this.detailData.updatedRemind)}},submit:function(){var e=this;this.validate().then(Object(D["a"])(Object(N["a"])().mark((function t(){var a,n;return Object(N["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.getParams();case 3:a=t.sent,n=e.speechInfoId?e.updatePage(a):e.addPage(a),n.then((function(){e.$message.success("".concat(e.stateText,"话术成功")),e.$emit("serviceOk")})).catch((function(t){e.$message.error(t)})).finally((function(){e.loading=!1}));case 6:case"end":return t.stop()}}),t)})))).catch((function(t){e.loading=!1,e.$message.warning(t)}))},validate:function(){var e=this;return new Promise((function(t,a){for(var n=0;n<e.speechDetailList.length;n++){var s;if(0!==e.speechDetailList[n].msgType||e.speechDetailList[n].msgContent||a("消息".concat(n+1,"内容未填写")),1!==e.speechDetailList[n].msgType||e.speechDetailList[n].msgContent.compress||a("消息".concat(n+1,"内容未填写")),2===e.speechDetailList[n].msgType)if(!e.speechDetailList[n].msgContent||null===(s=e.speechDetailList[n].msgContent)||void 0===s||!s.serviceOk())return}t()}))},speechGroup:function(){var e=this;y({departmentId:this.departmentId,speechType:this.speechType,teamId:this.teamId,staffId:this.staffId}).then((function(t){e.groupList=t.data;var a=e.groupList.findIndex((function(t){return t.speechGroupId===(e.speechGroupId||e.detailData.speechGroupId)}));e.defaultIndex=a&&a>=0?a:0})).catch((function(t){e.$message.error(t)}))},getParams:function(){var e=this;return new Promise((function(t,a){var n=[];e.speechDetailList.forEach((function(e,t){e.step=t+1,[1,2,3,5].includes(e.msgType)&&n.push(e)}));var s=e.getPlanFileList(n);Promise.all(s).then((function(a){var n,s,i={speechGroupId:e.selectGroup.speechGroupId,title:e.title,fuzzyKeywords:null===(n=e.fuzzyKeywords)||void 0===n?void 0:n.map((function(e){return e.tagName})),exactKeywords:null===(s=e.exactKeywords)||void 0===s?void 0:s.map((function(e){return e.tagName})),speechDetailList:e.getPlanList(),updatedRemind:Number(e.updatedRemind)};3==e.speechType&&(i.creatorId=e.staffId,i.creatorName=e.creatorName),t(i)})).catch((function(e){a(e)}))}))},getPlanList:function(){var e=this;return this.speechDetailList.map((function(t){var a="";if(0===t.msgType&&(a=t.msgContent),1===t.msgType&&(a=t.fileUrl||t.content),2===t.msgType){var n="";t.fileUrl?n=t.fileUrl:t.msgContent.form.pic_url?n=t.msgContent.form.pic_url:"edit"===e.state&&t.msgContent.form.coverUrl.compress&&(n=t.msgContent.form.coverUrl.compress),a=JSON.stringify({desc:t.msgContent.form.desc,picUrl:n,url:t.msgContent.form.url,title:t.msgContent.form.linkTitle,radarId:String(t.radarId)})}return 3===t.msgType&&(a=JSON.stringify({pdfFile:t.pdfArr[0].fileUrl||t.pdfArr[0].pdfFile,name:t.pdfArr[0].name,size:t.pdfArr[0].size,cover:"https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/h5/img/pdf.png"})),5===t.msgType&&(a=JSON.stringify({pdfFile:t.videoArr[0].fileUrl||t.videoArr[0].pdfFile,name:t.videoArr[0].name,size:t.videoArr[0].size})),{speechDetailId:t.speechDetailId,contentType:t.msgType,content:a}}))},plusContant:function(){this.speechDetailList.push(this.defaultContant())},delContent:function(e){this.speechDetailList.splice(e,1)},updatePage:function(e){return e.speechInfoId=this.speechInfoId,h(e)},addPage:function(e){return f(e)}}},K=q,J=(a("b79e"),Object($["a"])(K,w,S,!1,null,"65b0f43a",null)),E=J.exports,V=function(){var e=this,t=e._self._c;return t("div",[t("h6",{staticClass:"dialog-title"},[e._v("导入企业话术")]),t("section",[t("div",{staticClass:"content"},[t("span",[e._v("第一步:")]),t("div",{staticClass:"info"},[t("p",[e._v("下载导入模版，按照模版填写内容")]),t("a-button",{staticClass:"download-model",attrs:{type:"link"},on:{click:e.downloadTemp}},[t("a-icon",{staticClass:"blue",attrs:{type:"file-excel"}}),e._v(" 下载导入模板 ")],1)],1)]),t("div",{staticClass:"content"},[t("span",[e._v("第二步:")]),t("div",{staticClass:"info"},[t("p",{staticClass:"title"},[e._v("上传文件，将填写好的模版上传")]),t("section",{staticClass:"csv-uploader"},[t("a-upload",{staticClass:"upload-input",attrs:{name:"file",accept:e.accept,fileList:e.fileList,customRequest:e.customRequest},on:{change:e.handleChange}},[t("a-icon",{staticClass:"tu",attrs:{type:"upload"}}),t("span",[e._v("上传表格")])],1),t("div",{staticClass:"upload"},[e.fileList.length<=0?t("div",[t("a-icon",{staticClass:"tu",attrs:{type:"upload"}}),t("span",[e._v("上传表格")])],1):t("div",e._l(e.fileList,(function(a,n){return t("span",{key:n,staticClass:"chaochu"},[t("a-icon",{staticClass:"blue blue-icon",attrs:{type:"file-excel"}}),t("a-tooltip",{attrs:{title:"item.name"}},[e._v(" "+e._s(a.name)+" ")])],1)})),0)])],1)])])]),t("div",{staticClass:"foot-button"},[t("a-space",{attrs:{size:12}},[t("a-button",{on:{click:function(t){return e.$emit("cancle")}}},[e._v("取消")]),t("a-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.importSpeech}},[e._v("导入")])],1)],1)])},W=[],H={name:"UploadFile",components:{},data:function(){return{accept:".xlsx,.xls,.csv",fileList:[],loading:!1}},methods:{downloadTemp:function(){v()},importSpeech:function(){var e=this;if(this.fileList.length>0){this.loading=!0;var t=new FormData,a=this.fileList[0].originFileObj;t.append("file",a),b(t).then((function(t){e.$emit("serviceOk"),e.$message.success("表格上传成功")})).catch((function(t){e.$message.error(t)})).finally((function(){return e.loading=!1}))}else this.$message.warning("请上传表格文件")},customRequest:function(e){e.onSuccess()},handleChange:function(e){"uploading"===e.file.status&&(this.fileList=[e.fileList[e.fileList.length-1]],this.fileList[0].status="done"),"removed"===e.file.status&&(this.fileList=[])}}},Q=H,X=(a("1f57"),Object($["a"])(Q,V,W,!1,null,"4966322c",null)),Y=X.exports,Z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"grouping"},[e.showAddBtn?t("div",{staticClass:"plus-botton",on:{click:e.plusGroup}},[t("a-space",{attrs:{size:4}},[t("a-icon",{attrs:{type:"plus"}}),e._v("添加分组 ")],1)],1):e._e(),t("a-menu",{staticClass:"group-list",attrs:{mode:"inline"},on:{click:e.handleClick},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}},e._l(e.groupList,(function(a,n){return t("a-menu-item",{key:a.speechGroupId,on:{mouseenter:function(t){return e.mouseenter(n)},mouseleave:function(t){return e.mouseleave(n)}}},[e._v(" "+e._s(a.groupName)+" "),t("div",{directives:[{name:"show",rawName:"v-show",value:0!==n&&e.selectIndex===n,expression:"index !== 0 && selectIndex === index"}]},[t("a-icon",{attrs:{type:"edit"},on:{click:function(t){return t.stopPropagation(),e.editGroup(a)}}}),1!==a.isDefault?t("a-icon",{attrs:{type:"delete"},on:{click:function(t){return t.stopPropagation(),e.deleteGroup(a)}}}):e._e()],1)])})),1),t("a-modal",{attrs:{footer:null,width:"599px",centered:"",destroyOnClose:""},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("BuildGroup",{attrs:{state:e.state,speechType:e.speechType,teamId:e.teamId,staffId:e.staffId,creatorName:e.creatorName,detailData:e.detailData},on:{cancle:function(t){e.visible=!1},serviceOk:e.serviceOk}})],1)],1)},ee=[],te={name:"Grouping",components:{BuildGroup:z},props:{groupList:{type:[Array],default:function(){return[]}},speechType:{type:[Number],default:1},teamId:{type:[String],default:""},staffId:{type:[Number,String],default:""},creatorName:{type:[String],default:""},showAddBtn:{type:[Boolean],default:!0}},data:function(){return{visible:!1,current:[""],state:"",detailData:{},selectIndex:""}},methods:{mouseenter:function(e){this.selectIndex=e},mouseleave:function(e){this.selectIndex=""},handleClick:function(e){this.$emit("changeSpeechGroupId",e.key)},plusGroup:function(){this.detailData={},this.state="add",this.visible=!0},editGroup:function(e){this.detailData=e,this.state="edit",this.visible=!0},deleteGroup:function(e){var t=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"确定要删除此分组吗？",onOk:function(){t.delGroup(e.speechGroupId)}})},serviceOk:function(){this.visible=!1,this.$emit("addGroup")},delGroup:function(e){var t=this;k({speechGroupId:e}).then((function(e){t.visible=!1,t.$message.success("删除成功"),t.current=[""],t.$emit("delGroupNow")})).catch((function(e){$message.error(e)}))}}},ae=te,ne=(a("44aa"),Object($["a"])(ae,Z,ee,!1,null,"59cf2f02",null)),se=ne.exports,ie=a("a68f"),re=a("ca00"),oe={name:"CorporateLanguage",components:{TreeSelect:L["a"],AddLanguage:E,UploadFile:Y,Grouping:se,AlertPhone:ie["a"]},data:function(){return{sidebarShow:!1,sidebarFlag:null,detailData:{},state:"",isOpen:!1,visibleAddLanguage:!1,visibleUploadFile:!1,speechGroupId:"",departmentId:"",defaultGroupList:[{groupName:"全部分组",speechGroupId:""}],groupList:[],treeData:[],fSend:[],loading:!1,keywords:"",selectData:"",visibleCodeTetail:!1,textList:[],isAlertPhone:!1,pagination:{current:1,pageSize:10,total:0},contentTypeText:["文字","图片","链接"],columns:[{title:"话术内容",key:"speechDetailList",dataIndex:"speechDetailList",width:"200px",scopedSlots:{customRender:"speechDetailList"}},{title:"标题",key:"title",dataIndex:"title",scopedSlots:{customRender:"title"}},{key:"sendNum",dataIndex:"sendNum",slots:{title:"sendNumTxt"},scopedSlots:{customRender:"sendNum"}},{title:"所属分组",key:"groupName",dataIndex:"groupName",scopedSlots:{customRender:"groupName"}},{title:"创建人",key:"creatorName",dataIndex:"creatorName",scopedSlots:{customRender:"creatorName"}},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"类型",key:"contentType",dataIndex:"contentType"},{title:"操作",key:"operation",align:"right",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}},filters:{getUnits:function(e){return Object(re["b"])(e)}},created:function(){this.getSidebarStatus(),this.speechGroup(),this.searchPage(),this.getDepartment()},methods:{delGroupNow:function(){this.speechGroupId="",this.pagination.current=1,this.speechGroup(),this.searchPage()},getContantLength:function(e){return null===e||void 0===e?void 0:e.length},lookAll:function(e){var t=e.map((function(e){return 2===e.msgType?{type:"link",linkTitle:e.msgContent.title,desc:e.msgContent.desc,coverUrl:{compress:e.msgContent.url}}:1===e.msgType?{type:"img",pic_url:{compress:e.msgContent}}:0===e.msgType?e.msgContent:void 0}));this.textList=t,this.isAlertPhone=!0},getSidebarStatus:function(){var e=this;d().then((function(t){null!==t&&void 0!==t&&t.data&&(e.sidebarFlag=t.data,e.sidebarShow="1"==t.data)})).catch((function(t){e.$message.error(t)}))},onSetSidebarStatus:function(){var e,t=this;e=this.sidebarShow?"1":"0",p({status:e}).then((function(e){var a;a=t.sidebarShow?"侧边栏已开启":"侧边栏已关闭",t.$message.success(a)})).catch((function(e){t.sidebarShow="1"==t.sidebarFlag,t.$message.error(e)}))},uploadSucess:function(){this.searchPage(),this.speechGroup(),this.visibleUploadFile=!1},changeSpeechGroupId:function(e){this.speechGroupId=e,this.searchPage()},speechGroup:function(){var e=this;y({departmentId:this.departmentId,speechType:1}).then((function(t){e.groupList=[].concat(Object(c["a"])(e.defaultGroupList),Object(c["a"])(t.data))})).catch((function(t){e.$message.error(t)}))},serviceOk:function(){this.visibleAddLanguage=!1,this.searchPage()},plusLanguage:function(){this.detailData={},this.state="add",this.visibleAddLanguage=!0},editLanguage:function(e){this.detailData=JSON.parse(JSON.stringify(e)),this.state="edit",this.visibleAddLanguage=!0},selectDepartment:function(e){this.departmentId="全部部门"===e?"":e,this.speechGroup()},getDepartment:function(){var e=this;Object(T["g"])().then((function(t){var a;(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.length)>0&&(e.treeData=e.getTreeData(t.data))}))},getTreeData:function(e){var t=this;if((null===e||void 0===e?void 0:e.length)>0){var a=e.map((function(e){var a={title:e.name,key:e.wxDepartmentId,value:e.wxDepartmentId,slots:{icon:"smile"},children:void 0};return e.children&&(a.children=t.getTreeData(e.children)),a}));return a}},openCodeDetail:function(e){this.selectData=e,this.visibleCodeTetail=!0},searchName:function(){this.searchPage()},changePage:function(e){var t=e.current;this.pagination.current=t,this.searchPage()},deleteWelcome:function(e){var t=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"确定要删除此话术吗？",onOk:function(){t.delSpeechInfo(e)}})},delSpeechInfo:function(e){var t=this;this.loading=!0,g({speechInfoId:e.speechInfoId}).then((function(e){var a;1===(null===(a=t.fSend)||void 0===a?void 0:a.length)&&(t.pagination.current=t.pagination.current-1||1),t.speechGroupId="",t.pagination.current=1,t.searchPage(),t.$message.success("删除成功")})).catch((function(e){t.$message.error(e)})).finally((function(){return t.loading=!1}))},searchPage:function(){var e=this,t={speechType:1,currentPage:this.pagination.current,pageSize:this.pagination.pageSize,keywords:this.keywords,speechGroupId:this.speechGroupId};this.loading=!0,m(t).then((function(t){null!==t&&void 0!==t&&t.data&&(e.pagination.total=Number(t.data.total),e.fSend=t.data.list.map((function(t){var a=Object(o["a"])(Object(o["a"])({},t),{},{key:String(t.speechInfoId),isOpen:!1,contentType:t.speechDetailList.length>1?"复合消息":e.contentTypeText[t.speechDetailList[0].contentType],context:t.speechDetailList.map((function(e){return Object(o["a"])(Object(o["a"])({},t),{},{msgContent:[2,3,4,5].includes(e.contentType)?JSON.parse(e.content):e.content,msgType:e.contentType})}))});return Object(o["a"])(Object(o["a"])({},a),{},{operation:a})})))})).catch((function(t){e.$message.error(t)})).finally((function(){return e.loading=!1}))}}},ce=oe,le=(a("61a2"),Object($["a"])(ce,i,r,!1,null,"d9ae8966",null)),ue=le.exports,de=function(){var e=this,t=e._self._c;return t("div",{staticClass:"group_procedure height100 page-box",staticStyle:{"margin-top":"0"}},[e._e(),t("section",{staticClass:"main"},[e.checkTeam?t("div",{directives:[{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClose,expression:"handleClose"}],staticClass:"list-selector"},[t("p",{staticClass:"graph"},[e._v("全部团队 ( "+e._s(e.troopList.length)+" )")]),t("div",{staticClass:"input-wrap"},[t("a-input-search",{attrs:{allowClear:"",placeholder:"请输入团队后回车"},on:{search:e.searchBarList},model:{value:e.keyWordTeamName,callback:function(t){e.keyWordTeamName=t},expression:"keyWordTeamName"}})],1),t("ul",{staticClass:"list"},e._l(e.troopList,(function(a,n){return t("li",{key:a.teamId,on:{click:function(t){return e.checkTeamId(a)},mouseenter:function(t){return e.mouseenter(n)},mouseleave:e.mouseleave}},[t("span",{staticClass:"name-box"},[t("span",{staticClass:"name"},[e._v(e._s(a.teamName))])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.selectIndex==n,expression:"selectIndex == index"}]},[t("a-icon",{staticStyle:{"margin-right":"10px",color:"#1890ff"},attrs:{type:"edit"},on:{click:function(t){return t.stopPropagation(),e.editSpeechTeam(a)}}}),t("a-icon",{staticStyle:{color:"#1890ff"},attrs:{type:"delete"},on:{click:function(t){return t.stopPropagation(),e.deleteSpeechTeam(a)}}})],1)])})),0)]):e._e(),t("aside",{staticClass:"aside background-white"},[t("div",{staticClass:"sidebar-header"},[t("div",{staticClass:"dropdown-wrap",on:{click:function(t){t.stopPropagation(),e.checkTeam=!e.checkTeam}}},[t("span",[t("span",{staticClass:"wrap remark"},[e._v(e._s(e.teamName))])]),t("span",{staticClass:"arrow hide-arrow"},[t("a-icon",{attrs:{type:"down"}})],1)])]),t("Grouping",{attrs:{groupList:e.groupList,speechType:2,teamId:e.teamId,showAddBtn:!1},on:{changeSpeechGroupId:e.changeSpeechGroupId,addGroup:e.speechGroup}})],1),t("article",{staticClass:"article"},[t("div",{staticClass:"team-staff-show"},[t("strong",[e._v("【团队成员】:")]),e._l(e.teamPersonList,(function(a){return t("div",{key:a.userid,staticClass:"user"},[t("span",[t("a-icon",{attrs:{type:"user"}})],1),t("span",[e._v(e._s(a.name))])])})),e._v(" "+e._s(e.teamPersonList.length)+"个成员 ")],2),t("div",{staticClass:"content-header"},[t("p",[e._v("共"+e._s(e.pagination.total)+"条话术")]),t("a-space",[t("a-input-search",{staticClass:"search-name",attrs:{allowClear:"",placeholder:"请输入话术内容"},on:{search:e.searchPage},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1)],1),t("div",{staticClass:"content-table"},[t("a-table",{staticClass:"background-white",attrs:{columns:e.columns,"data-source":e.fSend,pagination:e.pagination,loading:e.loading},on:{change:e.changePage},scopedSlots:e._u([{key:"speechDetailList",fn:function(a){return t("div",{},[t("ul",[e._l(a,(function(a,n){return t("li",{directives:[{name:"show",rawName:"v-show",value:e.isOpen||n<2,expression:"isOpen || index < 2"}],key:n},[e._v(" "+e._s(a.content)+" ")])})),t("div",{staticClass:"bottom-content"},[t("a-space",{attrs:{size:12}},[t("span",{staticClass:"aks-tips"},[e._v("共"+e._s(a.length)+"条")]),a.length>2?t("span",{staticClass:"aks-tips",on:{click:function(t){e.isOpen=!e.isOpen}}},[e._v(" "+e._s(e.isOpen?"收起":"展开")),t("a-icon",{attrs:{type:e.isOpen?"up":"down"}})],1):e._e()])],1)],2)])}},{key:"creatorName",fn:function(a){return t("div",{staticClass:"tag-list"},[t("a-tag",[t("a-icon",{attrs:{type:"user"}}),e._v(" "+e._s(a)+" ")],1)],1)}},{key:"operation",fn:function(a){return t("div",{},[t("a-button",{attrs:{type:"link"},on:{click:function(t){return e.detailsLanguage(a)}}},[e._v("详情")])],1)}}])},[t("div",{attrs:{slot:"sendNumTxt"},slot:"sendNumTxt"},[e._v(" 发送次数 "),t("a-tooltip",{attrs:{title:"发送次数自本功能上线后开始统计"}},[t("a-icon",{staticStyle:{"margin-left":"4px"},attrs:{type:"question-circle"}})],1)],1)])],1)])]),t("a-modal",{attrs:{footer:null,width:"599px",centered:"",destroyOnClose:""},model:{value:e.visibleAddLanguage,callback:function(t){e.visibleAddLanguage=t},expression:"visibleAddLanguage"}},[t("AddLanguage",{attrs:{speechType:2,teamId:e.teamId,departmentId:e.departmentId,speechGroupId:e.speechGroupId,state:e.state,examine:e.examine,detailData:e.detailData},on:{cancle:function(t){e.visibleAddLanguage=!1},serviceOk:e.serviceOk,addGroup:e.speechGroup}})],1),t("a-modal",{attrs:{footer:null,width:"680px",centered:"",destroyOnClose:""},model:{value:e.newTeamModel,callback:function(t){e.newTeamModel=t},expression:"newTeamModel"}},[t("a-input",{staticStyle:{margin:"40px 0 20px"},attrs:{maxLength:15,placeholder:"请输入团队名称"},model:{value:e.teamForm.teamName,callback:function(t){e.$set(e.teamForm,"teamName",t)},expression:"teamForm.teamName"}}),t("p",[e._v("请选择员工:")]),t("AddTransfer",{attrs:{type:"deptId",title:"",selectList:e.selectList,selectRoleIdList:e.selectRoleIdList},on:{serviceOk:e.newTeamOk,cancle:function(t){e.newTeamModel=!1,e.teamForm.teamName="",e.selectList=[]}}})],1)],1)},pe=[],me=a("1eb1"),fe=a("487a"),he=a.n(fe),ge={bind:function(e,t){function a(a){if(e.contains(a.target))return!1;t.expression&&t.value(a)}e.__vueClickOutside__=a,document.addEventListener("click",a)},update:function(){},unbind:function(e){document.removeEventListener("click",e.__vueClickOutside__),delete e.__vueClickOutside__}},ve={name:"groupProcedure",directives:{clickoutside:ge,infiniteScroll:he.a},components:{Grouping:se,AddLanguage:E,AddTransfer:me["a"]},data:function(){return{visibleAddLanguage:!1,examine:!1,speechGroupId:"",departmentId:"",detailData:{},state:"",isOpen:!1,defaultGroupList:[{groupName:"全部分组",speechGroupId:""}],groupList:[],checkTeam:!1,selectIndex:"",teamId:"",teamName:"",troopList:[],keyWordTeamName:"",teamPersonList:[],newTeamModel:!1,speechTeamType:"add",speechTeamTypeTeamId:"",teamForm:{teamName:""},selectList:[],selectRoleIdList:[],keywords:"",fSend:[],pagination:{current:1,pageSize:10,total:0},loading:!1,columns:[{title:"话术内容",key:"speechDetailList",dataIndex:"speechDetailList",width:"200px",scopedSlots:{customRender:"speechDetailList"}},{title:"标题",key:"title",dataIndex:"title",scopedSlots:{customRender:"title"}},{key:"sendNum",dataIndex:"sendNum",slots:{title:"sendNumTxt"},scopedSlots:{customRender:"sendNum"}},{title:"所属分组",key:"groupName",dataIndex:"groupName",scopedSlots:{customRender:"groupName"}},{title:"创建人",key:"creatorName",dataIndex:"creatorName",scopedSlots:{customRender:"creatorName"}},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"类型",key:"contentType",dataIndex:"contentType"},{title:"操作",key:"operation",align:"right",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}},created:function(){this.barList()},mounted:function(){},watch:{},computed:{},methods:{speechGroup:function(){var e=this;y({speechType:2,teamId:this.teamId}).then((function(t){e.groupList=[].concat(Object(c["a"])(e.defaultGroupList),Object(c["a"])(t.data))})).catch((function(t){e.$message.error(t)}))},changeSpeechGroupId:function(e){this.speechGroupId=e,this.searchPage()},searchPage:function(){var e=this,t={speechType:2,teamId:this.teamId,currentPage:this.pagination.current,pageSize:this.pagination.pageSize,keywords:this.keywords,speechGroupId:this.speechGroupId};this.loading=!0,m(t).then((function(t){null!==t&&void 0!==t&&t.data&&(e.pagination.total=Number(t.data.total),e.fSend=t.data.list.map((function(e){var t=Object(o["a"])(Object(o["a"])({},e),{},{key:String(e.speechInfoId),contentType:"文字"});return Object(o["a"])(Object(o["a"])({},t),{},{operation:t})})))})).catch((function(t){e.$message.error(t)})).finally((function(){return e.loading=!1}))},changePage:function(e){var t=e.current;this.pagination.current=t,this.searchPage()},barList:function(){var e=this;I({staffWxUserId:this.$store.state.user.info.userid,teamName:this.keyWordTeamName}).then((function(t){e.troopList=t.data.speechTeams,e.troopList.length>0&&(e.teamId=e.troopList[0].teamId,e.teamName=e.troopList[0].teamName,e.teamPersonList=e.troopList[0].staffDto),e.speechGroup(),e.searchPage()})).catch((function(t){e.$message.error(t)}))},searchBarList:function(){var e=this;I({staffWxUserId:this.$store.state.user.info.userid,teamName:this.keyWordTeamName}).then((function(t){e.troopList=t.data.speechTeams})).catch((function(t){e.$message.error(t)}))},checkTeamId:function(e){this.teamId=e.teamId,this.teamName=e.teamName,this.teamPersonList=e.staffDto,this.speechGroup(),this.searchPage(),this.checkTeam=!1},mouseenter:function(e){this.selectIndex=e},mouseleave:function(){this.selectIndex=null},editSpeechTeam:function(e){this.speechTeamType="edit",this.speechTeamTypeTeamId=e.teamId,this.selectList=[],this.teamForm.teamName=e.teamName;for(var t=[],a=e.staffDto,n=0;n<a.length;n++){var s={disabled:!1,key:a[n].userid,title:a[n].name,source:{name:a[n].name,roleId:a[n].roleId,staffId:a[n].staffId,thumbAvatar:a[n].thumbAvatar,userid:a[n].userid}};t.push(s)}this.$set(this,"selectList",t),this.newTeamModel=!0},deleteSpeechTeam:function(e){var t=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"确定要删除此团队吗？",onOk:function(){t.delSpeechTeam(e.teamId)}})},delSpeechTeam:function(e){var t=this;O({teamId:e}).then((function(e){t.barList(),t.checkTeam=!1,t.$message.success("删除成功")})).catch((function(e){$message.error(e)}))},addUpdateSpeechTeam:function(e){var t=this,a={ownerUserid:this.$store.state.user.info.userid,teamId:"edit"==this.speechTeamType?this.speechTeamTypeTeamId:null,teamName:this.teamForm.teamName,insertList:e};x(a).then((function(e){t.$message.success("操作成功"),t.teamForm.teamName="",t.barList()})).catch((function(e){t.$message.error(e)}))},detailsLanguage:function(e){this.examine=!1,this.detailData=JSON.parse(JSON.stringify(e)),this.state="edit",this.visibleAddLanguage=!0},plusLanguage:function(){this.examine=!0,this.detailData={},this.state="add",this.visibleAddLanguage=!0},serviceOk:function(){this.visibleAddLanguage=!1,this.searchPage()},addTeam:function(){this.selectList=[],this.speechTeamType="add",this.newTeamModel=!0},newTeamOk:function(e){if(""!=this.teamForm.teamName)if(e.length<1)this.$message.warning("请选择员工");else{var t=e.map((function(e){var t={userid:e.source.userid};return t}));this.addUpdateSpeechTeam(t),this.newTeamModel=!1}else this.$message.warning("团队名称不能为空")},handleClose:function(){this.checkTeam=!1}}},be=ve,ye=(a("239b"),Object($["a"])(be,de,pe,!1,null,"6cd2b0b1",null)),_e=ye.exports,Ce=function(){var e=this,t=e._self._c;return t("div",{staticClass:"person_procedure height100 page-box",staticStyle:{"margin-top":"0"}},[e._e(),t("section",{staticClass:"main"},[t("div",{staticClass:"list-selector"},[t("SelectMultiple",{ref:"SelectMultiple",staticStyle:{display:"inline-block"},attrs:{closeCircle:!1},on:{selectCustom:e.selectCustom}})],1),t("aside",{staticClass:"aside background-white"},[t("div",{staticClass:"sidebar-header"}),t("Grouping",{attrs:{groupList:e.groupList,speechType:3,staffId:e.personInfo.staffId,creatorName:e.personInfo.name,showAddBtn:!1},on:{changeSpeechGroupId:e.changeSpeechGroupId,addGroup:e.speechGroup}})],1),t("article",{staticClass:"article"},[t("div",{staticClass:"content-header"},[t("p",[e._v("共"+e._s(e.pagination.total)+"条话术")]),t("a-space",[t("a-input-search",{staticClass:"search-name",attrs:{allowClear:"",placeholder:"请输入话术内容"},on:{search:e.searchPage},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}})],1)],1),t("div",{staticClass:"content-table"},[t("a-table",{staticClass:"background-white",attrs:{columns:e.columns,"data-source":e.fSend,pagination:e.pagination,loading:e.loading},on:{change:e.changePage},scopedSlots:e._u([{key:"speechDetailList",fn:function(a){return t("div",{},[t("ul",[e._l(a,(function(a,n){return t("li",{directives:[{name:"show",rawName:"v-show",value:e.isOpen||n<2,expression:"isOpen || index < 2"}],key:n},[e._v(" "+e._s(a.content)+" ")])})),t("div",{staticClass:"bottom-content"},[t("a-space",{attrs:{size:12}},[t("span",{staticClass:"aks-tips"},[e._v("共"+e._s(a.length)+"条")]),a.length>2?t("span",{staticClass:"aks-tips",on:{click:function(t){e.isOpen=!e.isOpen}}},[e._v(e._s(e.isOpen?"收起":"展开")),t("a-icon",{attrs:{type:e.isOpen?"up":"down"}})],1):e._e()])],1)],2)])}},{key:"creatorName",fn:function(a){return t("div",{staticClass:"tag-list"},[t("a-tag",[t("a-icon",{attrs:{type:"user"}}),e._v(" "+e._s(a)+" ")],1)],1)}},{key:"operation",fn:function(a){return t("div",{},[t("a-button",{attrs:{type:"link"},on:{click:function(t){return e.detailsLanguage(a)}}},[e._v("详情")])],1)}}])},[t("div",{attrs:{slot:"sendNumTxt"},slot:"sendNumTxt"},[e._v(" 发送次数 "),t("a-tooltip",{attrs:{title:"发送次数自本功能上线后开始统计"}},[t("a-icon",{staticStyle:{"margin-left":"4px"},attrs:{type:"question-circle"}})],1)],1)])],1)])]),t("a-modal",{attrs:{footer:null,width:"599px",centered:"",destroyOnClose:""},model:{value:e.visibleAddLanguage,callback:function(t){e.visibleAddLanguage=t},expression:"visibleAddLanguage"}},[t("AddLanguage",{attrs:{speechType:3,staffId:e.personInfo.staffId,creatorName:e.personInfo.name,departmentId:e.departmentId,speechGroupId:e.speechGroupId,state:e.state,examine:e.examine,detailData:e.detailData},on:{cancle:function(t){e.visibleAddLanguage=!1},serviceOk:e.serviceOk,addGroup:e.speechGroup}})],1)],1)},ke=[],Ie=a("eb82"),xe={name:"personProcedure",components:{Grouping:se,AddLanguage:E,SelectMultiple:Ie["a"],AddTransfer:me["a"]},data:function(){return{visibleAddLanguage:!1,examine:!1,speechGroupId:"",departmentId:"",detailData:{},state:"",isOpen:!1,defaultGroupList:[{groupName:"全部分组",speechGroupId:""}],groupList:[],personInfo:{},keywords:"",fSend:[],pagination:{current:1,pageSize:10,total:0},loading:!1,columns:[{title:"话术内容",key:"speechDetailList",dataIndex:"speechDetailList",width:"200px",scopedSlots:{customRender:"speechDetailList"}},{title:"标题",key:"title",dataIndex:"title",scopedSlots:{customRender:"title"}},{key:"sendNum",dataIndex:"sendNum",slots:{title:"sendNumTxt"},scopedSlots:{customRender:"sendNum"}},{title:"所属分组",key:"groupName",dataIndex:"groupName",scopedSlots:{customRender:"groupName"}},{title:"创建人",key:"creatorName",dataIndex:"creatorName",scopedSlots:{customRender:"creatorName"}},{title:"创建时间",key:"createTime",dataIndex:"createTime"},{title:"类型",key:"contentType",dataIndex:"contentType"},{title:"操作",key:"operation",align:"right",dataIndex:"operation",scopedSlots:{customRender:"operation"}}]}},created:function(){},mounted:function(){this.getDictionaryByCode()},methods:{getDictionaryByCode:function(){var e=this,t={currentPage:1,pageSize:1,name:""};Object(T["q"])(t).then((function(t){var a=t.data.list;e.personInfo=a[0],e.$refs.SelectMultiple.selectGroupOwner(a[0])}))},selectCustom:function(e){this.personInfo=e,this.speechGroup(),this.searchPage()},changeSpeechGroupId:function(e){this.speechGroupId=e,this.searchPage()},speechGroup:function(){var e=this;y({speechType:3,staffId:this.personInfo.staffId}).then((function(t){e.groupList=[].concat(Object(c["a"])(e.defaultGroupList),Object(c["a"])(t.data))})).catch((function(t){e.$message.error(t)}))},searchPage:function(){var e=this,t={speechType:3,currentPage:this.pagination.current,pageSize:this.pagination.pageSize,keywords:this.keywords,speechGroupId:this.speechGroupId,staffId:this.personInfo.staffId};this.loading=!0,m(t).then((function(t){null!==t&&void 0!==t&&t.data&&(e.pagination.total=Number(t.data.total),e.fSend=t.data.list.map((function(e){var t=Object(o["a"])(Object(o["a"])({},e),{},{key:String(e.speechInfoId),contentType:"文字"});return Object(o["a"])(Object(o["a"])({},t),{},{operation:t})})))})).catch((function(t){e.$message.error(t)})).finally((function(){return e.loading=!1}))},changePage:function(e){var t=e.current;this.pagination.current=t,this.searchPage()},detailsLanguage:function(e){this.examine=!1,this.detailData=JSON.parse(JSON.stringify(e)),this.state="edit",this.visibleAddLanguage=!0},plusLanguage:function(){this.examine=!0,this.detailData={},this.state="add",this.visibleAddLanguage=!0},serviceOk:function(){this.visibleAddLanguage=!1,this.searchPage()}}},Oe=xe,Te=(a("3c83"),Object($["a"])(Oe,Ce,ke,!1,null,"337692d1",null)),Le=Te.exports,we={name:"teamProcedure",components:{enterpriseProcedure:ue,groupProcedure:_e,personProcedure:Le},data:function(){return{activeKey:"1"}},created:function(){},mounted:function(){},watch:{},computed:{},methods:{callback:function(e){this.activeKey=e}}},Se=we,Ne=(a("f931"),Object($["a"])(Se,n,s,!1,null,"7a6dbcb1",null));t["default"]=Ne.exports},afd2:function(e,t,a){},b04e:function(e,t,a){"use strict";a("f597")},b79e:function(e,t,a){"use strict";a("8242")},c0e2:function(e,t,a){},e476:function(e,t,a){"use strict";a("2d24")},e6b1:function(e,t,a){"use strict";var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"phone-model"},[t("img",{staticClass:"bg",attrs:{src:"/imgs/chatBg.png"}}),t("div",{staticClass:"contant"},[t("p",{staticClass:"time"},[e._v(e._s(e.time))]),e.textList.length>0?t("ul",e._l(e.textList,(function(a,n){return t("li",{key:n,staticClass:"contant-list"},["img"===a.type?[t("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),t("div",{staticClass:"contant-main"},[t("img",{staticClass:"upload-img",attrs:{src:a.pic_url.compress}})])]:e._e(),"link"===a.type?[t("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),t("div",{staticClass:"contant-title"},[t("a-tooltip",{attrs:{title:a.linkTitle}},[t("p",{staticClass:"contant-subtitle"},[e._v(e._s(a.linkTitle))])]),t("div",{staticClass:"contant-contant"},[a.desc?t("a-tooltip",{attrs:{title:a.desc}},[t("span",[e._v(e._s(a.desc))])]):e._e(),t("a-avatar",{attrs:{src:a.coverUrl.compress,size:32,shape:"square"}})],1)],1)]:e._e(),a.type?e._e():[t("img",{staticClass:"user",attrs:{src:"/icons/user.png"}}),t("div",{staticClass:"contant-main"},[e._v(e._s(a))])]],2)})),0):e._e()])])},s=[],i={name:"PhoneModel",data:function(){return{time:this.$moment().format("HH:mm")}},props:{textList:{type:[Array],default:function(){return[]}}},watch:{textList:function(){}}},r=i,o=(a("8e34"),a("2877")),c=Object(o["a"])(r,n,s,!1,null,"1aa7a172",null);t["a"]=c.exports},eb82:function(e,t,a){"use strict";a("498a"),a("b0c0");var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"page-wrap"},[t("div",{staticClass:"button-name",on:{click:function(t){return t.stopPropagation(),e.selectFocusIsOpen.apply(null,arguments)},mouseenter:e.enter,mouseleave:e.leave}},[e.employeeName?t("span",{staticClass:"hidden"},[t("a-avatar",{attrs:{size:28,shape:"square",src:e.thumbAvatar}}),e._v(" "+e._s(e.employeeName)+" ")],1):t("span",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",color:"rgba(0, 0, 0, 0.25)"}},[e._v(" "+e._s(e.placeholderStr)+" ")]),e.closeCircle?t("span",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"}},[e.employeeName&&1!=e.styleButton?t("a-icon",{attrs:{type:"close-circle",theme:"filled"},on:{click:function(t){return t.stopPropagation(),e.iconClear.apply(null,arguments)}}}):t("a-icon",{attrs:{type:"down"}})],1):e._e()]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"isOpen"},{name:"clickoutside",rawName:"v-clickoutside",value:e.handleClose,expression:"handleClose"}],staticClass:"selectBox_list"},[t("div",{staticClass:"group-owner"},[t("header",{staticClass:"header"},[e._v("全部员工 ("+e._s(e.total)+")")]),t("div",{staticClass:"search-name"},[t("a-input-search",{attrs:{placeholder:"请输入员工后回车"},on:{search:e.onSearchName},model:{value:e.searchName,callback:function(t){e.searchName="string"===typeof t?t.trim():t},expression:"searchName"}})],1),t("ul",{staticClass:"list-wrap"},[t("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.getDictionaryByCode,expression:"getDictionaryByCode"}],staticClass:"demo-infinite-container",attrs:{"infinite-scroll-disabled":e.busy,"infinite-scroll-distance":10}},e._l(e.groupOwners,(function(a){return t("li",{key:a.staffId,staticClass:"title-wrap",on:{click:function(t){return e.selectGroupOwner(a)}}},[t("a-space",{attrs:{size:12}},[t("a-avatar",{attrs:{size:30,src:a.thumbAvatar,shape:"square"}}),t("span",[e._v(e._s(a.name))])],1),e.checkShow?t("div",[e.userId==a.userid?t("a-icon",{staticClass:"check-circle",attrs:{type:"check-circle"}}):t("div",{staticClass:"circle"})],1):e._e()],1)})),0)])])])])},s=[],i=a("2909"),r=(a("d81d"),a("4de4"),a("d3b7"),a("25f0"),a("159b"),a("caad"),a("2532"),a("99af"),a("487a")),o=a.n(r),c=a("1c9c"),l={bind:function(e,t){function a(a){if(e.contains(a.target))return!1;t.expression&&t.value(a)}e.__vueClickOutside__=a,document.addEventListener("click",a)},update:function(){},unbind:function(e){document.removeEventListener("click",e.__vueClickOutside__),delete e.__vueClickOutside__}},u={name:"SearchForm",directives:{clickoutside:l,infiniteScroll:o.a},props:{checkShow:{type:Boolean,default:!1},userName:{type:String,default:""},userId:{type:String,default:""},userThumbAvatar:{type:String,default:""},reactflag:{type:Boolean,default:!1},placeholderStr:{type:String,default:"请选择企业员工"},closeCircle:{type:Boolean,default:!0}},data:function(){return{defalytStaffIndex:[],thumbAvatar:"",busy:!0,pagination:{current:1,pageSize:10,total:0},total:0,totalNum:0,selectRoleId:"3",employeeName:"",groupOwners:[],page:1,limit:10,value:[],searchName:"",styleButton:1,owners:[],isOpen:!1,loading:!1,buttonLoding:!1,ownersID:{data:[]}}},created:function(){},methods:{enter:function(){this.styleButton=2},leave:function(){this.styleButton=1},selectGroupOwner:function(e){this.employeeName=e.name,this.thumbAvatar=e.thumbAvatar,this.isOpen=!1,this.$emit("selectCustom",e)},iconClear:function(){this.employeeName="",this.isOpen=!1;var e={empty:"1"};this.groupOwners=[],this.page=1,this.searchName="",this.getDictionaryByCode(),this.$emit("selectCustom",e)},handleClose:function(){this.isOpen=!1},selectFocusIsOpen:function(){this.isOpen=!this.isOpen},ok:function(){var e=this.groupOwners.filter((function(e){if(e.defaultChecked)return e.userid})).map((function(e){return e.userid})),t=this.groupOwners.filter((function(e){if(e.defaultChecked)return e})).map((function(e){return{name:e.name,avatar:e.thumbAvatar}}));this.ownersID.data=t;var a=e.toString();this.isOpen=!this.isOpen,this.$store.commit("SET_STAFFIDS",a)},cancel:function(){var e=this;this.isOpen=!this.isOpen,this.groupOwners.forEach((function(t){var a=e.responseData.useridList.includes(t.userid);t.defaultChecked=!!a}));var t=this.groupOwners.filter((function(e){if(e.defaultChecked)return e})).map((function(e){return{name:e.name,avatar:e.thumbAvatar}}));this.ownersID.data=t},handleInfiniteOnLoad:function(){this.pagination.current++,this.loading&&this.getDictionaryByCode()},getDictionaryByCode:function(){var e=this,t={currentPage:this.page,pageSize:this.limit,name:this.searchName||""};this.buttonLoding||(this.buttonLoding=!0,this.loading=!0,"0"!=this.total&&this.groupOwners.length>=this.total?this.busy=!0:Object(c["q"])(t).then((function(t){var a=t.data.list;e.total=t.data.total,e.page>1?e.groupOwners=[].concat(Object(i["a"])(e.groupOwners),Object(i["a"])(a)):e.groupOwners=Object(i["a"])(a),e.groupOwners.length>=e.total?e.busy=!0:(e.page=e.page+1,e.loading=!1)})).catch((function(t){e.$message.error(t||t.message)})).finally((function(){e.buttonLoding=!1})))},onSearchName:function(){this.groupOwners=[],this.page=1,this.getDictionaryByCode()}},watch:{reactflag:{handler:function(e,t){!0===e&&(this.employeeName="",this.isOpen=!1,this.groupOwners=[],this.page=1,this.searchName="",this.getDictionaryByCode())}},userName:function(){this.employeeName=this.userName},userThumbAvatar:function(){this.thumbAvatar=this.userThumbAvatar}}},d=u,p=(a("9994"),a("2877")),m=Object(p["a"])(d,n,s,!1,null,"c2d4f660",null);t["a"]=m.exports},f597:function(e,t,a){},f7f6:function(e,t,a){},f931:function(e,t,a){"use strict";a("a669")}}]);