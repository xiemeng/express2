(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46d2ca3c"],{a680:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t._self._c;return e("div",{staticClass:"Attribute"},[e("section",{staticClass:"section"},[e("div",{staticClass:"total"},[e("a-form-model",{ref:"ruleForm",staticClass:"ant-advanced-search-form",attrs:{form:t.form,layout:"inline"}},[e("a-form-model-item",{attrs:{label:"Contact Name",name:"AttributeName"}},[e("a-input",{attrs:{placeholder:"place input",size:"large",allowClear:""},model:{value:t.form.contactName,callback:function(e){t.$set(t.form,"contactName",e)},expression:"form.contactName"}})],1),e("a-form-model-item",{attrs:{label:"Attribute value"}},[e("a-input",{attrs:{placeholder:"place input",size:"large",allowClear:""},model:{value:t.form.propertiesValue,callback:function(e){t.$set(t.form,"propertiesValue",e)},expression:"form.propertiesValue"}})],1),e("a-form-model-item",[e("a-button",{attrs:{type:"primary"},on:{click:t.searchList}},[t._v("Search")]),e("a-button",{style:{marginLeft:"8px"},on:{click:t.clearFn}},[t._v("Clear")])],1)],1),e("a-button",{staticClass:"btn",attrs:{type:"primary",size:"large",disabled:t.Actions},on:{click:t.addBtn}},[t._v("Add Attribute")])],1),e("div",[e("a-table",{staticClass:"table",attrs:{columns:t.columns,rowKey:"id",loading:t.loading,dataSource:t.clientList,pagination:t.pagination},on:{change:t.changeTab},scopedSlots:t._u([{key:"Edit",fn:function(a,n){return e("div",{},[e("a-button",{attrs:{type:"link",disabled:t.Actions},on:{click:function(e){return t.editPage(n)}}},[t._v("Edit")]),t._v("  "),e("a-button",{attrs:{type:"link",disabled:t.Actions},on:{click:function(e){return t.deletePage(n)}}},[t._v("Delete")]),t._v("  ")],1)}}])})],1)]),e("a-modal",{attrs:{destroyOnClose:"",confirmLoading:t.confirmLoading,width:"600px",centered:""},on:{cancel:function(e){t.AddBox=!1},ok:t.submitKeyword},model:{value:t.AddBox,callback:function(e){t.AddBox=e},expression:"AddBox"}},[e("div",{staticClass:"panel"},[e("h2",{staticClass:"dialog-title"},[t._v(t._s("add"===t.addType?"Add":"Edit")+" Attribute")]),e("a-form-model",t._b({ref:"ruleForm",attrs:{rules:t.rules,model:t.modalForm}},"a-form-model",t.layout,!1),[e("a-form-model-item",{attrs:{label:"contact",prop:"contactId"}},[e("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"",placeholder:"place search","filter-option":!1,"not-found-content":t.fetching?void 0:null},on:{search:t.fetchUser},model:{value:t.modalForm.contactId,callback:function(e){t.$set(t.modalForm,"contactId",e)},expression:"modalForm.contactId"}},[t.fetching?e("a-spin",{attrs:{slot:"notFoundContent",size:"small"},slot:"notFoundContent"}):t._e(),t._l(t.userList,(function(a){return e("a-select-option",{key:a.id},[t._v(" "+t._s(a.displayName)+" ")])}))],2)],1),e("a-form-model-item",{attrs:{label:"Attribute",prop:"propertiesId"}},[e("a-select",{attrs:{placeholder:"Attribute",size:"large"},on:{change:t.changePerson},model:{value:t.modalForm.propertiesId,callback:function(e){t.$set(t.modalForm,"propertiesId",e)},expression:"modalForm.propertiesId"}},t._l(t.tagList,(function(a){return e("a-select-option",{key:a.id,attrs:{value:a.id}},[t._v(" "+t._s(a.cname)+" ")])})),1)],1)],1)],1)])],1)},o=[],r=a("ade3"),i=a("5530"),c=(a("d3b7"),a("d81d"),a("a9e3"),a("7db0"),a("aa39")),s=a("d28d"),d=a("1f72"),u={name:"Attribute",components:{},data:function(){return{userList:[],AddBox:!1,fetching:!1,loading:!1,addType:"add",pagination:{current:1,pageSize:10,total:0},addTxt:"",form:{contactName:void 0,propertiesValue:void 0},layout:{labelCol:{span:4},wrapperCol:{span:18}},clientList:[],columns:[{title:"Attribute Name",dataIndex:"properties"},{title:"Attribute Value",dataIndex:"value"},{title:"Attribute Type",dataIndex:"dataType"},{title:"contacts",dataIndex:"contactName"},{title:"Create Time",dataIndex:"createTime"},{title:"Actions",dataIndex:"Edit",scopedSlots:{customRender:"Edit"}}],confirmLoading:!1,modalForm:{contactId:void 0,propertiesValue:void 0,propertiesId:void 0,id:void 0},rules:{contactId:[{required:!0,message:"Please input contactId"}],propertiesId:[{required:!0,message:"Please select attribute"}]},tagList:[]}},created:function(){this.getList(),this.init()},computed:{Actions:function(){return!this.$route.meta.Actions}},methods:{init:function(){var t=this;Object(s["i"])().then((function(e){e.data&&(t.tagList=e.data)})).catch((function(e){t.$message.error(e)}))},clearFn:function(){this.form={contactName:void 0,propertiesValue:void 0},this.searchList()},getList:function(){var t=this,e=Object(i["a"])({currentPage:this.pagination.current,pageSize:this.pagination.pageSize},this.form);this.loading=!0,Object(c["d"])(e).then((function(e){var a;t.clientList=null===(a=e.data.records)||void 0===a?void 0:a.map((function(e){return Object(i["a"])(Object(i["a"])({},e),{},{createTime:e.createTime?t.$moment(e.createTime).format("YYYY-MM-DD HH:mm:ss"):"-"})})),t.pagination.total=e.data.total})).catch((function(e){t.$message.error(e)})).finally((function(){t.loading=!1}))},searchList:function(){this.pagination.current=1,this.getList()},editPage:function(t){this.addType="edit",this.fetchUser(t.contactName),this.modalForm={contactId:t.contactId,propertiesValue:t.propertiesValue,propertiesId:t.propertiesId?Number(t.propertiesId):"",id:t.id},this.AddBox=!0},deletePage:function(t){var e=this;this.$confirm({title:"tip",icon:"",cancelText:"cancel",okText:"delete",content:"It cannot be restored after being deleted",onOk:function(){e.contactsDeleteFun(t.id)}})},contactsDeleteFun:function(t){var e=this,a={id:t};Object(c["b"])(a).then((function(t){e.$message.success("delete success"),e.getList()})).catch((function(t){e.$message.error(t)}))},submitKeyword:function(){var t=this;this.$refs.ruleForm.validate((function(e){if(!e)return!1;var a=Object(i["a"])({},t.modalForm);t.confirmLoading=!0,t.modalForm.id?t.editKeywordFn(a):t.addKeywordFn(a)}))},addKeywordFn:function(t){var e=this;Object(c["a"])(t).then((function(t){e.AddBox=!1,e.$message.success("success"),e.searchList()})).catch((function(t){e.$message.error(t)})).finally((function(){e.confirmLoading=!1}))},editKeywordFn:function(t){var e=this;t.id=this.modalForm.id,Object(c["c"])(t).then((function(t){e.AddBox=!1,e.$message.success("success"),e.searchList()})).catch((function(t){e.$message.error(t)})).finally((function(){e.confirmLoading=!1}))},addBtn:function(){this.modalForm={contactId:void 0,propertiesValue:void 0,propertiesId:void 0,id:void 0},this.addType="add",this.AddBox=!0},changeTab:function(t){var e=t.current;this.pagination.current=e,this.getList()},changePerson:function(t){var e=this.tagList.find((function(e){return e.id===t}));e&&(this.modalForm.propertiesValue=e.cname)},fetchUser:function(t){var e=this;this.fetching=!0;var a=Object(r["a"])({displayName:t,email:"",orderType:0,pageSize:0,phone:"",sort:"",tagList:[],currentPage:1},"pageSize",300);Object(d["a"])(a).then((function(t){var a;e.userList=null===(a=t.data.records)||void 0===a?void 0:a.map((function(t){return Object(i["a"])(Object(i["a"])({},t),{},{key:t.id,lastMsgDatetime:t.lastMsgDatetime?e.$moment(t.lastMsgDatetime).format("HH:mm"):""})}))})).catch((function(t){e.$message.error(t)})).finally((function(){e.fetching=!1}))}}},l=u,m=(a("dcf1"),a("2877")),p=Object(m["a"])(l,n,o,!1,null,"4c290475",null);e["default"]=p.exports},aa39:function(t,e,a){"use strict";a.d(e,"d",(function(){return r})),a.d(e,"a",(function(){return i})),a.d(e,"c",(function(){return c})),a.d(e,"b",(function(){return s}));var n=a("b775"),o={getContactsProperties:"/userProperties/getContactsProperties",addContactsProperties:"/userProperties/addContactsProperties",editContactsProperties:"/userProperties/editContactsProperties",delContactsProperties:"/userProperties/delContactsProperties"};function r(t){return Object(n["b"])({url:o.getContactsProperties,method:"post",data:t})}function i(t){return Object(n["b"])({url:o.addContactsProperties,method:"post",data:t})}function c(t){return Object(n["b"])({url:o.editContactsProperties,method:"post",data:t})}function s(t){return Object(n["b"])({url:o.delContactsProperties,method:"get",params:t})}},d28d:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return i})),a.d(e,"k",(function(){return c})),a.d(e,"i",(function(){return s})),a.d(e,"j",(function(){return d})),a.d(e,"d",(function(){return u})),a.d(e,"h",(function(){return l})),a.d(e,"l",(function(){return m})),a.d(e,"e",(function(){return p})),a.d(e,"f",(function(){return f})),a.d(e,"c",(function(){return g})),a.d(e,"g",(function(){return h}));var n=a("b775"),o={categories_tags:"/tbTagCategory/queryAllTagTree",category:"/tbTagCategory/add",searchCategory:"/tbTagCategory/queryAllTag",tag:"/tbUserTag/create",propreties:"/properties/listAll",actions:"/tag/actions",create:"/schedule/create",info:"/tbUserTag/queryById",tag_infos:"/tbTagResult/getTagHierarchyResult",downloadTag:"/tag/download",deleteTag:"/tag",detailTag:"/tag",putTag:"/tag",getAllOptions:"/properties/getAllOptions",changeStatus:"/tbUserTag/changeStatus"};function r(t){return Object(n["b"])({url:o.categories_tags,method:"get",params:t})}function i(t){return Object(n["b"])({url:o.category,method:"get",params:t})}function c(t){return Object(n["b"])({url:o.tag,method:"post",data:t})}function s(t){return Object(n["b"])({url:o.propreties,method:"post",data:t})}function d(t){return Object(n["b"])({url:o.searchCategory,method:"get",params:t})}function u(t){return Object(n["b"])({url:o.create,method:"post",data:t})}function l(t){return Object(n["b"])({url:o.info,method:"get",params:t})}function m(t){return Object(n["b"])({url:o.tag_infos,method:"post",data:t})}function p(t){return Object(n["b"])({url:o.deleteTag,method:"delete",params:t})}function f(t){return Object(n["b"])({url:o.downloadTag,method:"get",params:t,responseType:"blob"})}function g(t){return Object(n["b"])({url:o.changeStatus,method:"post",data:t})}function h(t){return Object(n["b"])({url:o.getAllOptions,method:"get",params:t})}},dcf1:function(t,e,a){"use strict";a("ee86")},ee86:function(t,e,a){}}]);