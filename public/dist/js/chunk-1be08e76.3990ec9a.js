(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1be08e76"],{"0a87":function(t,e,r){},1816:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAcCAYAAABlL09dAAACN0lEQVRIS63WP2gTcRTA8e/LJSAmgg5KlWCE4qAuOlQEpRV1sA4FV2kHa9LT4OrQoYuDiLM15FpaEHFWhOKgVCwOFhEnHRSJolXpUjQpaMw9ubv86zXNxVzfePfe53737sf7ndBJWHoIZc5NjTHIqLwNKpOgBPd+Xu8AV6q5OUzJBtUFw1OaxOYdkKhiRSIcICNf2uHt4Wk9ToV7wD4fUsBgmLS82AhvDc/qdsrcBi6gtM4RFLhPjKtclBX/A9YXzehB/jKHkgrqo3tf+IQwSEacdtVjLZzXGMIiyuGO0FqS8AblKKaUG5eaBUuzKJP/hTaSs5iS2wieRznZJTyPKafWw7O6hTJFFKMrWKiQJM45+e21vhbTmqJCoSu0UZTClM9rYUv7UBZDwVH6uCSv/Cs+TYUnoWCDM6TlqX/FQygPQ8JDpOWRHx5BuRsKjjBCRpwR0PTxLB1HuREKhnFMuemHcyiXQ8L1kdrYbnldAE6EgoUFxqS/sWLVCFOsoGwLBcNPxtiBiO2t2NIBlGchUa/cYIC0PBeciQYvgSObAsNr4JgDTwDXNwn1GGHCgb8BPR3AtVnrvGFQfHfgHwjvUT4ABYSvKEsYLKEsE6XIH0r1Ie60LkGCVeLY7ELYA+wGktWzsRdlf9Bh2o/NNZQ4Qhx1T8ASsIpwi4w4W7RltIdndCdlPjYd/bUe/iJKL6Oy3B3sbcXzqPsLsLX6YUoow5jyoF2jg39YnOq87iXCWReyeVwb5u3gf93Qq88H8W2mAAAAAElFTkSuQmCC"},"18a8":function(t,e,r){"use strict";r("7f58")},"1da1":function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));r("d3b7");function a(t,e,r,a,i,s,n){try{var o=t[s](n),c=o.value}catch(u){return void r(u)}o.done?e(c):Promise.resolve(c).then(a,i)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(i,s){var n=t.apply(e,r);function o(t){a(n,i,s,o,c,"next",t)}function c(t){a(n,i,s,o,c,"throw",t)}o(void 0)}))}}},"2aea":function(t,e,r){},"3c43":function(t,e,r){t.exports=r.p+"assets/avatar-room-default.de3b5fcd.svg"},4107:function(t,e,r){"use strict";r("ef9e")},"4f23":function(t,e,r){"use strict";r("8228")},"64ac":function(t,e,r){"use strict";r("0a87")},"7f58":function(t,e,r){},8228:function(t,e,r){},b5c3:function(t,e,r){t.exports=r.p+"assets/default.c42b7ede.svg"},c7eb:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("b636"),r("944a"),r("0c47"),r("23dc"),r("3410"),r("159b"),r("b0c0"),r("131a"),r("fb6a");var a=r("53ca");function i(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
i=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",c=n.asyncIterator||"@@asyncIterator",u=n.toStringTag||"@@toStringTag";function l(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(N){l=function(t,e,r){return t[e]=r}}function m(t,e,r,a){var i=e&&e.prototype instanceof f?e:f,n=Object.create(i.prototype),o=new k(a||[]);return s(n,"_invoke",{value:L(t,r,o)}),n}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(N){return{type:"throw",arg:N}}}t.wrap=m;var p={};function f(){}function h(){}function v(){}var g={};l(g,o,(function(){return this}));var y=Object.getPrototypeOf,b=y&&y(y(S([])));b&&b!==e&&r.call(b,o)&&(g=b);var T=v.prototype=f.prototype=Object.create(g);function x(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(s,n,o,c){var u=d(t[s],t,n);if("throw"!==u.type){var l=u.arg,m=l.value;return m&&"object"==Object(a["a"])(m)&&r.call(m,"__await")?e.resolve(m.__await).then((function(t){i("next",t,o,c)}),(function(t){i("throw",t,o,c)})):e.resolve(m).then((function(t){l.value=t,o(l)}),(function(t){return i("throw",t,o,c)}))}c(u.arg)}var n;s(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){i(t,r,e,a)}))}return n=n?n.then(a,a):a()}})}function L(t,e,r){var a="suspendedStart";return function(i,s){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===i)throw s;return I()}for(r.method=i,r.arg=s;;){var n=r.delegate;if(n){var o=_(n,r);if(o){if(o===p)continue;return o}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===a)throw a="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a="executing";var c=d(t,e,r);if("normal"===c.type){if(a=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a="completed",r.method="throw",r.arg=c.arg)}}}function _(t,e){var r=e.method,a=t.iterator[r];if(void 0===a)return e.delegate=null,"throw"===r&&t.iterator["return"]&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=d(a,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,p;var s=i.arg;return s?s.done?(e[t.resultName]=s.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):s:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function C(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function e(){for(;++a<t.length;)if(r.call(t,a))return e.value=t[a],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return h.prototype=v,s(T,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:h,configurable:!0}),h.displayName=l(v,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,u,"GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},x(w.prototype),l(w.prototype,c,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,a,i,s){void 0===s&&(s=Promise);var n=new w(m(e,r,a,i),s);return t.isGeneratorFunction(r)?n:n.next().then((function(t){return t.done?t.value:n.next()}))},x(T),l(T,u,"Generator"),l(T,o,(function(){return this})),l(T,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var a in e)r.push(a);return r.reverse(),function t(){for(;r.length;){var a=r.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},t.values=S,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function a(r,a){return n.type="throw",n.arg=t,e.next=r,a&&(e.method="next",e.arg=void 0),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],n=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),c=r.call(s,"finallyLoc");if(o&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(t,e){for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var n=s?s.completion:{};return n.type=t,n.arg=e,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(n)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),C(r),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var a=r.completion;if("throw"===a.type){var i=a.arg;C(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}},ef9e:function(t,e,r){},f506:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("a-tabs",{attrs:{"default-active-key":"1"}},[e("a-tab-pane",{key:"1",attrs:{tab:"积分规则"}},[e("integralRule")],1)],1)],1)},i=[],s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"integralRule"},[e("div",{staticClass:"customer-integral-inner"},[e("div",{staticClass:"nav-container"},[e("div",{staticStyle:{"border-left":"1px solid #e8e8e8",display:"flex"}},[e("div",{class:[{active:t.defalutState},"base-tab"],on:{click:function(e){return t.tabState("0")}}},[t._v("企微行为积分设置 ")])])]),t.defalutState?e("section",[e("ChannelList")],1):e("section",[e("Setting")],1)])])},n=[],o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"customer-integral-rule-setting"},[t._m(0),t._m(1),e("div",{staticClass:"filter-wrap"},[e("div",{staticClass:"add-rule"},[e("a-button",{attrs:{type:"primary"},on:{click:t.addRule}},[t._v("+ 添加规则")]),e("div",{staticClass:"rule-tips"},[t._v("*最多只能添加100条")])],1),e("div",{staticClass:"filter-box"},[e("div",[t._v(" 积分类型："),e("a-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择类型",allowClear:""},on:{change:t.handleChange}},[e("a-select-option",{attrs:{value:"0"}},[t._v("加入客户群")]),e("a-select-option",{attrs:{value:"1"}},[t._v("在客户群发言")]),e("a-select-option",{attrs:{value:"2"}},[t._v("加成员的企业微信为好友")]),e("a-select-option",{attrs:{value:"3"}},[t._v("在成员的"+t._s(t.ENTERPRICE_NAME)+"朋友圈签到")])],1)],1)])]),e("a-table",{staticClass:"table",attrs:{columns:t.columns,pagination:t.pagination,"data-source":t.clientList,loading:t.tableLoading},on:{change:t.change},scopedSlots:t._u([{key:"createUserName",fn:function(r){return e("div",{},[e("a-tag",[e("a-icon",{staticClass:"primaryColor",attrs:{type:"user"}}),t._v(" "+t._s(r)+" ")],1)],1)}},{key:"addFraction",fn:function(r){return e("div",{},[t._v("+"+t._s(r))])}},{key:"ruleStatusFlag",fn:function(r){return e("div",{},[e("a-switch",{attrs:{size:"small"},on:{change:function(e){return t.chnageRuleStatus(e,r.id)}},model:{value:r.flag,callback:function(e){t.$set(r,"flag",e)},expression:"ruleStatusFlag.flag"}}),t._v(" "+t._s(r.flag?"已开启":"已关闭")+" ")],1)}},{key:"list",fn:function(a){return e("div",{},[a.roomMembers.length>0?e("div",t._l(a.roomMembers,(function(r,a){return e("a-tag",{key:a},[e("a-icon",{staticClass:"primaryColor",attrs:{type:"user"}}),t._v(" "+t._s(r.memberName)+" ")],1)})),1):t._e(),a.roomInfos.length>0?e("div",t._l(a.roomInfos,(function(a,i){return e("div",{key:i},[e("span",{staticClass:"ant-tag people-box group-box"},[e("img",{attrs:{src:r("3c43")}}),e("span",{staticClass:"group-name"},[t._v(t._s(a.roomName))])])])})),0):t._e(),a.roomTags.length>0?e("div",[e("p",{staticClass:"tag-label"},[t._v("生效群聊为包含以下标签的群聊：")]),t._l(a.roomTags,(function(r,a){return e("span",{key:a,staticClass:"ant-tag"},[t._v(t._s(r.tagName))])}))],2):t._e()])}},{key:"operation",fn:function(r){return e("div",{},[e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.edit(r)}}},[t._v("编辑")]),e("a-button",{attrs:{type:"link"},on:{click:function(e){return t.deleteRule(r)}}},[t._v("删除")])],1)}}])}),e("a-modal",{staticClass:"noBottomBorder",attrs:{footer:null,width:"688px",centered:""},model:{value:t.ruleShow,callback:function(e){t.ruleShow=e},expression:"ruleShow"}},[e("rulePopup",{attrs:{scouce:t.scouce,timestamp:t.timestamp,timestampEdit:t.timestampEdit,idx:t.idx},on:{cancelRule:t.cancelRule,successRule:t.successRule}})],1)],1)},c=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"tips"},[e("img",{staticClass:"bell",attrs:{src:r("1816")}}),t._v(" 「企微任务宝活动」、「抽奖活动」也可以设置积分规则哦~ ")])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"title"},[t._v(" 设置积分规则 "),e("span",{staticClass:"rule-tips"},[t._v("根据规则，当客户在使用过程中触发设定行为，将自动被添加相应积分")])])}],u=(r("a9e3"),r("d3b7"),r("d81d"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"ruleShow"},[e("h2",{staticClass:"dialog-title"},[t._v(t._s(t.stateText)+"规则")]),e("section",[e("a-form",{attrs:{"label-col":{span:4},"wrapper-col":{span:8}}},[e("a-form-item",{attrs:{label:"规则名称：",required:""}},[e("a-input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入规则名称"},model:{value:t.ruleName,callback:function(e){t.ruleName=e},expression:"ruleName"}})],1),e("a-form-item",{attrs:{label:"规则内容：",required:""}},[e("div",{staticClass:"panel"},[e("div",{staticClass:"primary"},[e("span",{staticStyle:{"padding-left":"10px"}},[t._v("当客户")]),e("a-select",{staticClass:"kongxi",staticStyle:{width:"210px"},attrs:{placeholder:"请选择积分类型",allowClear:""},model:{value:t.customerRuleType,callback:function(e){t.customerRuleType=e},expression:"customerRuleType"}},[e("a-select-option",{attrs:{value:"0"}},[t._v("加入客户群")]),e("a-select-option",{attrs:{value:"1"}},[t._v("在客户群发言")]),e("a-select-option",{attrs:{value:"2"}},[t._v("加成员的企业微信为好友")]),e("a-select-option",{attrs:{value:"3"}},[t._v("在成员的"+t._s(t.ENTERPRICE_NAME)+"朋友圈签到")])],1),e("span",[t._v("后，增加")]),e("a-input-number",{staticClass:"kongxi",attrs:{min:1,precision:0,max:100},model:{value:t.addFraction,callback:function(e){t.addFraction=e},expression:"addFraction"}}),e("span",[t._v("积分")]),e("div",{directives:[{name:"show",rawName:"v-show",value:"0"==t.customerRuleType||"2"==t.customerRuleType,expression:"customerRuleType == '0' || customerRuleType == '2'"}],staticClass:"extra"},[t._v(" 注意：客户重复加入同一客户群只加一次积分 ")]),e("div",{directives:[{name:"show",rawName:"v-show",value:"1"==t.customerRuleType,expression:"customerRuleType == '1'"}],staticClass:"extra"},[t._v("注意：只有开通了消息存档的客户群才可以设置此规则")])],1),e("div",[e("div",{directives:[{name:"show",rawName:"v-show",value:"0"==t.customerRuleType||"1"==t.customerRuleType,expression:"customerRuleType == '0' || customerRuleType == '1'"}],staticClass:"form-item"},[e("label",[t._v("生效群聊：")]),e("div",{staticClass:"group-select-box"},[e("a-radio-group",{model:{value:t.type,callback:function(e){t.type=e},expression:"type"}},[e("a-radio",{staticStyle:{"margin-right":"25px"},attrs:{value:0}},[t._v("选择客户群")]),e("a-radio",{attrs:{value:1}},[t._v("群标签筛选")])],1),e("div",{staticClass:"selected-target"},[e("a-button",{on:{click:t.choiceBox}},[t._v("+ 选择"+t._s("0"==t.type?"客户群":"群标签"))]),"0"==t.type&&t.roomIdsList.length>0?e("div",{staticClass:"selected-groups"},t._l(t.roomIdsList,(function(r,a){return e("div",{key:a,staticClass:"group-item"},[e("img",{attrs:{src:t.defaultThumbAvatar}}),e("div",{staticClass:"info-box"},[t._v(t._s(r.title))]),e("a-icon",{staticClass:"close-icon",attrs:{type:"close-circle"},on:{click:function(e){return t.detRoomIdsList(a)}}})],1)})),0):t._e(),"1"==t.type&&t.roomTagList.length>0?e("div",{staticClass:"selected-tags"},t._l(t.roomTagList,(function(r,a){return e("div",{key:a,staticClass:"tag-item"},[e("div",{staticClass:"name"},[t._v(t._s(r.tagName))]),e("a-icon",{staticClass:"close-icon",attrs:{type:"close"},on:{click:function(e){return t.detRoomTagList(a)}}})],1)})),0):t._e()],1)],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:"1"==t.customerRuleType,expression:"customerRuleType == '1'"}],staticClass:"form-item",staticStyle:{"margin-bottom":"12px"}},[e("label",[t._v("每日上限：")]),e("div",{staticClass:"group-select-box"},[e("a-radio-group",{model:{value:t.integralLimit,callback:function(e){t.integralLimit=e},expression:"integralLimit"}},[e("a-radio",{staticStyle:{"margin-right":"25px"},attrs:{value:0}},[t._v("不限")]),e("a-radio",{attrs:{value:1}},[t._v("限制")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:"1"==t.integralLimit,expression:"integralLimit == '1'"}]},[e("span",[t._v("同一客户群每日最多可添加")]),e("a-input-number",{staticClass:"kongxi",attrs:{min:1,precision:0,max:100},model:{value:t.limitFraction,callback:function(e){t.limitFraction=e},expression:"limitFraction"}}),e("span",[t._v("次积分")])],1)],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:"2"==t.customerRuleType||"3"==t.customerRuleType,expression:"customerRuleType == '2' || customerRuleType == '3'"}],staticClass:"form-item",staticStyle:{"margin-bottom":"12px"}},[e("label",[t._v("生效成员：")]),e("div",{staticClass:"selected-target"},[e("a-button",{on:{click:function(e){t.memberTree=!0}}},[t._v("+ 生效成员")]),t.memberIdsList.length>0?e("div",{staticClass:"selected-users"},t._l(t.memberIdsList,(function(r,a){return e("div",{key:a,staticClass:"user-item"},[e("div",{staticClass:"avatar"},[e("img",{attrs:{src:r.source.thumbAvatar}})]),e("div",{staticClass:"name"},[t._v(t._s(r.title))]),e("a-icon",{staticClass:"close-icon",attrs:{type:"close-circle"},on:{click:function(e){return t.detMemberList(a)}}})],1)})),0):t._e()],1)])])])]),e("a-form-item",{attrs:{label:"规则状态："}},[e("a-switch",{attrs:{size:"small"},model:{value:t.ruleStatusFlag,callback:function(e){t.ruleStatusFlag=e},expression:"ruleStatusFlag"}}),t._v(t._s(t.ruleStatusFlag?"已开启":"已关闭")+" ")],1)],1),e("div",{staticClass:"add-integral-rule-footer"},[e("a-button",{on:{click:t.cancel}},[t._v("取消")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.sure}},[t._v("确定")])],1)],1),e("a-modal",{attrs:{footer:null,centered:"",width:"680px",destroyOnClose:""},model:{value:t.visibleTree,callback:function(e){t.visibleTree=e},expression:"visibleTree"}},[e("AddTransfer",{attrs:{title:"选择合适客户群",selectList:t.roomIdsList,type:"custGrpList"},on:{serviceOk:t.serviceOk,cancle:function(e){t.visibleTree=!1}}})],1),e("a-modal",{attrs:{footer:null,centered:"",width:"680px",destroyOnClose:""},model:{value:t.memberTree,callback:function(e){t.memberTree=e},expression:"memberTree"}},[e("AddTransfer",{attrs:{selectRoleIdList:t.selectRoleIdList,selectList:t.memberIdsList,type:"deptId"},on:{serviceOk:t.serviceMemberOk,cancle:function(e){t.memberTree=!1}}})],1),e("a-modal",{attrs:{footer:null,centered:""},model:{value:t.visibleTag,callback:function(e){t.visibleTag=e},expression:"visibleTag"}},[e("MakeTags",{attrs:{title:"群标签",hasTips:!1,operation:t.operation,selectedRows:t.selectedRowKeys},on:{cancle:function(e){t.visibleTag=!1},serviceOk:t.serviceroomTagListOk}})],1)],1)}),l=[],m=r("c7eb"),d=r("1da1"),p=(r("b0c0"),r("a434"),r("b775")),f={pointsSave:"/marketing/customerfraction/save",pointsUpdate:"/marketing/customerfraction/update",pointsDelete:"/marketing/customerfraction/delete",pointsInfo:"/marketing/customerfraction/info/",pointsList:"/marketing/customerfraction/list",updateRuleStatus:"/marketing/customerfraction/updateRuleStatus"};function h(t){return Object(p["b"])({url:f.updateRuleStatus,method:"post",params:t})}function v(t){return Object(p["b"])({url:f.pointsList,method:"post",params:t})}function g(t){return Object(p["b"])({url:f.pointsInfo+t,method:"get"})}function y(t){return Object(p["b"])({url:f.pointsSave,method:"post",data:t})}function b(t){return Object(p["b"])({url:f.pointsUpdate,method:"post",data:t})}function T(t){return Object(p["b"])({url:f.pointsDelete,method:"post",data:t})}var x=r("1eb1"),w=r("c844"),L=r("c5d4"),_={components:{AddTransfer:x["a"],SelectTags:w["a"],MakeTags:L["a"]},props:{scouce:{type:String,default:"add"},timestamp:{type:Number,default:null},timestampEdit:{type:Number,default:null},idx:{type:Number,default:null}},data:function(){return{operation:{},selectedRowKeys:[],ruleName:void 0,addFraction:null,defaultThumbAvatar:r("b5c3"),customerRuleType:void 0,type:0,roomIdsList:[],visibleTree:!1,roomTagList:[],visibleTag:!1,integralLimit:1,limitFraction:1,memberIdsList:[],memberTree:!1,ruleStatusFlag:!0}},created:function(){this.createUserId=this.info.userid,this.createUserName=this.info.name;var t=this.idx;t&&this.getDetail(t)},computed:{selectRoleIdList:function(){return this.memberIdsList.map((function(t){return t.source.staffId}))},stateText:function(){return"add"===this.scouce?"添加":"编辑"},info:{get:function(){return this.$store.state.user.info},set:function(){}}},methods:{sure:function(){var t=this;return Object(d["a"])(Object(m["a"])().mark((function e(){var r,a;return Object(m["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.ruleName){e.next=3;break}return t.$message.warning("请输入规则名称！"),e.abrupt("return");case 3:if(void 0!=t.customerRuleType){e.next=6;break}return t.$message.warning("请选择积分类型！"),e.abrupt("return");case 6:if(r=!1,"0"!=t.customerRuleType&&"1"!=t.customerRuleType||("0"==t.type?t.roomIdsList.length<=0&&(r=!0,t.$message.warning("请选择客户群！")):t.roomTagList.length<=0&&(r=!0,t.$message.warning("请选择群标签！"))),"2"!=t.customerRuleType&&"2"!=t.customerRuleType||t.memberIdsList.length<=0&&(r=!0,t.$message.warning("请选择生效成员！")),!r){e.next=11;break}return e.abrupt("return");case 11:if(t.addFraction){e.next=14;break}return t.$message.warning("请输入规则增加积分！"),e.abrupt("return");case 14:return e.next=16,t.getParm();case 16:a=e.sent,"add"==t.scouce?y(a).then((function(e){t.$message.success("添加成功"),t.$emit("successRule")})).catch((function(e){t.$message.error(e)})):(a.id=t.idx,b(a).then((function(e){t.$message.success("更新成功"),t.$emit("successRule")})).catch((function(e){t.$message.error(e)})));case 18:case"end":return e.stop()}}),e)})))()},getDetail:function(t){var e=this;g(t).then((function(t){if(t.data){e.ruleName=t.data.ruleName,e.customerRuleType=String(t.data.customerRuleType),e.addFraction=t.data.addFraction,"0"==t.data.ruleStatus?e.ruleStatusFlag=!0:e.ruleStatusFlag=!1;var r=t.data.customerRuleContext;"2"!=e.customerRuleType&&"3"!=e.customerRuleType||(e.memberIdsList=r.roomMembers.map((function(t){t.title=t.memberName;var e={thumbAvatar:t.memberAvatar,name:t.memberName,userid:t.memberUserId};return t.key=String(t.memberUserId),t.source=e,Object.assign({},t)}))),"1"==e.customerRuleType&&(e.limitFraction=r.limitFraction,e.limitFraction,e.integralLimit),"0"!=e.customerRuleType&&"1"!=e.customerRuleType||(e.type=r.type,"0"==r.type&&(e.roomIdsList=r.roomInfos.map((function(t){t.title=t.roomName;var e={name:t.roomName,groupId:t.roomId};return t.key=String(t.roomId),t.source=e,Object.assign({},t)}))),"1"==r.type&&(e.roomTagList=r.roomTags))}})).catch((function(t){e.$message.error(t)}))},getParm:function(){var t={ruleName:this.ruleName,createUserName:this.createUserName,createUserId:this.createUserId,customerRuleType:this.customerRuleType,addFraction:this.addFraction,ruleStatus:this.ruleStatusFlag?0:1},e={type:this.type};return"0"!=this.type||"0"!=this.customerRuleType&&"1"!=this.customerRuleType||(e.roomInfos=this.roomIdsList.map((function(t){return{roomId:t.source.groupId,roomName:t.source.name}}))),"1"!=this.type||"0"!=this.customerRuleType&&"1"!=this.customerRuleType||(e.roomTags=this.roomTagList.map((function(t){return{tagId:t.tagId,tagName:t.tagName}}))),"1"==this.customerRuleType&&("0"==this.integralLimit?e.limitFraction=0:e.limitFraction=Number(this.limitFraction)),"2"!=this.customerRuleType&&"3"!=this.customerRuleType||(e.roomMembers=this.memberIdsList.map((function(t){return{memberUserId:t.source.userid,memberAvatar:t.source.thumbAvatar,memberName:t.source.name}}))),t.customerRuleContext=e,t},cancel:function(){this.$emit("cancelRule")},serviceOk:function(t){this.roomIdsList=t,this.visibleTree=!1},detRoomIdsList:function(t){this.roomIdsList.splice(t,1)},serviceroomTagListOk:function(t){this.roomTagList=t,this.visibleTag=!1},detRoomTagList:function(t){this.roomTagList.splice(t,1)},serviceMemberOk:function(t){this.memberIdsList=t,this.memberTree=!1},detMemberList:function(t){this.memberIdsList.splice(t,1)},choiceBox:function(){"0"==this.type?this.visibleTree=!0:this.visibleTag=!0}},watch:{timestamp:function(t,e){this.ruleName=void 0,this.type=0,this.addFraction=null,this.customerRuleType=void 0,this.roomIdsList=[],this.roomTagList=[],this.memberIdsList=[],this.integralLimit=1,this.limitFraction=1,this.ruleStatusFlag=!0},timestampEdit:function(t,e){var r=this.idx;this.getDetail(r)}}},R=_,C=(r("18a8"),r("2877")),k=Object(C["a"])(R,u,l,!1,null,"103ce5a4",null),S=k.exports,I={components:{rulePopup:S},data:function(){return{idx:null,timestamp:null,timestampEdit:null,customerRuleType:void 0,ruleShow:!1,tableLoading:!1,scouce:"",clientList:[],pagination:{current:1,pageSize:10,total:0},columns:[{title:"规则名称",dataIndex:"ruleName",key:"ruleName"},{title:"创建人",dataIndex:"createUserName",key:"createUserName",scopedSlots:{customRender:"createUserName"}},{title:"客户行为",dataIndex:"customerTxt",key:"customerTxt"},{title:"积分",dataIndex:"addFraction",key:"addFraction",scopedSlots:{customRender:"addFraction"}},{title:"生效成员/群聊",dataIndex:"list",key:"list",scopedSlots:{customRender:"list"}},{title:"规则状态",dataIndex:"ruleStatusFlag",key:"ruleStatusFlag",scopedSlots:{customRender:"ruleStatusFlag"}},{title:"操作",align:"right",dataIndex:"operation",key:"operation",scopedSlots:{customRender:"operation"}}]}},created:function(){this.getList()},methods:{chnageRuleStatus:function(t,e){var r,a=this;r=t?0:1;var i={id:e,ruleStatus:r};h(i).then((function(e){t?a.$message.success("开启成功"):a.$message.success("关闭成功")})).catch((function(t){a.$message.error(t)}))},edit:function(t){this.timestampEdit=(new Date).valueOf(),this.idx=t.id,this.scouce="edit",this.ruleShow=!0},deleteRule:function(t){var e=this;this.$confirm({title:"提示",icon:"",okText:"删除",content:"您确定要删除该规则吗？",onOk:function(){e.changeRes(t.id)}})},changeRes:function(t){var e=this;T([t]).then((function(t){e.$message.success("删除成功"),e.pagination.current=1,e.getList()})).catch((function(t){e.$message.error(t)}))},handleChange:function(t){this.customerRuleType=t,this.pagination.current=1,this.getList()},successRule:function(){this.ruleShow=!1,this.pagination.current=1,this.getList()},cancelRule:function(){this.ruleShow=!1},addRule:function(){this.scouce="add",this.ruleShow=!0,this.timestamp=(new Date).valueOf()},getList:function(){var t=this;this.tableLoading=!0;var e={customerRuleType:Number(this.customerRuleType),page:this.pagination.current,limit:this.pagination.pageSize};void 0==this.customerRuleType&&delete e.customerRuleType,"1"==this.pagination.current&&(this.clientList=[]),v(e).then((function(e){var r;null!==e&&void 0!==e&&null!==(r=e.data)&&void 0!==r&&r.list&&(t.pagination.total=e.data.totalCount,t.disposeClientList(e.data.list))})).finally((function(){t.tableLoading=!1}))},disposeClientList:function(t){this.clientList=t.map((function(t){"0"==t.customerRuleType?t.customerTxt="加入客户群":"1"==t.customerRuleType?t.customerTxt="在客户群发言":"2"==t.customerRuleType?t.customerTxt="加成员的企业微信好友":"3"==t.customerRuleType&&(t.customerTxt="在成员的微信朋友圈签到"),t.ruleType=t.customerRuleType,"0"==t.ruleStatus?t.ruleStatusFlag={flag:!0,id:t.id}:t.ruleStatusFlag={flag:!1,id:t.id};var e=t.customerRuleContext;return t.list={roomMembers:e.roomMembers||[],roomInfos:e.roomInfos||[],roomTags:e.roomTags||[]},t.key=t.id,Object.assign({operation:t},t)}))},change:function(t){var e=t.current;this.pagination.current=e,this.getList()}}},N=I,O=(r("4107"),Object(C["a"])(N,o,c,!1,null,"2b233c1c",null)),F=O.exports,A=function(){var t=this,e=t._self._c;return e("div",{staticClass:"customer-integral-explain"},[t._m(0),e("div",{staticClass:"title"},[t._v("设置积分规则")]),e("div",{staticClass:"explain-content"},[e("div",{staticClass:"content-l"},[e("div",{staticClass:"desc-textarea"},[e("a-textarea",{staticClass:"textareaBox",attrs:{maxLength:"300",placeholder:"请输入客户描述内容"}}),e("p",{staticClass:"text-cnt"},[t._v("0/300")])],1),e("div",{staticClass:"btn-box"},[e("a-button",{attrs:{type:"primary"}},[t._v("保存")])],1)]),e("div",{staticClass:"content-r"},[e("img",{staticClass:"preview-phone",attrs:{src:"/imgs/customer-desc..png"}}),e("div",{staticClass:"preview-title"},[t._v("积分商城")]),e("div",{staticClass:"preview-content"},[e("div",{staticClass:"tips-title"},[t._v("积分规则")]),e("div",{staticClass:"tips-content"},[t._v("sdds")]),e("a-icon",{staticClass:"close-icon",attrs:{type:"close"}})],1)])])])},E=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"tips"},[e("img",{staticClass:"bell",attrs:{src:r("1816")}}),t._v(" 此处展示给客户看的积分规则，客户通过对积分规则的了解，激发客户的活跃度 ")])}],j={},U=j,P=(r("64ac"),Object(C["a"])(U,A,E,!1,null,"4c920a76",null)),B=P.exports,M={components:{ChannelList:F,Setting:B},data:function(){return{defalutState:!0,tabStateval:"0"}},methods:{tabState:function(t){this.defalutState="0"==t,this.tabStateval=t}}},$=M,G=(r("4f23"),Object(C["a"])($,s,n,!1,null,"bd36e370",null)),K=G.exports,Y={name:"CustomerPoints",components:{integralRule:K},data:function(){return{}}},H=Y,D=(r("ff49"),Object(C["a"])(H,a,i,!1,null,"4716e274",null));e["default"]=D.exports},ff49:function(t,e,r){"use strict";r("2aea")}}]);