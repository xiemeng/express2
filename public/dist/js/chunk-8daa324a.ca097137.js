(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8daa324a"],{"09d0":function(t,e,s){"use strict";s("d282")},"1bee":function(t,e,s){"use strict";s.d(e,"a",(function(){return a})),s.d(e,"c",(function(){return i})),s.d(e,"b",(function(){return n}));s("a9e3"),s("ac1f"),s("5319"),s("4d63"),s("25f0");function a(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss",s=e,a=new Date(Number(t)),i={"M+":a.getMonth()+1,"D+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),"S+":a.getMilliseconds()};for(var n in/(y+)/i.test(s)&&(s=s.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),i)new RegExp("("+n+")").test(s)&&(s=s.replace(RegExp.$1,1===RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return s}function i(t){var e=parseInt(t/3600)<10?"0"+parseInt(t/3600):parseInt(t/3600),s=parseInt(t%3600/60)<10?"0"+parseInt(t%3600/60):parseInt(t%3600/60);return e+":"+s}function n(t,e){var s=Date.parse(new Date),a=r(s,t),i=new Date(a),n=i.getTime(),o=r(s,e),c=new Date(o),l=c.getTime();return"start"?n>=l:l<=n}function r(t,e){var s=new Date(t),a=s.getFullYear()+"-",i=(s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1)+"-",n=s.getDate()+" ";s.getHours(),s.getMinutes(),s.getSeconds();return a+i+n+e+":00"}},"3c43":function(t,e,s){t.exports=s.p+"assets/avatar-room-default.de3b5fcd.svg"},"407b":function(t,e,s){"use strict";s.d(e,"a",(function(){return n})),s.d(e,"c",(function(){return r})),s.d(e,"d",(function(){return o})),s.d(e,"b",(function(){return c})),s.d(e,"e",(function(){return l}));var a=s("b775"),i={memberList:"/risk/messageStorage/showSession",recordList:"/risk/risk/msgmessagerecord/list",groupList:"/risk/risk/msgmessagerecord/groupList",getStaff:"/risk/messageStorage/getStaff",showSessionCustomer:"/risk/messageStorage/showSessionCustomer"};function n(t){return Object(a["b"])({url:i.getStaff,method:"get",params:t})}function r(t){return Object(a["b"])({url:i.memberList,method:"get",params:t})}function o(t){return Object(a["b"])({url:i.recordList,method:"get",params:t})}function c(t){return Object(a["b"])({url:i.groupList,method:"get",params:t})}function l(t){return Object(a["b"])({url:i.showSessionCustomer,method:"get",params:t})}},4274:function(t,e,s){},"487a":function(t,e,s){(function(e,s){t.exports=s()})(0,(function(){"use strict";var t="@@InfiniteScroll",e=function(t,e){var s,a,i,n,r,o=function(){t.apply(n,r),a=s};return function(){if(n=this,r=arguments,s=Date.now(),i&&(clearTimeout(i),i=null),a){var t=e-(s-a);t<0?o():i=setTimeout((function(){o()}),t)}else o()}},s=function(t){return t===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):t.scrollTop},a=document.defaultView.getComputedStyle,i=function(t){var e=t;while(e&&"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType){var s=a(e).overflowY;if("scroll"===s||"auto"===s)return e;e=e.parentNode}return window},n=function(t){return t===window?document.documentElement.clientHeight:t.clientHeight},r=function(t){return t===window?s(window):t.getBoundingClientRect().top+s(window)},o=function(t){var e=t.parentNode;while(e){if("HTML"===e.tagName)return!0;if(11===e.nodeType)return!1;e=e.parentNode}return!1},c=function(){if(!this.binded){this.binded=!0;var t=this,s=t.el,a=s.getAttribute("infinite-scroll-throttle-delay"),n=200;a&&(n=Number(t.vm[a]||a),(isNaN(n)||n<0)&&(n=200)),t.throttleDelay=n,t.scrollEventTarget=i(s),t.scrollListener=e(l.bind(t),t.throttleDelay),t.scrollEventTarget.addEventListener("scroll",t.scrollListener),this.vm.$on("hook:beforeDestroy",(function(){t.scrollEventTarget.removeEventListener("scroll",t.scrollListener)}));var r=s.getAttribute("infinite-scroll-disabled"),o=!1;r&&(this.vm.$watch(r,(function(e){t.disabled=e,!e&&t.immediateCheck&&l.call(t)})),o=Boolean(t.vm[r])),t.disabled=o;var c=s.getAttribute("infinite-scroll-distance"),u=0;c&&(u=Number(t.vm[c]||c),isNaN(u)&&(u=0)),t.distance=u;var d=s.getAttribute("infinite-scroll-immediate-check"),f=!0;d&&(f=Boolean(t.vm[d])),t.immediateCheck=f,f&&l.call(t);var m=s.getAttribute("infinite-scroll-listen-for-event");m&&t.vm.$on(m,(function(){l.call(t)}))}},l=function(t){var e=this.scrollEventTarget,a=this.el,i=this.distance;if(!0===t||!this.disabled){var o=s(e),c=o+n(e),l=!1;if(e===a)l=e.scrollHeight-c<=i;else{var u=r(a)-r(e)+a.offsetHeight+o;l=c+i>=u}l&&this.expression&&this.expression()}},u={bind:function(e,s,a){e[t]={el:e,vm:a.context,expression:s.value};var i=arguments;e[t].vm.$on("hook:mounted",(function(){e[t].vm.$nextTick((function(){o(e)&&c.call(e[t],i),e[t].bindTryCount=0;var s=function s(){e[t].bindTryCount>10||(e[t].bindTryCount++,o(e)?c.call(e[t],i):setTimeout(s,50))};s()}))}))},unbind:function(e){e&&e[t]&&e[t].scrollEventTarget&&e[t].scrollEventTarget.removeEventListener("scroll",e[t].scrollListener)}},d=function(t){t.directive("InfiniteScroll",u)};return window.Vue&&(window.infiniteScroll=u,Vue.use(d)),u.install=d,u}))},7676:function(t,e,s){"use strict";s("e81b")},"8a24":function(t,e,s){"use strict";s.r(e);s("b0c0");var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-wrapper page-box"},[e("div",{staticClass:"ant-layout"},[e("div",{staticClass:"ant-layout-content",attrs:{id:"page-content"}},[e("div",{staticClass:"container full-wh flex-row relative"},[e("div",{staticClass:"col sessions-box flex-col full-h"},["CustomerDetail"!==t.source?e("header",{staticClass:"row flex-col full-w align-left"},[e("span",{staticClass:"dropdown-wrap staff-select full-w"},[e("span",{staticClass:"label-wrap"},[e("span",{staticClass:"staff-select-label flex-row full-w"},[e("section",{staticClass:"avatar-component avatar avatar-normal"},[e("a-avatar",{staticStyle:{"margin-right":"10px"},attrs:{size:34,src:t.infoNew.avatar,shape:"square"}})],1),e("span",{staticClass:"name",on:{click:t.clickParent}},[t._v(" "+t._s(t.infoNew.name))]),e("SelectMultiple",{ref:"mychild",on:{selectCustom:t.selectCustom}})],1),e("span",{directives:[{name:"show",rawName:"v-show",value:!t.noOpen,expression:"!noOpen"}],staticClass:"no-open"},[t._v("该员工消息存档数据暂时无法更新")])])])]):t._e(),e("div",{staticClass:"session-list-wrap row-1 flex-col align-left full-w"},[e("div",{staticClass:"full-w container"},[e("a-tabs",{staticClass:"my-tabs",attrs:{"default-active-key":"1",tabBarStyle:{margin:0}}},[e("a-tab-pane",{key:"1",attrs:{tab:"全部"}},[e("div",{staticClass:"search-wrap flex-row full-w",staticStyle:{"padding-left":"17px"}},[1==t.a?e("p",{staticClass:"top session-cnt"},[e("span",{staticClass:"icon-wrap"},[e("a-icon",{attrs:{type:"appstore"}})],1),t._v(" 共有"+t._s(t.total)+"个会话 ")]):t._e(),0==t.a?e("a-input-search",{staticStyle:{width:"224px","margin-right":"10px"},attrs:{placeholder:"请输入客户或群聊名称",allowClear:t.allowClear},on:{search:t.searchData,change:t.customchange},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}}):t._e(),e("span",{class:{"search-btn":1==t.a},on:{click:function(e){0==t.a?t.show():t.hide()}}},[1==t.a?e("a-icon",{attrs:{type:"search"}}):e("span",{staticClass:"cancel-btn"},[t._v("取消")])],1)],1),e("GroupList",{attrs:{lightIndex:t.lightIndex,showList:t.showList,staffId:t.staffId},on:{changeMessage:t.changeMessage}})],1)],1)],1)])]),e("div",{staticClass:"col-1 msg-section full-h"},[e("div",{staticClass:"inner full-h flex-col"},[e("header",{staticClass:"full-w msg-section-header"},[e("div",{staticClass:"title-wrap full-w flex-row align-side"},[e("div",{staticClass:"chat-message-box-title flex-col align-left"},[e("div",{staticClass:"flex-col align-left"},[e("div",{staticClass:"flex-row"},[e("span",{staticClass:"title"},[e("div",{staticClass:"room-chat"},[t._v(t._s(t.fistName))]),t._m(0)])])])]),e("div",{staticClass:"right flex-row"},[e("a-input-search",{staticStyle:{width:"180px","margin-right":"10px"},attrs:{placeholder:"搜索消息",allowClear:t.allowClear},on:{change:t.changeNew},model:{value:t.searchNew,callback:function(e){t.searchNew=e},expression:"searchNew"}}),e("a-range-picker",{staticStyle:{width:"280px"},attrs:{"disabled-date":t.disabledDate,value:t.showAddDateTime},on:{change:t.changeAddDate}},[e("a-icon",{attrs:{slot:"suffixIcon",type:"calendar"},slot:"suffixIcon"})],1)],1)])]),e("div",{staticClass:"msgs"},[e("GroupViewChatDetaied",{attrs:{avatarImg:t.avatarImg,staffId:t.staffId,flag:t.flag,customerId:t.customerId,messageLogging:t.messageLogging,staffIdSource:t.staffIdSource}})],1)])])])])])])},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider",staticStyle:{"padding-top":"0px","padding-bottom":"0px",display:"none"}},[e("span",{staticClass:"ant-divider ant-divider-vertical"})])}],n=s("5530"),r=(s("d81d"),s("4de4"),s("d3b7"),s("b64b"),s("99af"),s("a4d3"),s("e01a"),function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"dialog-chat-record-list"},[e("div",{staticClass:"chat-message-box search-msg-list"},[e("ul",{staticClass:"msg-list"},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.loadingTop,expression:"loadingTop"}],staticClass:"loading loading-top"},[e("a-spin")],1),"0"==t.messageLogging.isGroup?e("div",[t.msg_list.length>0&&t.customerId?e("div",t._l(t.msg_list,(function(s,a){return e("li",{key:a,class:[s.TOLIST==t.customerId?"receive":"send","msg-li"]},[s.content?e("div",[e("span",{directives:[{name:"show",rawName:"v-show",value:s.time,expression:"item.time"}],staticClass:"time-mark"},[t._v(t._s(s.time))]),e("div",{staticClass:"inner flex-row"},[t.customerId?e("div",[s.TOLIST==t.customerId?e("a-avatar",{attrs:{size:36,src:t.avatar,shape:"square"}}):t._e(),e("a-avatarv-else",{attrs:{size:36,src:t.user.avatar,shape:"square"}})],1):e("div",[s.TOLIST==t.staffId?e("a-avatar",{attrs:{size:36,src:t.user.avatar,shape:"square"}}):e("a-avatar",{attrs:{size:36,src:t.avatar,shape:"square"}})],1),e("div",{staticClass:"content-wrap flex-col"},[e("div",{staticClass:"content flex-row"},[s.content.content?e("span",{staticClass:"text bubble"},[t._v(t._s(s.content.content))]):t._e(),"image"==s.MSGTYPE?e("img",{staticClass:"img",attrs:{src:"".concat(t.ARIAS_URL).concat(s.MEDIA_PATH),alt:""},on:{click:function(e){return t.bgImgShow("".concat(t.ARIAS_URL).concat(s.MEDIA_PATH))}}}):t._e(),"link"==s.MSGTYPE?e("div",[e("a",{staticClass:"link",attrs:{href:s.content.link_url,target:"_blank"}},[e("div",{staticClass:"title"},[t._v(t._s(s.content.title))]),e("div",{staticClass:"flex-row"},[e("span",{staticClass:"desc col-1"},[t._v(t._s(s.content.description))]),e("img",{staticClass:"cover",attrs:{src:s.content.image_url||t.defaultImage}})])])]):t._e(),s.content.displayname?e("div",{staticClass:"weapp bubble flex-col align-left",on:{click:t.tipwarining}},[e("span",{staticClass:"weapp-name"},[t._v(t._s(s.content.displayname))]),e("span",{staticClass:"title"},[t._v(t._s(s.content.title))]),e("span",{staticClass:"desc"},[t._v(t._s(s.content.description))]),e("footer",[e("span",{staticClass:"icon-wrap"},[e("a-icon",{attrs:{type:"link"}})],1),t._v(" 小程序 ")])]):t._e()])])])]):t._e()])})),0):t._e(),t.msg_list.length>0&&!t.customerId?e("div",t._l(t.msg_list,(function(s,a){return e("li",{key:a,class:[s.TOLIST==(t.customerId||t.staffId)?"receive":"send","msg-li"]},[s.content?e("div",[e("span",{directives:[{name:"show",rawName:"v-show",value:s.time,expression:"item.time"}],staticClass:"time-mark"},[t._v(t._s(s.time))]),e("div",{staticClass:"inner flex-row"},[t.customerId?e("div",[s.TOLIST==(t.customerId||t.staffId)?e("a-avatar",{attrs:{size:36,src:t.user.avatar,shape:"square"}}):e("a-avatar",{attrs:{size:36,src:t.avatar,shape:"square"}})],1):e("div",[s.TOLIST==t.staffId?e("a-avatar",{attrs:{size:36,src:t.user.avatar,shape:"square"}}):e("a-avatar",{attrs:{size:36,src:t.avatar,shape:"square"}})],1),e("div",{staticClass:"content-wrap flex-col"},[e("div",{staticClass:"content flex-row"},[s.content.content?e("span",{staticClass:"text bubble"},[t._v(t._s(s.content.content))]):t._e(),"image"==s.MSGTYPE?e("img",{staticClass:"img",attrs:{src:"".concat(t.ARIAS_URL).concat(s.MEDIA_PATH),alt:""},on:{click:function(e){return t.bgImgShow("".concat(t.ARIAS_URL).concat(s.MEDIA_PATH))}}}):t._e(),"link"==s.MSGTYPE?e("div",[e("a",{staticClass:"link",attrs:{href:s.content.link_url,target:"_blank"}},[e("div",{staticClass:"title"},[t._v(t._s(s.content.title))]),e("div",{staticClass:"flex-row"},[e("span",{staticClass:"desc col-1"},[t._v(t._s(s.content.description))]),e("img",{staticClass:"cover",attrs:{src:s.content.image_url||t.defaultImage}})])])]):t._e(),s.content.displayname?e("div",{staticClass:"weapp bubble flex-col align-left",on:{click:t.tipwarining}},[e("span",{staticClass:"weapp-name"},[t._v(t._s(s.content.displayname))]),e("span",{staticClass:"title"},[t._v(t._s(s.content.title))]),e("span",{staticClass:"desc"},[t._v(t._s(s.content.description))]),e("footer",[e("span",{staticClass:"icon-wrap"},[e("a-icon",{attrs:{type:"link"}})],1),t._v(" 小程序 ")])]):t._e()])])])]):t._e()])})),0):t._e(),t.msg_list.length<0?e("div",{staticClass:"empty"},[e("a-empty")],1):t._e()]):e("div",[t.msg_list.length>0?e("div",t._l(t.msg_list,(function(s,a){return e("li",{key:a,class:[s.user?"receive":"send","msg-li"]},[s.content?e("div",[e("span",{directives:[{name:"show",rawName:"v-show",value:s.time,expression:"item.time"}],staticClass:"time-mark"},[t._v(t._s(s.time))]),e("div",{staticClass:"inner flex-row"},[s.user?e("a-avatar",{attrs:{size:36,src:s.user.avatar,shape:"square"}}):e("a-avatar",{attrs:{size:36,src:t.avatar,shape:"square"}}),e("div",{staticClass:"content-wrap flex-col"},[e("div",{staticClass:"content flex-row"},[s.content.content?e("span",{staticClass:"text bubble"},[t._v(t._s(s.content.content))]):t._e(),"image"==s.MSGTYPE?e("img",{staticClass:"img",attrs:{src:"".concat(t.ARIAS_URL).concat(s.MEDIA_PATH),alt:""},on:{click:function(e){return t.bgImgShow("".concat(t.ARIAS_URL).concat(s.MEDIA_PATH))}}}):t._e(),"link"==s.MSGTYPE?e("div",[e("a",{staticClass:"link",attrs:{href:s.content.link_url,target:"_blank"}},[e("div",{staticClass:"title"},[t._v(t._s(s.content.title))]),e("div",{staticClass:"flex-row"},[e("span",{staticClass:"desc col-1"},[t._v(t._s(s.content.description))]),e("img",{staticClass:"cover",attrs:{src:s.content.image_url||t.defaultImage}})])])]):t._e(),s.content.displayname?e("div",{staticClass:"weapp bubble flex-col align-left",on:{click:t.tipwarining}},[e("span",{staticClass:"weapp-name"},[t._v(t._s(s.content.displayname))]),e("span",{staticClass:"title"},[t._v(t._s(s.content.title))]),e("span",{staticClass:"desc"},[t._v(t._s(s.content.description))]),e("footer",[e("span",{staticClass:"icon-wrap"},[e("a-icon",{attrs:{type:"link"}})],1),t._v(" 小程序 ")])]):t._e()])])],1)]):t._e()])})),0):e("div",{staticClass:"empty"},[e("a-empty")],1)])])])]),t._m(0),e("a-modal",{attrs:{width:"500px",footer:null,centered:""},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[e("img",{staticClass:"bgImg",attrs:{src:t.bgImg}})])],1)}),o=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"chat-box-previewer",staticStyle:{display:"none"}},[e("div",{staticClass:"ant-modal-mask"}),e("div",{staticClass:"ant-modal-wrap"},[e("span",{staticClass:"close-btn"})])])}],c=(s("ac1f"),s("5319"),s("407b")),l=s("1bee"),u=s("2f62"),d={props:{staffId:{type:String,default:""},flag:{type:Boolean,default:!0},avatarImg:{type:String,default:""},staffIdSource:{type:String,default:""},customerId:{type:String,default:""},messageLogging:{type:Object,default:function(){return{}}}},data:function(){return{date:(new Date).getTime(),bgImg:"",visible:!1,msg_list:[],user:{},loadingTop:!1,timeList:[],defaultImage:"/imgs/default-cover.png",ARIAS_URL:"https://acadsocscrmpc.oss-cn-shenzhen.aliyuncs.com/"}},created:function(){this.avatar=this.avatarImg||this.info.avatar},computed:Object(n["a"])({},Object(u["c"])({startTime:function(t){return t.customer.startTime},endTime:function(t){return t.customer.endTime},context:function(t){return t.customer.context},info:function(t){return t.user.info}})),methods:{tipwarining:function(){this.$message.warning("由于企业微信的限制，暂时不支持打开小程序消息")},bgImgShow:function(t){this.bgImg=t,this.visible=!0},dateChange:function(t){var e=Object(l["a"])(t,"MM-DD");return e},getRecordList:function(){var t,e=this;this.loadingTop=!0,"0"==this.messageLogging.isGroup?(t={staffId:this.customerId?this.messageLogging.userId:this.messageLogging.staffId,userId:this.customerId||this.messageLogging.userId,seq:this.messageLogging.seq+1,context:this.context,startTime:this.startTime,endTime:this.endTime,limit:"40"},Object(c["d"])(t).then((function(t){var s=[];t.data.list&&(s=t.data.list.reverse()),e.disposeClientList(s),e.user=t.data.user})).finally((function(){e.loadingTop=!1}))):(t={roomid:this.messageLogging.roomid,seq:this.messageLogging.seq+1,context:this.context,startTime:this.startTime,endTime:this.endTime,limit:"40"},Object(c["b"])(t).then((function(t){var s=[];t.data&&(s=t.data.reverse()),e.disposeClientList(s),e.user=t.data.user})).finally((function(){e.loadingTop=!1})))},disposeClientList:function(t){this.msg_list=t.map((function(t){var e=t.MSGDATA,s=Object(l["a"])(t.MSGTIME,"MM-DD"),a=/^['|"](.*)['|"]$/;try{var i=t.MSGDATA.replace(a,"$1");e=JSON.parse(i)}catch(n){e=""}return t.content=e,t.time=s,Object.assign({},t)}));var e=this.removalRepeat(this.msg_list);this.msg_list=e.map((function(t){return Object.assign({},t)}))},removalRepeat:function(t){for(var e=[],s={},a=0;a<t.length;a++)s[t[a].time]?(t[a].time="",e.push(t[a])):(e.push(t[a]),s[t[a].time]=!0);return e}},watch:{messageLogging:function(){setTimeout(this.getRecordList,0)},startTime:function(){setTimeout(this.getRecordList,0)},context:function(){setTimeout(this.getRecordList,0)},flag:{handler:function(t,e){!1!==t||(this.msg_list=[])}},avatarImg:{handler:function(t,e){this.avatar=t}}}},f=d,m=(s("09d0"),s("2877")),h=Object(m["a"])(f,r,o,!1,null,"9041d6e0",null),g=h.exports,p=s("1c9c"),v=function(){var t=this,e=t._self._c;return e("ul",{staticClass:"session-list full-w"},t._l(t.lists,(function(s,a){return e("li",{key:a,staticClass:"session-li flex-row full-w",class:{selected:a==t.checkindex},staticStyle:{"padding-left":"17px"},on:{click:function(e){return t.toggle(a,s)}}},[e("span",{staticClass:"avatar avatar-normal"},[e("img",{staticClass:"avatar",attrs:{src:t.wayimage(s["T1.ROOMID"],s.URL)}})]),e("div",{staticClass:"info col-1 flex-col"},[e("span",{staticClass:"flex-row align-side full-w"},[e("div",{staticClass:"name-wrap col-w flex-row justify-center"},[e("span",{staticClass:"name",attrs:{"data-sessionid":"6618515"}},[t._v(t._s(s.GROUPNAME||s.NAME))])]),e("span",{staticClass:"time"},[t._v(t._s(t.dateChange(s["T1.MSGTIME"])))])]),e("p",{staticClass:"full-w ellipses last-msg"},[t._v(t._s(s["T1.TEXT"]))])])])})),0)},w=[],b=(s("a9e3"),{props:{showList:{type:Array,default:function(){return[]}},staffId:{type:String,default:""},lightIndex:{type:Number,default:0}},data:function(){return{lists:this.showList,checkindex:this.lightIndex,defaultImg:s("3c43")}},created:function(){},methods:{wayimage:function(t,e){return t?this.defaultImg:e},dateChange:function(t){return Object(l["a"])(t,"YYYY-MM-DD")},toggle:function(t,e){this.checkindex=t;var s={staffId:this.staffId,avatar:e.URL,seq:e["T1.SEQ"]};this.staffId==e["T1.MSGFROM"]?s.userId=e["T1.TOLIST"]:s.userId=e["T1.MSGFROM"],e["T1.ROOMID"]?(s.isGroup=1,s.roomid=e["T1.ROOMID"],s.name=e.groupName):(s.isGroup=0,s.name=e.name);var a=e.GROUPNAME||e.NAME;this.$store.commit("SET_FISTSHOWNAME",a),this.$emit("changeMessage",s)}},watch:{showList:{handler:function(t,e){this.lists=t}},lightIndex:{handler:function(t,e){this.checkindex=t}}}}),C=b,_=(s("a183"),Object(m["a"])(C,v,w,!1,null,"2cf1b250",null)),I=_.exports,O=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-wrap"},[e("div",{staticClass:"button-name",on:{click:function(e){return e.stopPropagation(),t.selectFocusIsOpen.apply(null,arguments)},mouseenter:t.enter,mouseleave:t.leave}},[e("a-icon",{attrs:{type:"down"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isOpen,expression:"isOpen"},{name:"clickoutside",rawName:"v-clickoutside",value:t.handleClose,expression:"handleClose"}],staticClass:"selectBox_list"},[e("div",{staticClass:"group-owner"},[e("header",{staticClass:"header"},[t._v("全部成员 ("+t._s(t.total)+")")]),e("div",{staticClass:"search-name"},[e("a-input-search",{attrs:{placeholder:"请输入员工后回车"},on:{search:t.onSearchName},model:{value:t.searchName,callback:function(e){t.searchName=e},expression:"searchName"}})],1),e("ul",{staticClass:"list-wrap"},[e("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.getDictionaryByCode,expression:"getDictionaryByCode"}],staticClass:"demo-infinite-container",attrs:{infinitescrollDisabled:t.busy,"infiniteScrollImmediate-check":!0,infinitescrollDistance:10}},t._l(t.groupOwners,(function(s,a){return e("li",{key:a,staticClass:"title-wrap",on:{click:function(e){return t.selectGroupOwner(s)}}},[e("a-space",{attrs:{size:12}},[e("a-avatar",{attrs:{size:30,src:s.avatar,shape:"square"}}),e("span",[t._v(t._s(s.name))]),e("a-tag",{directives:[{name:"show",rawName:"v-show",value:!s.isOpen,expression:"!item.isOpen"}]},[t._v("当前未开通")])],1)],1)})),0)])])])])},T=[],S=s("c7eb"),y=s("2909"),x=s("1da1"),L=(s("25f0"),s("159b"),s("caad"),s("2532"),s("487a")),N=s.n(L),M={bind:function(t,e){function s(s){if(t.contains(s.target))return!1;e.expression&&e.value(s)}t.__vueClickOutside__=s,document.addEventListener("click",s)},update:function(){},unbind:function(t){document.removeEventListener("click",t.__vueClickOutside__),delete t.__vueClickOutside__}},k={name:"SearchForm",directives:{clickoutside:M,infiniteScroll:N.a},props:{reactflag:{type:Boolean,default:!1}},data:function(){return{thumbAvatar:"",busy:!1,pagination:{current:1,pageSize:10,total:0},total:0,totalNum:0,selectRoleId:"3",employeeName:"",groupOwners:[],page:1,limit:10,value:[],searchName:"",styleButton:1,owners:[],isOpen:!1,loading:!1,buttonLoding:!1,ownersID:{data:[]}}},created:function(){},methods:{enter:function(){this.styleButton=2},leave:function(){this.styleButton=1},selectGroupOwner:function(t){this.employeeName=t.name,this.thumbAvatar=t.thumbAvatar,this.isOpen=!1,this.$emit("selectCustom",t)},iconClear:function(){this.employeeName="",this.isOpen=!1;var t={empty:"1"};this.groupOwners=[],this.page=1,this.searchName="",this.getDictionaryByCode(),this.$emit("selectCustom",t)},handleClose:function(){"1"==this.styleButton&&(this.isOpen=!1)},parentHandleclick:function(){this.isOpen=!this.isOpen,this.styleButton=2},selectFocusIsOpen:function(){this.isOpen=!this.isOpen,this.styleButton=1},ok:function(){var t=this.groupOwners.filter((function(t){if(t.defaultChecked)return t.userid})).map((function(t){return t.userid})),e=this.groupOwners.filter((function(t){if(t.defaultChecked)return t})).map((function(t){return{name:t.name,avatar:t.thumbAvatar}}));this.ownersID.data=e;var s=t.toString();this.isOpen=!this.isOpen,this.$store.commit("SET_STAFFIDS",s)},cancel:function(){var t=this;this.isOpen=!this.isOpen,this.groupOwners.forEach((function(e){var s=t.responseData.useridList.includes(e.userid);e.defaultChecked=!!s}));var e=this.groupOwners.filter((function(t){if(t.defaultChecked)return t})).map((function(t){return{name:t.name,avatar:t.thumbAvatar}}));this.ownersID.data=e},handleInfiniteOnLoad:function(){this.pagination.current++,this.loading&&this.getDictionaryByCode()},getDictionaryByCode:function(){var t=this;return Object(x["a"])(Object(S["a"])().mark((function e(){var s;return Object(S["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(s={page:t.page,size:t.limit,name:t.searchName||void 0},!t.buttonLoding){e.next=3;break}return e.abrupt("return");case 3:t.buttonLoding=!0,t.busy=!0,t.loading=!0,"1"==t.page&&(t.groupOwners=[]),Object(c["a"])(s).then((function(e){var s=e.data.data;t.loading=!1,t.total=e.data.total,t.page>1?t.groupOwners=[].concat(Object(y["a"])(t.groupOwners),Object(y["a"])(s)):t.groupOwners=Object(y["a"])(s),t.groupOwners.length>=t.total?t.busy=!0:(t.busy=!1,t.page=t.page+1)})).catch((function(e){t.busy=!1,t.$message.error(e)})).finally((function(){t.buttonLoding=!1}));case 8:case"end":return e.stop()}}),e)})))()},onSearchName:function(){this.groupOwners=[],this.page=1,this.busy=!1,this.getDictionaryByCode()}},watch:{reactflag:{handler:function(t,e){!0===t&&(this.employeeName="",this.isOpen=!1,this.groupOwners=[],this.page=1,this.searchName="",this.getDictionaryByCode())}}}},D=k,A=(s("a6d7"),Object(m["a"])(D,O,T,!1,null,"3480e39c",null)),E=A.exports,R={name:"News",props:{source:{type:String,default:""},staffIdSource:{type:String,default:""},customerId:{type:String,default:""}},data:function(){return{lightIndex:0,allowClear:!0,a:!0,total:0,staffId:"",searchName:"",fistName:this.fistShowName,searchNew:"",avatarImg:"",initList:[],showList:[],staff_list:[],showAddDateTime:[],flag:!0,noOpen:!0,messageLogging:{}}},created:function(){var t=this.$route.query.staffExtId;if(t){this.staffId=t;var e=JSON.parse(sessionStorage.getItem("newsObj"));e?(this.infoNew=e,this.getidOrUserIdGet(t)):this.infoNew=JSON.parse(JSON.stringify(this.info))}else this.staffId=this.info.userid,this.infoNew=JSON.parse(JSON.stringify(this.info));var s=this.$route.query.designee;if("0"==s){var a=this.$route.query.customerId;this.getDesigneeMemberList(a)}else this.getMemberList()},methods:{getidOrUserIdGet:function(t){var e=this,s={userId:t};return Object(p["s"])(s).then((function(t){var s=t.data.avatar;e.$set(e.infoNew,"avatar",s),e.avatarImg=s})).catch((function(t){e.$message.error(t)}))},getDesigneeMemberList:function(t){var e=this,s={staffId:this.staffId};Object(c["c"])(s).then((function(s){var a,i,n;if(Array.isArray(s.data)&&s.data.length<=0)return e.total=0,e.showList=[],void(e.flag=!1);if(null===(a=s.data)||void 0===a||!a.data)return e.total=0,e.showList=[],void(e.flag=!1);if((null===(i=s.data)||void 0===i||null===(n=i.data)||void 0===n?void 0:n.length)<=0)return e.total=0,e.showList=[],void(e.flag=!1);e.flag=!0,e.initList=s.data.data||[],e.showList=s.data.data||[],e.total=s.data.total;var r,o=!1;e.initList.map((function(s,a){o||(s["T1.MSGFROM"]==t?(o=!0,r=s,e.lightIndex=a):s["T1.TOLIST"]==t&&(r=s,o=!0,e.lightIndex=a))}));var c=r.GROUPNAME||r.NAME;e.fistName=r.GROUPNAME||r.NAME;var l={staffId:e.staffId,avatar:r.URL,seq:r["T1.SEQ"]};r["T1.ROOMID"]?(l.isGroup=1,l.roomid=r["T1.ROOMID"]):l.isGroup=0,e.staffId==r["T1.MSGFROM"]?l.userId=r["T1.TOLIST"]:l.userId=r["T1.MSGFROM"],e.messageLogging=l,e.$store.commit("SET_FISTSHOWNAME",c)})).catch((function(t){e.$message.error(t)}))},changeMessage:function(t){this.messageLogging=t},clickParent:function(){this.$refs.mychild.parentHandleclick()},selectCustom:function(t){this.infoNew=JSON.parse(JSON.stringify(t)),this.$forceUpdate(),this.noOpen=t.isOpen,this.staffId=t.userId,this.avatarImg=t.avatar,this.flag=!0,this.getMemberList()},changeAddDate:function(t,e){if(this.showAddDateTime=t,e[0]){var s=e[0]+" 00:00:00",a=e[1]+" 23:59:59.999",i=this.$moment(s).format("x"),n=this.$moment(a).format("x");this.$store.commit("SET_TIMERECORD",{endTime:n,startTime:i})}else this.$store.commit("SET_TIMERECORD",{endTime:void 0,startTime:void 0})},disabledDate:function(t){return t&&t>Date.now()},changeNew:function(){var t;t=this.searchNew?this.searchNew:void 0,this.$store.commit("SET_CONTEXT",t)},customchange:function(){this.searchName||this.searchData()},searchData:function(){var t=this.searchName;t=t.toLowerCase();var e=this.initList.filter((function(e){return Object.keys(e).some((function(s){if(e[s]=void 0==e[s]?"":e[s],e["T1.ROOMID"]){if("GROUPNAME"==s)return String(e[s]).toLowerCase().indexOf(t)>-1}else if("NAME"==s)return String(e[s]).toLowerCase().indexOf(t)>-1}))}));this.showList=e},showSessionCustomer:function(){var t={customerId:this.customerId,staffId:this.staffIdSource};return Object(c["e"])(t)},memberList:function(){var t={staffId:this.staffId};return Object(c["c"])(t)},getMemberList:function(){var t=this,e="CustomerDetail"!==this.source?this.memberList:this.showSessionCustomer;e().then((function(e){var s,a,i,n;if(Array.isArray(e.data)&&e.data.length<=0)return t.total=0,t.showList=[],void(t.flag=!1);if(null===(s=e.data)||void 0===s||!s.data)return t.total=0,t.showList=[],void(t.flag=!1);if((null===(a=e.data)||void 0===a||null===(i=a.data)||void 0===i?void 0:i.length)<=0)return t.total=0,t.showList=[],void(t.flag=!1);t.customerId&&(t.avatarImg=null===(n=e.data.data[0])||void 0===n?void 0:n.URL,t.staffId=t.customerId),t.flag=!0,t.initList=e.data.data||[],t.showList=e.data.data||[],t.total=e.data.total;var r=t.initList[0]||{},o=r.GROUPNAME||r.NAME;t.fistName=r.GROUPNAME||r.NAME;var c={staffId:t.staffId,avatar:r.URL,seq:r["T1.SEQ"]};r["T1.ROOMID"]?(c.isGroup=1,c.roomid=r["T1.ROOMID"]):c.isGroup=0,t.staffId==r["T1.MSGFROM"]?c.userId=r["T1.TOLIST"]:c.userId=r["T1.MSGFROM"],t.messageLogging=c,t.$store.commit("SET_FISTSHOWNAME",o)})).catch((function(e){t.$message.error(e)}))},getCurrentStyle:function(t,e){var s={};return 1===t.date()&&(s.border="1px solid #1890ff",s.borderRadius="50%"),s},show:function(){this.a=!0},hide:function(){this.a=!1}},computed:Object(n["a"])(Object(n["a"])({},Object(u["c"])({fistShowName:function(t){return t.customer.fistShowName}})),{},{info:{get:function(){return this.$store.state.user.info},set:function(){}}}),components:{GroupViewChatDetaied:g,GroupList:I,SelectMultiple:E},watch:{fistShowName:{handler:function(t,e){this.fistName=t}}}},G=R,j=(s("7676"),Object(m["a"])(G,a,i,!1,null,"a47a15dc",null));e["default"]=j.exports},a183:function(t,e,s){"use strict";s("4274")},a6d7:function(t,e,s){"use strict";s("cecc")},cecc:function(t,e,s){},d282:function(t,e,s){},e81b:function(t,e,s){}}]);